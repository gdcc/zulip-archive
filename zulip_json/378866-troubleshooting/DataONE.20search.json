[
    {
        "content": "<p>Hey <span class=\"user-mention\" data-user-id=\"598112\">@Philip Durbin</span>  --it's been a long time, but I see you're still deep into everything Dataverse. I wanted to reopen the topic of indexing Dataverse content into DataONE (<a href=\"https://datone.org\">https://datone.org</a>) -- my colleague Ian has been working on getting that harvest enabled, but running into blocks from robots.txt and other policy issues -- I just wanted to check in and make sure we're heading in the right direction. Let me know if you have a minute to chat.</p>",
        "id": 397000890,
        "sender_full_name": "Matt Jones",
        "timestamp": 1697503605
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"659548\">@Matt Jones</span> hi! Yes, I'm still in deep. <span aria-label=\"grinning\" class=\"emoji emoji-1f600\" role=\"img\" title=\"grinning\">:grinning:</span> </p>\n<p>I see you replied to <span class=\"user-mention\" data-user-id=\"637063\">@Leo Andreev</span> at <a href=\"https://help.hmdc.harvard.edu/Ticket/Display.html?id=337611\">https://help.hmdc.harvard.edu/Ticket/Display.html?id=337611</a> recently. Let me check in with him. He's been working on robots.txt stuff over at <a href=\"https://github.com/IQSS/dataverse.harvard.edu/issues/228\">https://github.com/IQSS/dataverse.harvard.edu/issues/228</a> but I don't remember the exact status.</p>\n<p>Anyway, sure! Let's do a call. 3am local time for you so let's wait a bit. <span aria-label=\"big smile\" class=\"emoji emoji-1f604\" role=\"img\" title=\"big smile\">:big_smile:</span></p>",
        "id": 397084003,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1697540669
    },
    {
        "content": "<p>We're talking about it but probably won't get to it today.</p>",
        "id": 397160268,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1697566384
    },
    {
        "content": "<p>ok, thanks <span class=\"user-mention\" data-user-id=\"598112\">@Philip Durbin</span> -- when we first tried to harvest <a href=\"http://schema.org\">schema.org</a>, it seems like we didn;'t throttle and so it was a problem for your server,. So, Ian worked on toning it down and limiting our request rate, but then on the very day that he tried it again, he noticed that your robots.txt was modified to include a <code>Disallow: /</code> from all user agents except google. So we were worried that we did something wrong again. Ian sent Leo a note on RT, but we'd love to work out how to handle this in a way that works for your systems.</p>",
        "id": 397165074,
        "sender_full_name": "Matt Jones",
        "timestamp": 1697568541
    },
    {
        "content": "<p>Heh, well, we appreciate you being good Internet citizens. <span aria-label=\"grinning\" class=\"emoji emoji-1f600\" role=\"img\" title=\"grinning\">:grinning:</span></p>",
        "id": 397165625,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1697568799
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"598112\">@Philip Durbin</span>, I appreciate your and Leo's time. I'm happy to jump on a call if you need to hash out technical stuff.</p>",
        "id": 397166839,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1697569329
    },
    {
        "content": "<p>Much appreciated. It's a busy day here. Sorry.</p>",
        "id": 397179703,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1697575489
    },
    {
        "content": "<p>Leonid is still quite busy. Are there questions I can answer? Or is the main question just, \"When will you stop blocking us?\" <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 397541147,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1697733428
    },
    {
        "content": "<p>That is the main question for sure, with a side question of why blocking was needed for our new process -- we're hoping our throttled harvest is well below whatever limits you need to impose. If not, we'd like to be sure they are before we restart.</p>",
        "id": 397587815,
        "sender_full_name": "Matt Jones",
        "timestamp": 1697755812
    },
    {
        "content": "<p>Probably you're collateral damage. I'm sure there are worse offenders.</p>",
        "id": 397587853,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1697755846
    },
    {
        "content": "<p>so if we see the robots.txt file flip back to unblocked, is that a sign its ok to start again?</p>",
        "id": 397587965,
        "sender_full_name": "Matt Jones",
        "timestamp": 1697755944
    },
    {
        "content": "<p>Let us know if there's anything we need to change to be good netizens</p>",
        "id": 397588145,
        "sender_full_name": "Matt Jones",
        "timestamp": 1697756073
    },
    {
        "content": "<p>Can you or <span class=\"user-mention\" data-user-id=\"659827\">@Ian Nesbitt</span> please provide any specifics about what he wrote in the ticket?</p>\n<blockquote>\n<p>In addition, I also cut the concurrent requests down and added some throttling. Before the requests began to fail, the harvest was running much faster than before due to the smaller response sizes. Please let me know whether to cut it back further and I can do so.</p>\n</blockquote>\n<p>How many requests per second are we talking about?</p>",
        "id": 397592945,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1697759255
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"598112\">@Philip Durbin</span> The lowest rate I saw was 20 pages/min and the most I saw was 36 pages/min</p>",
        "id": 397608461,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1697767644
    },
    {
        "content": "<p>so between 0.3 and 0.6-ish/second</p>",
        "id": 397608513,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1697767674
    },
    {
        "content": "<p>More specifics: the job started with a permissive <code>robots.txt</code> and the spider was requesting <code>application/ld+json</code> successfully, but at 2023-10-13 23:06:16 UTC those requests started returning a <code>text/html</code> response we couldn't parse, and then at 2023-10-13 23:09:14 they began returning 404</p>",
        "id": 397727756,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1697813764
    },
    {
        "content": "<p>Thanks. Out of curiosity, do you plan to index metadata from any of the other Dataverse installations? <a href=\"https://dataverse.org/installations\">https://dataverse.org/installations</a> ?</p>",
        "id": 397728425,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1697813955
    },
    {
        "content": "<p>Yes actually, we have been in contact with Borealis recently and just began a harvest of their Dataverse metadata as well</p>",
        "id": 397729448,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1697814154
    },
    {
        "content": "<p>Oh, nice. Our Canadian friends. <span aria-label=\"flag canada\" class=\"emoji emoji-1f1e8-1f1e6\" role=\"img\" title=\"flag canada\">:flag_canada:</span> How has the indexing experience been so far?</p>",
        "id": 397729738,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1697814214
    },
    {
        "content": "<p>Excellent! It's one of the endpoints in our triage that has the most complete <a href=\"http://schema.org\">schema.org</a> data of anywhere I've seen</p>",
        "id": 397731129,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1697814620
    },
    {
        "content": "<p>Wow, that's nice to hear.</p>",
        "id": 397731593,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1697814769
    },
    {
        "content": "<p>I see a lot of repositories that are missing <code>identifier</code> or have incorrectly configured <code>@id</code> or other fields so it's nice to see ones that follow the spec</p>",
        "id": 397732308,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1697814993
    },
    {
        "content": "<p>Gotcha. Well we did use Google's validator.</p>",
        "id": 397733296,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1697815314
    },
    {
        "content": "<p>And we put in some <a href=\"http://schema.org\">schema.org</a> fixes recently. Not sure if Borealis has upgraded yet.</p>",
        "id": 397733380,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1697815332
    },
    {
        "content": "<p>Looks like some correspondence is happening in <a href=\"https://help.hmdc.harvard.edu/Ticket/Display.html?id=337611\">https://help.hmdc.harvard.edu/Ticket/Display.html?id=337611</a> . Great!</p>",
        "id": 398114285,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1698076188
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"598112\">@Philip Durbin</span> We've finally got most of the Harvard Dataverse corpus scraped, harvested, and indexed in DataONE: <a href=\"https://search.dataone.org/portals/HD\">https://search.dataone.org/portals/HD</a> <span aria-label=\"tada\" class=\"emoji emoji-1f389\" role=\"img\" title=\"tada\">:tada:</span></p>",
        "id": 407133558,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1702260796
    },
    {
        "content": "<p>I will have Angie Garcia, our outreach coordinator, get in contact with you as soon as we're all back from AGU, or sooner if you're there to find us in person. Cheers and Happy Holidays!</p>",
        "id": 407133839,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1702260914
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"659827\">@Ian Nesbitt</span> nice, thanks for letting us know!</p>",
        "id": 407135362,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1702261343
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"659827\">@Ian Nesbitt</span> I was just thinking, what you've built is morally equivalent to SHARE, which we list an an integration: <a href=\"https://guides.dataverse.org/en/6.1/admin/integrations.html#share\">https://guides.dataverse.org/en/6.1/admin/integrations.html#share</a></p>",
        "id": 408250542,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1702671224
    },
    {
        "content": "<p>If you'd like to create a PR to add DataONE, the file edit it here: <a href=\"https://github.com/IQSS/dataverse/blob/develop/doc/sphinx-guides/source/admin/integrations.rst\">https://github.com/IQSS/dataverse/blob/develop/doc/sphinx-guides/source/admin/integrations.rst</a></p>",
        "id": 408250641,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1702671256
    },
    {
        "content": "<p>Definitely! I've added PR <a href=\"https://github.com/IQSS/dataverse/pull/10192\">#10192</a> with the suggested changes. Thank you for the suggestion.</p>",
        "id": 408266216,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1702679194
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"659548\">@Matt Jones</span> <span class=\"user-mention\" data-user-id=\"659827\">@Ian Nesbitt</span> can you think of any reason why <a href=\"https://search.dataone.org/view/sha256%3A2291cc19ed4e348a344f58f656cf5b354bfd2b8a0a05d59b2799d9333ce795f4\">https://search.dataone.org/view/sha256%3A2291cc19ed4e348a344f58f656cf5b354bfd2b8a0a05d59b2799d9333ce795f4</a> (Ci Technology DataSet) has my ORCID on it? My ORCID ( <a href=\"http://orcid.org/0000-0002-9528-9470\">http://orcid.org/0000-0002-9528-9470</a> ) is listed as both submitter (!) and rights holder (!!). Someone just emailed me about access to that dataset but I have nothing to do with it. <span aria-label=\"confused\" class=\"emoji emoji-1f615\" role=\"img\" title=\"confused\">:confused:</span></p>",
        "id": 475304568,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1728309610
    },
    {
        "content": "<p>Hi Philip, my apologies for the delay as I've been on vacation—to answer<br>\nyour question, since the records are all just placeholders that trace back<br>\nto the \"real\" HD records, we assign the repository manager as both<br>\nsubmitter and rightsholder. Since the records update automatically and the<br>\nnode instance needs a user account to do so, we tell the system that they<br>\nare being maintained by \"you\". It also allows you to, for example, modify<br>\nthe records yourself using our API, should you need to do so. We really<br>\nshould take the mention of the submitter and rightsholder ORCID out of<br>\nprominence or view entirely for <a href=\"http://schema.org\">schema.org</a> records, but that is technically<br>\nhow it works.</p>\n<p>As for the root cause of why they may be asking you this question: I<br>\nsuppose they must need the record changed in some way. If so, we would be<br>\nhappy to help facilitate. The records should be updated automatically based<br>\non HD JSON-LDs on a regular basis, but sometimes in rare cases our indexer<br>\ndrops the records and they must be reindexed manually. Before I left for<br>\nvacation I noticed HD had a backlog of changes that need to be indexed, so<br>\nI can take a look and see if this is one of those cases. We have yet to<br>\nidentify the bug, but we're working on it.</p>",
        "id": 476456094,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1728679343
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"598112\">@Philip Durbin 🐉</span> making sure you see this <span aria-label=\"up\" class=\"emoji emoji-2b06\" role=\"img\" title=\"up\">:up:</span></p>",
        "id": 476458814,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1728680654
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"598112\">@Philip Durbin 🐉</span> Now that I'm back from vacation, it looks like the Harvard Dataverse sitemap doesn't have any <code>lastmod</code> dates after <code>2024-07-03</code>. Perhaps the sitemap has stopped updating somehow?</p>",
        "id": 476998532,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1729001279
    },
    {
        "content": "<p>I've set our sitemap spider to pick up all changes after <code>2024-07-03</code> so when the sitemap does get updated, we can get to work indexing the backlog.</p>",
        "id": 476999859,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1729001661
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"659827\">@Ian Nesbitt</span> thanks for getting back to me. Now I'm back from couple days off. It sounds like my ORCID is on thousands of datasets. Can you please remove it? <span aria-label=\"grinning\" class=\"emoji emoji-1f600\" role=\"img\" title=\"grinning\">:grinning:</span></p>",
        "id": 477017831,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729006827
    },
    {
        "content": "<p>Sure. Since I manage the metadata flows, we can replace it with mine if that's an acceptable solution.</p>",
        "id": 477018331,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1729006992
    },
    {
        "content": "<p>From my perspective, that's a step in the right direction. <span aria-label=\"grinning\" class=\"emoji emoji-1f600\" role=\"img\" title=\"grinning\">:grinning:</span></p>",
        "id": 477019330,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729007298
    },
    {
        "content": "<p>I don't particularly want to field questions about rights and access, etc.</p>",
        "id": 477019397,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729007322
    },
    {
        "content": "<p>Are there any other options, longer term? Maybe even just \"see source dataset\"?</p>",
        "id": 477019514,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729007353
    },
    {
        "content": "<p>That's fair. Perhaps a better solution would be to hide those fields from view entirely, since they don't really mean anything to the end user.</p>",
        "id": 477019556,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1729007373
    },
    {
        "content": "<blockquote>\n<p>Are there any other options, longer term? Maybe even just \"see source dataset\"?</p>\n</blockquote>\n<p>Yes. I will bring this up at our DataONE team meeting on Thursday, because ideally we don't want end users asking data managers about these automatically managed records at all.</p>",
        "id": 477020024,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1729007510
    },
    {
        "content": "<p>Well, I think the fields are meaningful. Who submitted this data? Who is the rights holder? But sure, hidden fields are better than inaccurate fields, I'd say.</p>",
        "id": 477020661,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729007703
    },
    {
        "content": "<p>Of course. They would still be visible in the system metadata, just not on the dataset landing pages.</p>",
        "id": 477020921,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1729007769
    },
    {
        "content": "<p>Any idea why the HD sitemap seems to be stale since early July?</p>",
        "id": 477021635,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1729007972
    },
    {
        "content": "<p>Oh, we probably switched to &gt;50K mode. One sec.</p>",
        "id": 477021820,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729008006
    },
    {
        "content": "<p>Here, please try this one: <a href=\"https://dataverse.harvard.edu/sitemap_index.xml\">https://dataverse.harvard.edu/sitemap_index.xml</a></p>",
        "id": 477022139,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729008106
    },
    {
        "content": "<p>If it's helpful, here are our docs on it: <a href=\"https://guides.dataverse.org/en/6.4/installation/config.html#multiple-sitemap-files-sitemap-index-file\">https://guides.dataverse.org/en/6.4/installation/config.html#multiple-sitemap-files-sitemap-index-file</a></p>",
        "id": 477022269,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729008135
    },
    {
        "content": "<p>Ah, perfect. Our spider can handle indexed sitemaps. Thank you!</p>",
        "id": 477023152,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1729008383
    },
    {
        "content": "<p>Sure thing, I wonder if we should do something with the old, aging, single-file sitemap. <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>",
        "id": 477023712,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729008560
    },
    {
        "content": "<p>Yeah, good question. Maybe a <code>moved permanently</code> that redirects to the base of the index?</p>",
        "id": 477023975,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1729008639
    },
    {
        "content": "<p>Good idea. I'm asking internally.</p>",
        "id": 477024668,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729008840
    },
    {
        "content": "<p>Weird: the new sitemap doesn't seem to have records newer than <code>2024-07-03</code> either.</p>",
        "id": 477024953,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1729008913
    },
    {
        "content": "<p><img alt=\":doh:\" class=\"emoji\" src=\"https://avatars.zulip.com/53090/emoji/images/343009b9.png\" title=\"doh\"></p>",
        "id": 477025031,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729008945
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"659827\">@Ian Nesbitt</span> ok! The sitemap should be fixed now. Please try again. And thanks again for letting us know!</p>",
        "id": 477042159,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729014648
    },
    {
        "content": "<p>Thank you <span class=\"user-mention\" data-user-id=\"598112\">@Philip Durbin 🐉</span> ! Yes, I'm scraping 4200 new records now.</p>",
        "id": 477043751,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1729015271
    },
    {
        "content": "<p>Great news. And where are we with \"rights holder\" and \"submitter\"? Some day it would be nice to fill these in with the proper values. Maybe stuff like \"CC0\" and whoever is in the Depositor field? Of course, hiding these values for now, if they don't have accurate information, sounds good to me.</p>",
        "id": 477045262,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729015830
    },
    {
        "content": "<p>Because the records are maintained automatically, the rights have to be the same across the board. I can change the <code>rightsHolder</code> field to my ORCiD. The <code>submitter</code> field is immutable, unfortunately, so I think the best route to take would be to just hide them from view of the end user so it doesn't get misinterpreted as to why it's not the authors themselves. Because in essence, those rights <strong><em>are</em></strong> held by the authors themselves, they just have to edit the HD record, since the DataONE record is automatically drawn from HD.</p>",
        "id": 477055282,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1729019774
    },
    {
        "content": "<p>I will raise this issue at our meeting on Thursday and let you know the outcome.</p>",
        "id": 477055365,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1729019812
    },
    {
        "content": "<p>Thanks, I'm curious what people think about this.</p>",
        "id": 477063127,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729023024
    },
    {
        "content": "<p>From my perspective \"submitter\" maps to \"depositor\" in Dataverse.</p>",
        "id": 477063184,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729023057
    },
    {
        "content": "<p>And rights are always a hot mess. <span aria-label=\"crazy\" class=\"emoji emoji-1f61c\" role=\"img\" title=\"crazy\">:crazy:</span></p>",
        "id": 477063210,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729023067
    },
    {
        "content": "<p>But we do have lots of fields in Dataverse for rights if you want them! <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 477063242,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729023084
    },
    {
        "content": "<blockquote>\n<p>From my perspective \"submitter\" maps to \"depositor\" in Dataverse.</p>\n</blockquote>\n<p>Does Dataverse require ORCiDs for submission? If so that would be a fairly 1:1 translation...</p>",
        "id": 477065864,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1729024249
    },
    {
        "content": "<p>No, ORCIDs are optional</p>",
        "id": 477066431,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729024459
    },
    {
        "content": "<p>Our <code>submitter</code> field corresponds to the user identifier of the party that initially deposited the dataset (and is immutable via the API from the time of first deposit). It is closely aligned to <code>rightsHolder</code>, which is the user identifier of the party that has full access rights over the dataset, which can change through time (in addition to any other access rules that are provided for other users). The values in these fields are typically ORCID values now, but could also be any identifier from an identity provider that you use (e.g., from CILogon, Globus Auth, OpenID Connect, etc).</p>",
        "id": 477069935,
        "sender_full_name": "Matt Jones",
        "timestamp": 1729026076
    },
    {
        "content": "<p>Ideally we like to have the info as it applies to each dataset individually, but in the case of <a href=\"http://schema.org\">schema.org</a> harvests, this info is usually not in the record, and so we have reverted to setting a global value for the whole collection. Which is where we went awry from your perspective, I think. Maybe we need to standardize/clarify how rights and access fields are populated in <a href=\"http://schema.org\">schema.org</a> Dataset entries to promote interoperability?</p>",
        "id": 477070286,
        "sender_full_name": "Matt Jones",
        "timestamp": 1729026221
    },
    {
        "content": "<p>We've been gaining members of DataONE that use the Dataverse platform (e.g., DataverseNO most recently), and so it would be good to iron out these details for all groups that might wish to join.</p>",
        "id": 477070746,
        "sender_full_name": "Matt Jones",
        "timestamp": 1729026417
    },
    {
        "content": "<p>Maybe. These days we're using Croissant as an extension of <a href=\"http://Schema.org\">Schema.org</a>.</p>\n<p>Here's an example: <a href=\"https://dataverse.harvard.edu/api/datasets/export?exporter=croissant&amp;persistentId=doi%3A10.7910/DVN/HOLVXA\">https://dataverse.harvard.edu/api/datasets/export?exporter=croissant&amp;persistentId=doi%3A10.7910/DVN/HOLVXA</a></p>",
        "id": 477070749,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729026418
    },
    {
        "content": "<p>We don't seem to put Dataverse's \"depositor\" field in there. If there's a good place for it, we certainly could.</p>",
        "id": 477070852,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729026469
    },
    {
        "content": "<p>We do populate \"creator\" but this can be different than \"depositor\". A depositor can upload data on a creator/author's behalf in Dataverse.</p>",
        "id": 477070956,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729026503
    },
    {
        "content": "<p>But yes, yes, yes, we should align! <span aria-label=\"grinning\" class=\"emoji emoji-1f600\" role=\"img\" title=\"grinning\">:grinning:</span></p>",
        "id": 477070991,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729026517
    },
    {
        "content": "<p>Yeah, <code>creator</code> and <code>rightsHolder</code> in DataONE are certainly different. We interpret <code>creator</code> following SOSO to be the list of parties that should be cited/attributed for the Dataset. Whereas <code>rightsHolder</code> is about access control, and orthogonal to attribution. Various other parties can act on behalf of creators when editing and depositing datasets. So I think a separate set of roles around rightsHolder, submitter/depositor, and access control lists could be useful. But its only really useful to people that are trying to use interoperable editing APIs (and not just public read access).</p>",
        "id": 477071736,
        "sender_full_name": "Matt Jones",
        "timestamp": 1729026812
    },
    {
        "content": "<p>(Hi Phil! Glad to be chatting again, it has been quite a while!)</p>",
        "id": 477071835,
        "sender_full_name": "Matt Jones",
        "timestamp": 1729026866
    },
    {
        "content": "<p>SOSO?</p>",
        "id": 477072935,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729027380
    },
    {
        "content": "<p>Also, can you please remind me... is DataONE getting Dataverse metadata from the <code>&lt;head&gt;</code> of dataset pages as <a href=\"http://Schema.org\">Schema.org</a> JSON-LD?</p>",
        "id": 477073116,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729027451
    },
    {
        "content": "<p>SOSO - <a href=\"http://science-on-schema.org\">science-on-schema.org</a></p>",
        "id": 477073173,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1729027488
    },
    {
        "content": "<p>ooo, fun!</p>",
        "id": 477073241,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729027520
    },
    {
        "content": "<blockquote>\n<p>is DataONE getting Dataverse metadata from the <code>&lt;head&gt;</code> of dataset pages as <a href=\"http://schema.org/\">Schema.org</a> JSON-LD?</p>\n</blockquote>\n<p>IIRC we're doing content negotiation and grabbing it from an AWS instance</p>",
        "id": 477073269,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1729027537
    },
    {
        "content": "<p>I wonder if the Croissant folks know about this <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>",
        "id": 477073274,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729027538
    },
    {
        "content": "<p>well, sure, we're on AWS</p>",
        "id": 477073403,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729027594
    },
    {
        "content": "<p>Is the code open source?</p>",
        "id": 477073423,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729027605
    },
    {
        "content": "<p>Yes—it's located at <a href=\"https://github.com/DataONEorg/mnlite\">https://github.com/DataONEorg/mnlite</a></p>",
        "id": 477073499,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1729027653
    },
    {
        "content": "<p>After downloading and parsing the sitemaps, we query each page listed and ask for JSON-LD, which I think causes a redirect to a request like this:</p>\n<div class=\"codehilite\"><pre><span></span><code>https://dvn-cloud.s3.us-east-1.amazonaws.com/10.7910/DVN/BUOUNW/export_schema.org.cached?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAIEJ3NV7UYCSRJC7A%2F20240925%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20240925T082255Z&amp;X-Amz-Expires=7200&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=ce9e514a3d9e1c521733311b597a7df31e4e8387b0b6b353891f1a2c30635b28\n</code></pre></div>",
        "id": 477073916,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1729027830
    },
    {
        "content": "<p>On a related note, every once in a while we seem to be running into an issue where the server only returns half of a json document...</p>",
        "id": 477074764,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1729028208
    },
    {
        "content": "<p>Carl Boettiger has been pursuing the SOSO-Croissant mapping and how they relate to one another, and it has been discussed a few times in ESIP cluster meetings, but we haven't dove into it in detail yet.</p>",
        "id": 477074964,
        "sender_full_name": "Matt Jones",
        "timestamp": 1729028288
    },
    {
        "content": "<p>Thanks, make sense. Looks like you're using <code>export_schema.org.cached</code> but if you want, you could switch to <code>export_croissant.cached</code>. Google Dataset Search is encouraging sites to switch to Croissant. Please see also this <a href=\"https://groups.google.com/g/dataverse-community/c/JI8HPgGarr8/m/y05wm0R8DwAJ\">summary</a> I wrote.</p>",
        "id": 477082349,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729032259
    },
    {
        "content": "<p>I don't see Carl in the Croissant meeting minutes but I do see mention of <a href=\"http://science-on-schema.org\">science-on-schema.org</a>. Thanks for putting this on my radar.</p>",
        "id": 477082634,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729032407
    },
    {
        "content": "<p>Ah, it looks like <span class=\"user-mention\" data-user-id=\"621770\">@Julian Gautier</span> <a href=\"https://github.com/IQSS/dataverse/issues/7349#issuecomment-812261349\">attended</a> the DataONE \"Science on <a href=\"http://Schema.org\">Schema.org</a> Guidelines and Experiences\" call back in 2021. Good.</p>",
        "id": 477218685,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1729086228
    },
    {
        "content": "<p>Good morning <span class=\"user-mention\" data-user-id=\"598112\">@Philip Durbin</span> and team. We've received some requests for DataONE to index location information for Dataverse datasets, but I don't think we scrape any from the SOSO docs. Do you store location information (bounding boxes, points, etc?) Is there a way for me to request that this info gets serialized into <a href=\"http://schema.org\">schema.org</a> documents in future versions of the Dataverse software?</p>",
        "id": 523282972,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1749559528
    },
    {
        "content": "<p>Hi! We're about to start our annual conference (<a class=\"stream-topic\" data-stream-id=\"375707\" href=\"/#narrow/channel/375707-community/topic/.23Dataverse2025/with/464418895\">#community &gt; #Dataverse2025</a>) but quickly, yes, please check the geospatial metadata block for a bounding box.</p>",
        "id": 523283244,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1749559605
    },
    {
        "content": "<p>Ah, exciting! Have a great conference!</p>",
        "id": 523283678,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1749559726
    },
    {
        "content": "<p>Thanks. Which of these export formats are you importing? <a href=\"https://dataverse.harvard.edu/api/info/exportFormats\">https://dataverse.harvard.edu/api/info/exportFormats</a></p>",
        "id": 523284034,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1749559830
    },
    {
        "content": "<p><code>application/ld+json</code> (<a href=\"http://schema.org\">schema.org</a>)</p>",
        "id": 523284178,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1749559873
    },
    {
        "content": "<p>Some datasets have place names, but I don't think we get any quantitative locations</p>",
        "id": 523284660,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1749559998
    },
    {
        "content": "<p>Don't feel the need to respond now, I can wait until after the conference to talk about this</p>",
        "id": 523285455,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1749560212
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"659827\">@Ian Nesbitt</span> We're back! And I think I have some good news for you. I hope! <span aria-label=\"smile\" class=\"emoji emoji-1f604\" role=\"img\" title=\"smile\">:smile:</span> </p>\n<p>I started with <a href=\"https://dataverse.harvard.edu/api/search?q=*&amp;geo_point=42.3,-71.1&amp;geo_radius=1.5\">https://dataverse.harvard.edu/api/search?q=*&amp;geo_point=42.3,-71.1&amp;geo_radius=1.5</a> which is the example of a geospatial search at <a href=\"https://guides.dataverse.org/en/6.6/api/search.html\">https://guides.dataverse.org/en/6.6/api/search.html</a></p>\n<p>This lead me to <a href=\"https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/E8Z5Q3\">https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/E8Z5Q3</a></p>\n<p>If you export as <a href=\"http://Schema.org\">Schema.org</a> JSON-LD like this: <a href=\"https://dataverse.harvard.edu/api/datasets/export?exporter=schema.org&amp;persistentId=doi%3A10.7910/DVN/E8Z5Q3\">https://dataverse.harvard.edu/api/datasets/export?exporter=schema.org&amp;persistentId=doi%3A10.7910/DVN/E8Z5Q3</a></p>\n<p>You'll see this:</p>\n<div class=\"codehilite\"><pre><span></span><code>  &quot;spatialCoverage&quot;: [\n    &quot;North America&quot;,\n    &quot;Global&quot;\n  ]\n</code></pre></div>",
        "id": 524321340,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1750102375
    },
    {
        "content": "<p>It's not bounding boxes but you can get them from Dataverse's native JSON format if you like: <a href=\"https://dataverse.harvard.edu/api/datasets/export?exporter=dataverse_json&amp;persistentId=doi%3A10.7910/DVN/E8Z5Q3\">https://dataverse.harvard.edu/api/datasets/export?exporter=dataverse_json&amp;persistentId=doi%3A10.7910/DVN/E8Z5Q3</a></p>",
        "id": 524321448,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1750102426
    },
    {
        "content": "<p>Or the OAI_ORE format: <a href=\"https://dataverse.harvard.edu/api/datasets/export?exporter=OAI_ORE&amp;persistentId=doi%3A10.7910/DVN/E8Z5Q3\">https://dataverse.harvard.edu/api/datasets/export?exporter=OAI_ORE&amp;persistentId=doi%3A10.7910/DVN/E8Z5Q3</a></p>",
        "id": 524321526,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1750102457
    },
    {
        "content": "<p>Ah, I was just typing a message to you. Hope your conference went well!</p>",
        "id": 524321972,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1750102653
    },
    {
        "content": "<p>Yep! Good times. Too short. <span aria-label=\"smile\" class=\"emoji emoji-1f604\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 524322043,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1750102683
    },
    {
        "content": "<p>I do see the semantic place names in <code>spatialCoverage</code> but when we found the geospatial metadata block field definitions last week it confirmed my suspicion that the quantitative location information doesn't get serialized to <a href=\"http://schema.org\">schema.org</a></p>",
        "id": 524322567,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1750102908
    },
    {
        "content": "<p>Right. It doesn't seem to. Should it? Is there a good place in <a href=\"http://schema.org\">schema.org</a> (and Croissant, if you're familiar) for bounding boxes?</p>",
        "id": 524323058,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1750103163
    },
    {
        "content": "<p>Yes they do! It looks like this:</p>\n<div class=\"codehilite\" data-code-language=\"JSON-LD\"><pre><span></span><code><span class=\"w\">  </span><span class=\"nt\">\"spatialCoverage\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"nd\">\"@type\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Place\"</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"nt\">\"geo\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">      </span><span class=\"nd\">\"@type\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"GeoShape\"</span><span class=\"p\">,</span>\n<span class=\"w\">      </span><span class=\"nt\">\"box\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"{SOUTH} {WEST} {NORTH} {EAST}\"</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n<span class=\"w\">  </span><span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div>",
        "id": 524323412,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1750103336
    },
    {
        "content": "<p>For SO</p>",
        "id": 524323442,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1750103350
    },
    {
        "content": "<p>Interesting. Would you be able to make a feature request? <a href=\"https://github.com/IQSS/dataverse/issues\">https://github.com/IQSS/dataverse/issues</a></p>",
        "id": 524323522,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1750103392
    },
    {
        "content": "<p>You can read about it in the <a href=\"http://science-on-schema.org\">science-on-schema.org</a> Dataset guide: <a href=\"https://github.com/ESIPFed/science-on-schema.org/blob/main/guides/Dataset.md#spatial-coverage\">https://github.com/ESIPFed/science-on-schema.org/blob/main/guides/Dataset.md#spatial-coverage</a></p>",
        "id": 524323574,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1750103419
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"598112\">Philip Durbin</span> <a href=\"#narrow/channel/378866-troubleshooting/topic/DataONE.20search/near/524323522\">said</a>:</p>\n<blockquote>\n<p>Interesting. Would you be able to make a feature request? <a href=\"https://github.com/IQSS/dataverse/issues\">https://github.com/IQSS/dataverse/issues</a></p>\n</blockquote>\n<p>Definitely</p>",
        "id": 524323602,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1750103432
    },
    {
        "content": "<p>Awesome. Thanks. Also, out of curiosity, have you heard of Croissant? Any interest in it? It's also based on <a href=\"http://schema.org\">schema.org</a>.</p>\n<p>I ask because from the Dataverse perspective, we implemented the original <code>JSON-LD Schema.org</code> format to support Google Dataset Search. But now they've deprecated it in favor of Croissant.</p>",
        "id": 524323815,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1750103532
    },
    {
        "content": "<p>Yes, and we've discussed formally adopting it as well, but haven't made any official moves towards that yet</p>",
        "id": 524324124,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1750103622
    },
    {
        "content": "<p>Ok. I'm just reviewing <a href=\"https://dataverse.harvard.edu/api/info/exportFormats\">https://dataverse.harvard.edu/api/info/exportFormats</a> again and if I'm not wrong Dataverse supports three formats based on <a href=\"http://schema.org\">schema.org</a>:</p>\n<ul>\n<li>OAI_ORE</li>\n<li><a href=\"http://schema.org\">schema.org</a></li>\n<li>croissant</li>\n</ul>\n<p>Would you want that \"geo box\" info in all three formats?</p>",
        "id": 524324467,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1750103766
    },
    {
        "content": "<p>I don't know exactly how that field translates from standard SO, but those other formats definitely support bounding boxes so I'll try to include it in the issue</p>",
        "id": 524324850,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1750103933
    },
    {
        "content": "<p>I think the answer is \"yes\"</p>",
        "id": 524324890,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1750103951
    },
    {
        "content": "<p>Great, thanks. If you want you can just say \"all formats based on <a href=\"http://schema.org\">schema.org</a>\".</p>",
        "id": 524324925,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1750103964
    },
    {
        "content": "<p>Ok. I need to finish some other stuff but I can probably post the issue later this evening</p>",
        "id": 524325078,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1750104022
    },
    {
        "content": "<p>no rush, we don't have time to work on it anyway <span aria-label=\"crazy\" class=\"emoji emoji-1f61c\" role=\"img\" title=\"crazy\">:crazy:</span></p>",
        "id": 524325116,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1750104040
    },
    {
        "content": "<p>Same story here at DataONE as always :)</p>",
        "id": 524325230,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1750104085
    },
    {
        "content": "<p>I figured <span aria-label=\"rofl\" class=\"emoji emoji-1f923\" role=\"img\" title=\"rofl\">:rofl:</span></p>",
        "id": 524325264,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1750104101
    },
    {
        "content": "<p>Submitted: <a href=\"https://github.com/IQSS/dataverse/issues/11582\">https://github.com/IQSS/dataverse/issues/11582</a></p>",
        "id": 524468703,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1750170976
    },
    {
        "content": "<p>Looks great! Thanks! I made a couple tiny tweaks.</p>",
        "id": 524469158,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1750171119
    },
    {
        "content": "<p>Thanks! You are quick!</p>",
        "id": 524469469,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1750171216
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"598112\">@Philip Durbin 🚀</span> , we have been having an issue that I've missed since July...it seems our scraper is getting empty status code 202 responses from the HD server when it tries to get the base sitemap. I think the reason I missed it is because it doesn't register as an error...</p>",
        "id": 547347141,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1761589755
    },
    {
        "content": "<p>Here's what's returned when I wget from the scraper server:</p>\n<div class=\"codehilite\"><pre><span></span><code>$ wget https://dataverse.harvard.edu/sitemap_index.xml\n--2025-10-27 18:35:21--  https://dataverse.harvard.edu/sitemap_index.xml\nResolving dataverse.harvard.edu (dataverse.harvard.edu)... 54.86.163.49, 3.211.175.147, 3.215.43.147\nConnecting to dataverse.harvard.edu (dataverse.harvard.edu)|54.86.163.49|:443... connected.\nHTTP request sent, awaiting response... 202 Accepted\nLength: 0 [text/html]\nSaving to: ‘sitemap_index.xml’\n\nsitemap_index.xml                                [ &lt;=&gt;                                                                                         ]       0  --.-KB/s    in 0s\n\n2025-10-27 18:35:22 (0.00 B/s) - ‘sitemap_index.xml’ saved [0/0]\n</code></pre></div>",
        "id": 547348515,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1761590236
    },
    {
        "content": "<p>Length 0. Interesting.</p>",
        "id": 547350159,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1761590863
    },
    {
        "content": "<p>It loads fine in a browser which is odd</p>",
        "id": 547356331,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1761593176
    },
    {
        "content": "<p>Hey all. I used to scrape the HTML of certain types of pages on Harvard Dataverse and had to stop back in April 2025. Leonid told me back then that the 202 status code I was seeing was because the IT folks who help manage security related things for Harvard Dataverse (HUIT) implemented some \"silent challenge\" that makes pages accessible from browsers only (or by using a Harvard VPN, although I couldn't get this to work back then, and eventually I stopped needing to scrape).</p>",
        "id": 547359896,
        "sender_full_name": "Julian Gautier",
        "timestamp": 1761594637
    },
    {
        "content": "<p>Ah. Well, that would explain it. Thank you <span class=\"user-mention\" data-user-id=\"621770\">@Julian Gautier</span></p>",
        "id": 547362291,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1761595492
    },
    {
        "content": "<p>I imagine you're getting crawled by all sorts of LLM scrapers so I understand the necessity, but it would be nice if DataONE's metadata scraper could exempted from that restriction, because people do expect HD records to be aggregated in DataONE and we do send legitimate traffic to HD...</p>",
        "id": 547363497,
        "sender_full_name": "Ian Nesbitt",
        "timestamp": 1761595955
    },
    {
        "content": "<p>And it's still necessary to scrape the page instead of using the Dataverse API, right? I was able to stop scraping when the info I needed was made available with a new API endpoint, and I was able to use that instead. Sorry if I'm asking a question you've already talked about. I haven't read everything in this thread yet <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 547364104,
        "sender_full_name": "Julian Gautier",
        "timestamp": 1761596189
    },
    {
        "content": "<p>It's ok. We parse the sitemaps to get landing page URLs for datasets, then use the <code>lastmod</code> date to filter for only the most recent ones, and download JSON-LD metadata from the endpoint using content negotiation. It's similar to what the Google Dataset Search scraper is doing</p>",
        "id": 547365043,
        "sender_full_name": "Ian Nesbitt - DataONE",
        "timestamp": 1761596572
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"659827\">@Ian Nesbitt - DataONE</span> could you use Signposting to get the links to the JSON-LD files?</p>\n<p>Please see this PR: expose links to all export formats via Signposting <a href=\"https://github.com/IQSS/dataverse/issues/11045\">#11045</a></p>",
        "id": 547365574,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1761596775
    },
    {
        "content": "<p>And <a href=\"https://guides.dataverse.org/en/6.8/api/native-api.html#retrieve-signposting-information\">https://guides.dataverse.org/en/6.8/api/native-api.html#retrieve-signposting-information</a></p>",
        "id": 547365655,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1761596813
    },
    {
        "content": "<p>I'm sure I can find a way to make HEAD requests to the landing pages. Currently we're doing <code>GET</code> requests but using content negotiation to ask for JSON-LD, so the response redirects us to a URL like <code>\nhttps://dvn-cloud.s3.us-east-1.amazonaws.com/10.7910/DVN/BUOUNW/export_schema.org.cached?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAIEJ3NV7UYCSRJC7A%2F20240925%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20240925T082255Z&amp;X-Amz-Expires=7200&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=ce9e514a3d9e1c521733311b597a7df31e4e8387b0b6b353891f1a2c30635b28</code></p>\n<p>Would the HEAD request be any more efficient than the content negotiation we currently use?</p>",
        "id": 547366801,
        "sender_full_name": "Ian Nesbitt - DataONE",
        "timestamp": 1761597281
    },
    {
        "content": "<p>Definitely. Right now you're getting the whole payload of the page with a GET, right?</p>",
        "id": 547366879,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1761597317
    },
    {
        "content": "<p>I don't think we end up having to download any XHTML, because we get redirected to that <code>export_schema.org.cached</code> function when the server sees content negotiation in the request, which I assumed was the most efficient way of doing things</p>",
        "id": 547367424,
        "sender_full_name": "Ian Nesbitt - DataONE",
        "timestamp": 1761597574
    },
    {
        "content": "<p>I see. So you're already skipping the step of doing a GET of the dataset landing page, you're saying. You go directly to the cached export by constructing the URL you need based on the DOI. Is that right?</p>",
        "id": 547367684,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1761597693
    },
    {
        "content": "<p>Correct. I can recreate the requests in a <code>curl -v</code> command and show you the outputs but I assume I'd run into the aforementioned command line restriction</p>",
        "id": 547367872,
        "sender_full_name": "Ian Nesbitt - DataONE",
        "timestamp": 1761597784
    },
    {
        "content": "<p>Can you set the user agent to look like a browser?</p>",
        "id": 547368010,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1761597856
    },
    {
        "content": "<p>I can. In the scraper or the curl command?</p>",
        "id": 547368121,
        "sender_full_name": "Ian Nesbitt - DataONE",
        "timestamp": 1761597915
    },
    {
        "content": "<p>Maybe try in curl and if it works, try in the scraper?</p>",
        "id": 547368188,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1761597951
    },
    {
        "content": "<p>Sadly it still knows I'm on the command line:</p>\n<div class=\"codehilite\"><pre><span></span><code>$ curl -v -A &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:143.0) Gecko/20100101 Firefox/143.0&quot; https://dataverse.harvard.edu/sitemap_index.xml\n*   Trying 3.211.175.147:443...\n* TCP_NODELAY set\n* Connected to dataverse.harvard.edu (3.211.175.147) port 443 (#0)\n* ALPN, offering h2\n* ALPN, offering http/1.1\n* successfully set certificate verify locations:\n*   CAfile: /etc/ssl/certs/ca-certificates.crt\n  CApath: /etc/ssl/certs\n* TLSv1.3 (OUT), TLS handshake, Client hello (1):\n* TLSv1.3 (IN), TLS handshake, Server hello (2):\n* TLSv1.2 (IN), TLS handshake, Certificate (11):\n* TLSv1.2 (IN), TLS handshake, Server key exchange (12):\n* TLSv1.2 (IN), TLS handshake, Server finished (14):\n* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):\n* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):\n* TLSv1.2 (OUT), TLS handshake, Finished (20):\n* TLSv1.2 (IN), TLS handshake, Finished (20):\n* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256\n* ALPN, server accepted to use h2\n* Server certificate:\n*  subject: C=US; ST=Massachusetts; O=President and Fellows of Harvard College; CN=dataverse.harvard.edu\n*  start date: Apr 30 00:00:00 2025 GMT\n*  expire date: May 31 23:59:59 2026 GMT\n*  subjectAltName: host &quot;dataverse.harvard.edu&quot; matched cert&#39;s &quot;dataverse.harvard.edu&quot;\n*  issuer: C=US; O=Internet2; CN=InCommon RSA Server CA 2\n*  SSL certificate verify ok.\n* Using HTTP2, server supports multi-use\n* Connection state changed (HTTP/2 confirmed)\n* Copying HTTP/2 data in stream buffer to connection buffer after upgrade: len=0\n* Using Stream ID: 1 (easy handle 0x55c388e8e0d0)\n&gt; GET /sitemap_index.xml HTTP/2\n&gt; Host: dataverse.harvard.edu\n&gt; user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:143.0) Gecko/20100101 Firefox/143.0\n&gt; accept: */*\n&gt;\n* Connection state changed (MAX_CONCURRENT_STREAMS == 128)!\n&lt; HTTP/2 202\n&lt; server: awselb/2.0\n&lt; date: Mon, 27 Oct 2025 20:53:52 GMT\n&lt; content-length: 0\n&lt; x-amzn-waf-action: challenge\n&lt; cache-control: no-store, max-age=0\n&lt; content-type: text/html; charset=UTF-8\n&lt; access-control-allow-origin: *\n&lt; access-control-max-age: 86400\n&lt; access-control-allow-methods: OPTIONS,GET,POST\n&lt; access-control-expose-headers: x-amzn-waf-action\n&lt;\n* Connection #0 to host dataverse.harvard.edu left intact\n</code></pre></div>",
        "id": 547369448,
        "sender_full_name": "Ian Nesbitt - DataONE",
        "timestamp": 1761598504
    },
    {
        "content": "<p><img alt=\":doh:\" class=\"emoji\" src=\"https://avatars.zulip.com/53090/emoji/images/343009b9.png\" title=\"doh\"></p>",
        "id": 547369750,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1761598616
    },
    {
        "content": "<p>I pinged Leo earlier. Maybe he'll save us.</p>",
        "id": 547369813,
        "sender_full_name": "Philip Durbin 🚀",
        "timestamp": 1761598641
    },
    {
        "content": "<p>Hi Ian, </p>\n<blockquote>\n<p><code>&lt; HTTP/2 202</code><br>\n<code>&lt; access-control-expose-headers: x-amzn-waf-action</code></p>\n</blockquote>\n<p>Yes, this is <a href=\"https://docs.aws.amazon.com/waf/latest/developerguide/waf-captcha-and-challenge-how-it-works.html\">AWS WAF Silent Challenge</a> that HUIT are enforcing on our UI pages now, to weed out non-browser calls. (HUIT is the Harvard group that runs the load balancer our servers sit behind). <br>\nPlease send me your crawler's ip address(es)/subnets so that I could ask them to be exempted from this WAF rule. <br>\nI checked and I still have the rewrite rules in place for your crawler to serve fast redirects to exported metadata records on S3. <br>\n(for the record, our <code>/api</code> is exempt from this blocking; but I'm not suggesting going through that as a solution, since I remember you had reasons to prefer to follow the standard sitemap route. Plus the custom redirects worked really well in the end). </p>\n<p>And yes, virtually all Harvard sites that serve any data that can be fed to LLMs have been getting crawled to death. So they've been resorting to increasingly harsh measures to protect the perimeter from the bots. </p>\n<p>We'll work it out. <br>\nAll the best, <br>\n-Leo</p>\n<p>P.S. I have <code>128.111.85.17</code> for your spider in my records - but that was a while ago.</p>",
        "id": 547376865,
        "sender_full_name": "Leo Andreev",
        "timestamp": 1761601665
    },
    {
        "content": "<p>Hi Leo, makes sense—I'm actually not sure if our IPs have changed but we have a production scraper at <code>128.111.85.168</code> (<a href=\"http://sonode.dataone.org\">sonode.dataone.org</a>) and a test scraper at <code>128.111.85.172</code> (<a href=\"http://so.test.dataone.org\">so.test.dataone.org</a>).</p>\n<p>Yes, we do have to download and parse the whole sitemap unfortunately, but the redirects have been working quite well!</p>",
        "id": 547379381,
        "sender_full_name": "Ian Nesbitt - DataONE",
        "timestamp": 1761602951
    },
    {
        "content": "<p>I got a confirmation that the 2 ips above have been added to the exemptions list.</p>",
        "id": 547524336,
        "sender_full_name": "Leo Andreev",
        "timestamp": 1761665242
    },
    {
        "content": "<p>Could you please remind me if your crawler can be throttled as not to exceed a certain call rate? <br>\nThat's another thing HUIT are enforcing. Unlike the silent challenges, and for reasons I don't fully understand, they have been unable to grant us exceptions for specific url patterns etc. with that. <br>\nAt the moment the rate is defined as 300 calls/5 min., after which they put the ip on their crap list (code 403) for the next 5 min.</p>",
        "id": 547525637,
        "sender_full_name": "Leo Andreev",
        "timestamp": 1761665576
    },
    {
        "content": "<p>(I am working with them on relaxing these rules/making them more flexible etc., as this is causing us real problems; but that's what we have to work around at the moment)</p>",
        "id": 547526112,
        "sender_full_name": "Leo Andreev",
        "timestamp": 1761665683
    },
    {
        "content": "<p>We can delay each call as much as needed. Currently we enforce a 2-second delay between each.</p>",
        "id": 547527667,
        "sender_full_name": "Ian Nesbitt - DataONE",
        "timestamp": 1761666036
    },
    {
        "content": "<p>Great, that should be <del>more</del> slower than enough.</p>",
        "id": 547528530,
        "sender_full_name": "Leo Andreev",
        "timestamp": 1761666226
    },
    {
        "content": "<p>I think if I set it to 1/sec it would be fine, because the delay time does not include processing time, but I also want to be kind to your servers and there's really no rush in getting the scrape done.</p>",
        "id": 547530538,
        "sender_full_name": "Ian Nesbitt - DataONE",
        "timestamp": 1761666661
    },
    {
        "content": "<p>A brief update: we successfully scraped ~11,000 new and changed records, and metadata is once again flowing from HD to DataONE! <span aria-label=\"tada\" class=\"emoji emoji-1f389\" role=\"img\" title=\"tada\">:tada:</span> Thank you <span class=\"user-mention\" data-user-id=\"637063\">@Leo Andreev</span> !!</p>",
        "id": 547970584,
        "sender_full_name": "Ian Nesbitt - DataONE",
        "timestamp": 1761838676
    },
    {
        "content": "<p>Sweet, happy to hear.</p>",
        "id": 547982038,
        "sender_full_name": "Leo Andreev",
        "timestamp": 1761841567
    }
]