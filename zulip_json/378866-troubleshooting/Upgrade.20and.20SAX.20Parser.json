[
    {
        "content": "<p>Hello, </p>\n<p>I'm tracking down some weirdness I'm seeing in log messages in a recent upgrade.   </p>\n<p>In doing so, I noticed that, in version 6.0 upgrade of Dataverse, the SAXParserFactory specification in the Domain.xml file appears to get dropped.  </p>\n<p>Is that intentional?   I'm not clear what effect that would have on the software running, but just wanted to check. </p>\n<p>Here's the install of it in 6.8 - so it seems like it's still useful?  <a href=\"https://github.com/IQSS/dataverse/blob/d63a7b1b60d1e96a592745cc26b829c48fe7f7cc/scripts/installer/as-setup.sh#L145\">https://github.com/IQSS/dataverse/blob/d63a7b1b60d1e96a592745cc26b829c48fe7f7cc/scripts/installer/as-setup.sh#L145</a></p>\n<p>The instructions here do not propogate it forward during the upgrade, though.   (Step 6)  <a href=\"https://github.com/IQSS/dataverse/releases/tag/v6.0\">https://github.com/IQSS/dataverse/releases/tag/v6.0</a></p>\n<p>Is it necessary?  </p>\n<p>Thanks!</p>",
        "id": 548185011,
        "sender_full_name": "Bethany Seeger",
        "timestamp": 1761923941
    },
    {
        "content": "<p><code>&lt;jvm-options&gt;-Djavax.xml.parsers.SAXParserFactory=com.sun.org.apache.xerces.internal.jaxp.SAXParserFactoryImpl&lt;/jvm-options&gt;</code></p>",
        "id": 548185139,
        "sender_full_name": "Bethany Seeger",
        "timestamp": 1761923971
    },
    {
        "content": "<p>Huh, it looks like I added it in <a href=\"https://github.com/IQSS/dataverse/commit/c9da26b5373b1fd484de91d96ab848e948573080\">https://github.com/IQSS/dataverse/commit/c9da26b5373b1fd484de91d96ab848e948573080</a> 11 years ago (!) as a fix for this equally ancient issue:</p>\n<ul>\n<li>Dataverse Alias shows in the URLÂ <a href=\"https://github.com/IQSS/dataverse/issues/235\">#235</a></li>\n</ul>",
        "id": 553393482,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1762179835
    },
    {
        "content": "<p>I think we still want it. We still use PrettyFaces, which is what the fix was for.</p>",
        "id": 553394330,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1762180050
    },
    {
        "content": "<p>Interesting.  If the issue it was resolving is still resolved w/o that change, then maybe things are fine w/o the SAXparser in the domain.xml anymore. </p>\n<p>Ohh... interesting ... I need to look at our logs, as I'm seeing faces warnings....</p>",
        "id": 553394435,
        "sender_full_name": "Bethany Seeger",
        "timestamp": 1762180080
    },
    {
        "content": "<p>If you can do some testing with and without it, that would be great.</p>",
        "id": 553394531,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1762180106
    },
    {
        "content": "<p>And if you think we should update the 6.0 release notes to add it back in (sounds like maybe we should), if you could open an issue, I'd appreciate it!</p>",
        "id": 553395218,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1762180236
    },
    {
        "content": "<p>Is this related to pretty faces?  Seems unlikely, but figured I'd ask: </p>\n<div class=\"codehilite\"><pre><span></span><code>[2025-11-03T11:09:06.390+0000] [Payara 6.2023.8] [WARNING] [] [] [tid: _ThreadID=104 _ThreadName=http-thread-pool::jk-connector(1)] [timeMillis: 1762168146390] [levelValue: 900] [[\n  Skipping outbound rewriting of invalid URL: /?&quot;&gt;&lt;script&gt;alert(&#39;struts_sa_surl_xss.nasl-1762168146&#39;)&lt;/script&gt;]]\n\n[2025-11-03T11:09:06.526+0000] [Payara 6.2023.8] [WARNING] [] [jakarta.enterprise.web] [tid: _ThreadID=106 _ThreadName=http-thread-pool::jk-connector(3)] [timeMillis: 1762168146526] [levelValue: 900] [[\n  StandardWrapperValve[Faces Servlet]: Servlet.service() for servlet Faces Servlet threw exception\ncom.sun.faces.application.view.ViewHandlingStrategyNotFoundException\n        at java.base/java.util.Optional.orElseThrow(Optional.java:403)\n        at com.sun.faces.application.view.ViewHandlingStrategyManager.getStrategy(ViewHandlingStrategyManager.java:57)\n        at com.sun.faces.application.view.ViewDeclarationLanguageFactoryImpl.getViewDeclarationLanguage(ViewDeclarationLanguageFactoryImpl.java:45)\n        at com.sun.faces.application.view.MultiViewHandler.getViewDeclarationLanguage(MultiViewHandler.java:407)\n        at jakarta.faces.application.ViewHandlerWrapper.getViewDeclarationLanguage(ViewHandlerWrapper.java:335)\n        at jakarta.faces.application.ViewHandlerWrapper.getViewDeclarationLanguage(ViewHandlerWrapper.java:335)\n        at jakarta.faces.application.ViewHandlerWrapper.getViewDeclarationLanguage(ViewHandlerWrapper.java:335)\n        at com.sun.faces.lifecycle.RestoreViewPhase.execute(RestoreViewPhase.java:179)\n        at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:72)\n        at com.sun.faces.lifecycle.RestoreViewPhase.doPhase(RestoreViewPhase.java:95)\n        at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:159)\n        at jakarta.faces.webapp.FacesServlet.executeLifecyle(FacesServlet.java:691)\n        at jakarta.faces.webapp.FacesServlet.service(FacesServlet.java:449)\n        at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1554)\n</code></pre></div>",
        "id": 553395271,
        "sender_full_name": "Bethany Seeger",
        "timestamp": 1762180248
    },
    {
        "content": "<p>Probably outbound rewriting of invalid URL sounds like something PrettyFaces would do.</p>",
        "id": 553395714,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1762180362
    },
    {
        "content": "<p>Okay, I'll add the SAXParser back in and see if those types of errors go away.  I'll keep you posted.</p>",
        "id": 553396015,
        "sender_full_name": "Bethany Seeger",
        "timestamp": 1762180437
    },
    {
        "content": "<p>Does this mean anything significant?  They are SEVERE level : </p>\n<p>[2025-11-03T15:11:38.416+0000] [Payara 6.2023.8] [SEVERE] [] [jakarta.faces.component] [tid: _ThreadID=106 _ThreadName=http-thread-pool::jk-connector(3)] [timeMillis: 1762182698416] [levelValue: 1000] [[<br>\n  the component(jakarta.faces.component.html.HtmlDoctype@65f97a2a) is the head component of the stack, but it's _isPushedAsCurrentRefCount &lt; 1]]</p>\n<p>[2025-11-03T15:11:47.659+0000] [Payara 6.2023.8] [SEVERE] [] [jakarta.faces.component] [tid: _ThreadID=108 _ThreadName=http-thread-pool::jk-connector(5)] [timeMillis: 1762182707659] [levelValue: 1000] [[<br>\n  the component(jakarta.faces.component.html.HtmlDoctype@65f97a2a) is the head component of the stack, but it's _isPushedAsCurrentRefCount &lt; 1]]</p>\n<p>This is after I added in SAX Parser, but I think I've seen them even before that.</p>",
        "id": 553406217,
        "sender_full_name": "Bethany Seeger",
        "timestamp": 1762182767
    },
    {
        "content": "<p>Oddly enough, restarting made it go away.</p>",
        "id": 553410194,
        "sender_full_name": "Bethany Seeger",
        "timestamp": 1762183652
    },
    {
        "content": "<p>Huh, I'm really not sure. <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>",
        "id": 553411794,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1762183945
    },
    {
        "content": "<p>Yeah, it's odd.  I can't tell if adding back in the SAXParser makes a difference yet. It doesn't appear to have hurt.   Should I create an issue for the SAXParser on github so it can be discussed there?</p>",
        "id": 553486440,
        "sender_full_name": "Bethany Seeger",
        "timestamp": 1762206378
    },
    {
        "content": "<p>Yes, please!</p>",
        "id": 553491165,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1762208321
    }
]