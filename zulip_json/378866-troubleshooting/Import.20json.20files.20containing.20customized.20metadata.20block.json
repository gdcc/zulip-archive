[
    {
        "content": "<p>Hi Everyone, I added a customized metadata block and can add metadata to the new fields at the front end, but failed to import Json files containing the customized metadata. It seems the new block need to be added to ImportDDIServiceBean.java and ImportGenericServiceBean.java to make the API work. Is it the right way to do it? Are there easier solutions? Thanks!</p>",
        "id": 466042758,
        "sender_full_name": "Hansen Zhang",
        "timestamp": 1724944026
    },
    {
        "content": "<p>Huh. It should work! Here's what I'd suggest...</p>\n<ul>\n<li>Using the front end, create a dataset that contains fields in your custom metadata block.</li>\n<li>Save and publish.</li>\n<li>Download the metadata as JSON.</li>\n<li>Try creating a new dataset from the JSON.</li>\n</ul>",
        "id": 467325357,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1725385862
    },
    {
        "content": "<p>Of course, you might be talking about importing a new dataset rather than importing. But I'd start with creating first to make sure it's working.</p>",
        "id": 467325562,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1725385917
    },
    {
        "content": "<p>Hi Philip, Thanks for your great recommendations. I will give it a try. One thing I want to mention is that I decompiled and looked at the import class file after adding the custom metadata block, but did not see any of the custom metadata fields. Is that what it supposed to be?</p>",
        "id": 467330860,
        "sender_full_name": "Hansen Zhang",
        "timestamp": 1725387256
    },
    {
        "content": "<p>Well, it should all be written generically. I wouldn't expect you to see specific fields in the decompiled output.</p>",
        "id": 467336906,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1725389238
    },
    {
        "content": "<p>We have a custom metadata block and have been creating datasets with the customization fields via API. I have not touched any of the \"ServiceBean\" files.</p>\n<p>To set up our custom metadata block we followed the instructions here:<br>\n<a href=\"https://guides.dataverse.org/en/latest/admin/metadatacustomization.html\">https://guides.dataverse.org/en/latest/admin/metadatacustomization.html</a></p>\n<p>Once you have created a \".tsv\" file (properly formatted), then you 1) enable the metadata block, 2) update the Solr schema with the \"<a href=\"http://update-fields.sh\">update-fields.sh</a>\" script, 3) reload your Solr schema.</p>\n<p>If you can add metadata via the UI, then seems you have done the above steps.</p>\n<p>I would do what <span class=\"user-mention\" data-user-id=\"598112\">@Philip Durbin</span> suggests above - <br>\nI would export the dataset you created via the UI to see how the json is rendered and use that json as an example to create a new dataset via the API.</p>\n<p><code>curl \"$SERVER/api/datasets/export?exporter=dataverse_json&amp;persistentId=doi:$DOI\"</code></p>",
        "id": 467342423,
        "sender_full_name": "Sherry Lake",
        "timestamp": 1725390977
    },
    {
        "content": "<p>I just tried with an exported Json containing the metadata block. It seems the import worked with this message: {\"status\":\"OK\",\"data\":{\"id\":17,\"persistentId\":\"doi:10.5072/FK2/VRXQQ2\"}}. But the dataset does not show up in the app. I did the import again and  it says the dataset already exists.</p>",
        "id": 467343305,
        "sender_full_name": "Hansen Zhang",
        "timestamp": 1725391358
    },
    {
        "content": "<p>If the dataset exists, it should just make a \"draft\", right <span class=\"user-mention\" data-user-id=\"598112\">@Philip Durbin</span> <br>\n<span class=\"user-mention\" data-user-id=\"728331\">@Hansen Zhang</span> if you go to the dataset, in the UI, do you see other versions? Click the \"Versions\" tab. You should see something like this:<br>\n<a href=\"/user_uploads/53090/jB9-NLsnVkX66lXukvrcrCsk/Screenshot-2024-09-03-at-3.29.42PM.png\">Screenshot-2024-09-03-at-3.29.42PM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/53090/jB9-NLsnVkX66lXukvrcrCsk/Screenshot-2024-09-03-at-3.29.42PM.png\" title=\"Screenshot-2024-09-03-at-3.29.42PM.png\"><img data-original-dimensions=\"2074x636\" src=\"/user_uploads/thumbnail/53090/jB9-NLsnVkX66lXukvrcrCsk/Screenshot-2024-09-03-at-3.29.42PM.png/840x560.webp\"></a></div>",
        "id": 467344361,
        "sender_full_name": "Sherry Lake",
        "timestamp": 1725391812
    },
    {
        "content": "<p>Also who \"owns\" the dataset? If you are not logged in (and it was your token that created the dataset), you will not be able to see the dataset - until it is published.</p>",
        "id": 467344606,
        "sender_full_name": "Sherry Lake",
        "timestamp": 1725391909
    },
    {
        "content": "<p>I am doing it in a development environment. The imported dataset did not show up at all, although status was OK.</p>",
        "id": 467344883,
        "sender_full_name": "Hansen Zhang",
        "timestamp": 1725392040
    },
    {
        "content": "<p>I am doing it as the Admin and I logged in.</p>",
        "id": 467345106,
        "sender_full_name": "Hansen Zhang",
        "timestamp": 1725392159
    },
    {
        "content": "<p>Hi Philip and Sherry, I tried to upload the exported Json file to Dataverse in production. It worked. I have no idea what's wrong with my local installation. Thank you for your help!</p>",
        "id": 467347582,
        "sender_full_name": "Hansen Zhang",
        "timestamp": 1725392966
    },
    {
        "content": "<p>Oh, great! I'm glad it worked in prod.</p>",
        "id": 467349091,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1725393470
    }
]