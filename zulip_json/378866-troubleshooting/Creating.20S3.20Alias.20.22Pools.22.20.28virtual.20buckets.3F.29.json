[
    {
        "content": "<p>UVa wants to create a \"virtual\" S3 bucket... or an alias??</p>\n<p>We only have one S3 bucket, but want to allow users of one collection the ability to upload max filesize 100GB, while keeping the default bucket for all other collections at 6GB.</p>\n<p>I'm not sure which JVM options are needed to define this virtual pool.</p>\n<p>And would CORS be needed to be set up on the \"virtual\" bucket - or since it is already set up on the real bucket - the virtual one will use it?</p>",
        "id": 521333617,
        "sender_full_name": "Sherry Lake",
        "timestamp": 1748623133
    },
    {
        "content": "<p>Harvard Dataverse does this. We have several stores pointed at the same bucket. The upload limits for each store can be configured separately.</p>",
        "id": 521342189,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1748626405
    },
    {
        "content": "<p>Can you send me the JVM lines for Harvard's default set up and one of the virtual ones? I'm confused as to what is \"s3\" that specifies the Amazon S3 versus the &lt;id&gt; s3 in our JVM lines.</p>\n<p>Not sure which ones we need for virtual ones.</p>\n<p>We have this now, only one store:</p>\n<blockquote>\n<p>-Ddataverse.files.s3.type=s3<br>\n-Ddataverse.files.s3.label=Dataverse S3 Storage<br>\n-Ddataverse.files.s3.bucket-name=dataverse-storage-production<br>\n-Ddataverse.files.s3.download-redirect=true<br>\n-Ddataverse.files.storage-driver-id=s3<br>\n-Ddataverse.files.s3.upload-redirect=true<br>\n-Ddataverse.files.s3.profile=default<br>\n-Ddataverse.files.s3.url-expiration-minutes=480</p>\n</blockquote>\n<p>So I was assuming we add lines (w/ \"3d\" as the ID for our new virtual store):<br>\nFor the new \"3d\" (id=3d) store:<br>\n(the following lines like \"s3\" above, except \"storage-driver\" that is only for the default, which is still \"s3\"??)<br>\n<strong>?? And the bucket name stays the same... or is that different???</strong></p>\n<blockquote>\n<p>-Ddataverse.files.3d.type=s3<br>\n-Ddataverse.files.3d.label=3D Cultural Heritage<br>\n-Ddataverse.files.3d.bucket-name=dataverse-storage-production<br>\n-Ddataverse.files.3d.download-redirect=true<br>\n-Ddataverse.files.3d.upload-redirect=true<br>\n-Ddataverse.files.3d.profile=default<br>\n-Ddataverse.files.3d.url-expiration-minutes=480</p>\n</blockquote>",
        "id": 521350976,
        "sender_full_name": "Sherry Lake",
        "timestamp": 1748629824
    },
    {
        "content": "<p>I'm pretty sure the bucket name stays the same.</p>",
        "id": 521351449,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1748629975
    },
    {
        "content": "<p>I'm refreshing myself at <a href=\"https://guides.dataverse.org/en/6.6/installation/config.html#multi-store-basics\">https://guides.dataverse.org/en/6.6/installation/config.html#multi-store-basics</a> but yes \"storage-driver\" is how you set the default store, it looks like.</p>",
        "id": 521351763,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1748630106
    },
    {
        "content": "<p>It looks like Jim is saying similar stuff at <a href=\"https://groups.google.com/g/dataverse-community/c/ZCIJU-IknGg/m/dmSXCMFuAAAJ\">https://groups.google.com/g/dataverse-community/c/ZCIJU-IknGg/m/dmSXCMFuAAAJ</a></p>",
        "id": 521357457,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1748632636
    },
    {
        "content": "<p>Can someone send me how Harvard.dataverse has setup virtual storage \"pools\"? Maybe just the output of what the files JVM settings are? </p>\n<p>The output of this command:<br>\n<code>bin/asadmin list-jvm-options | grep files</code> </p>\n<p>I'm really having trouble trying to figure out which JVM lines to use for the storage alias. I tried just two, \"type\" and \"label\" and got things really messed up, then I added a third defining the bucket name (same as our S3), made our system happy again.... but getting errors about the storage and AWS, see error from log file at end:</p>\n<p>I added these 3 commands, seems that I am missing a few options, see error message:<br>\n<code>./asadmin create-jvm-options \"-Ddataverse.files.3d.type=s3\"</code></p>\n<p><code>./asadmin create-jvm-options \"-Ddataverse.files.3d.label=3D Cultural Heritage\"</code></p>\n<p><code>./asadmin create-jvm-options \"-Ddataverse.files.3d.bucket-name=dataverse-storage-production\"</code></p>\n<blockquote>\n<p>[2025-06-17T20:18:39.212+0000] [Payara 6.2025.2] [WARNING] [] [edu.harvard.iq.dataverse.ThumbnailServiceWrapper] [tid: _ThreadID=90 _ThreadName=http-thread-pool::jk-connector(4)] [timeMillis: 1750191519212] [levelValue: 900] [[<br>\n  getDatasetCardImageAsUrl(): Failed to initialize dataset StorageIO for 3d://10.80100/FK2/EUJETR (S3AccessIO: Failed to cache auxilary object : dataset_logo_original)]]</p>\n</blockquote>",
        "id": 524592583,
        "sender_full_name": "Sherry Lake",
        "timestamp": 1750192638
    },
    {
        "content": "<p>I'd ask Leonid but he's super busy right now. <span class=\"user-mention\" data-user-id=\"760572\">@Steven Winship</span> is there anything you could copy/paste from domain.xml? No passwords, etc. please!</p>",
        "id": 524593372,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1750193008
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"598112\">@Philip Durbin</span> <br>\nI just saw you were off on vacation.</p>\n<p>These are my last few days at UVA, retirement starts after Friday.</p>",
        "id": 524594118,
        "sender_full_name": "Sherry Lake",
        "timestamp": 1750193354
    },
    {
        "content": "<p>Right, right, I just warmed up <a class=\"stream-topic\" data-stream-id=\"375707\" href=\"/#narrow/channel/375707-community/topic/News.20from.20Sherry.20Lake.20.28UVA.29/with/509737115\">#community &gt; News from Sherry Lake (UVA)</a> <span aria-label=\"smile\" class=\"emoji emoji-1f604\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 524594465,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1750193523
    }
]