[
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"598112\">@Philip Durbin üêâ</span> ! I also have some errors running the docker version following the developer guide. Do you mind if I send the information here or would you rather I create a new topic?</p>",
        "id": 487322779,
        "sender_full_name": "nana",
        "timestamp": 1733857552
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"787413\">@nana</span> I moved us to a new topic. How can I help? <span aria-label=\"big smile\" class=\"emoji emoji-1f604\" role=\"img\" title=\"big smile\">:big_smile:</span></p>",
        "id": 487322955,
        "sender_full_name": "Philip Durbin üöÄ",
        "timestamp": 1733857602
    },
    {
        "content": "<p>Thank you! So I can create a local version of Dataverse, sign in and create a dataset. But once I attempt to access a file using the external tool (Data Explorer in our case) I get this error in the console:<br>\n<a href=\"/user_uploads/53090/N_3YrCe0NoLUHB_xz2ns-dRI/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/53090/N_3YrCe0NoLUHB_xz2ns-dRI/image.png\" title=\"image.png\"><img data-original-dimensions=\"2968x476\" src=\"/user_uploads/thumbnail/53090/N_3YrCe0NoLUHB_xz2ns-dRI/image.png/840x560.webp\"></a></div>",
        "id": 487323537,
        "sender_full_name": "nana",
        "timestamp": 1733857800
    },
    {
        "content": "<p>Another dev in our team is experiencing the same problem</p>",
        "id": 487323630,
        "sender_full_name": "nana",
        "timestamp": 1733857820
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>[#|2024-12-10T19:08:51.068+0000|SEVERE|Payara 6.2024.6|edu.harvard.iq.dataverse.api.errorhandlers.ThrowableHandler|_ThreadID=3121;_ThreadName=http-thread-pool::http-listener-1(8);_TimeMillis=1733857731068;_LevelValue=1000;|\ndev_dataverse&gt;   _status=&quot;ERROR&quot;;_code=500;_message=&quot;Internal server error. More details available at the server logs.&quot;;_incidentId=&quot;dfa7979b-6f18-4ab3-977f-086c9c7ee8dd&quot;;_interalError=&quot;NullPointerException&quot;;_requestUrl=&quot;http://localhost:8080/api/v1/files/5/metadata/2/toolparams/2?until=2024-12-10T19:13:50.861&amp;user=dataverseAdmin&amp;method=GET&amp;token=a4728da09c9e44f873bfd3df5ecf0aaf73b6f5b83edbb981bc8bcb5a193eb8bc99378b50514f03da0cd91b95b7986c39ede737683a27d7945864f5c059f1a357&quot;;_requestMethod=&quot;GET&quot;||#]\ndev_dataverse&gt;\ndev_dataverse&gt; [#|2024-12-10T19:08:51.069+0000|SEVERE|Payara 6.2024.6|edu.harvard.iq.dataverse.api.errorhandlers.ThrowableHandler|_ThreadID=3121;_ThreadName=http-thread-pool::http-listener-1(8);_TimeMillis=1733857731069;_LevelValue=1000;|\ndev_dataverse&gt;   java.lang.NullPointerException: Cannot invoke &quot;jakarta.json.JsonNumber.intValue()&quot; because the return value of &quot;org.eclipse.parsson.JsonObjectBuilderImpl$JsonObjectImpl.getJsonNumber(String)&quot; is null\n</code></pre></div>",
        "id": 487323692,
        "sender_full_name": "nana",
        "timestamp": 1733857842
    },
    {
        "content": "<p>Which line of the Dataverse code is throwing that error? We probably need to look more of the output.</p>",
        "id": 487323988,
        "sender_full_name": "Philip Durbin üöÄ",
        "timestamp": 1733857960
    },
    {
        "content": "<p>I think this is the full error:</p>\n<div class=\"codehilite\"><pre><span></span><code>[#|2024-12-10T19:08:51.068+0000|SEVERE|Payara 6.2024.6|edu.harvard.iq.dataverse.api.errorhandlers.ThrowableHandler|_ThreadID=3121;_ThreadName=http-thread-pool::http-listener-1(8);_TimeMillis=1733857731068;_LevelValue=1000;|\ndev_dataverse&gt;   _status=&quot;ERROR&quot;;_code=500;_message=&quot;Internal server error. More details available at the server logs.&quot;;_incidentId=&quot;dfa7979b-6f18-4ab3-977f-086c9c7ee8dd&quot;;_interalError=&quot;NullPointerException&quot;;_requestUrl=&quot;http://localhost:8080/api/v1/files/5/metadata/2/toolparams/2?until=2024-12-10T19:13:50.861&amp;user=dataverseAdmin&amp;method=GET&amp;token=a4728da09c9e44f873bfd3df5ecf0aaf73b6f5b83edbb981bc8bcb5a193eb8bc99378b50514f03da0cd91b95b7986c39ede737683a27d7945864f5c059f1a357&quot;;_requestMethod=&quot;GET&quot;||#]\ndev_dataverse&gt;\ndev_dataverse&gt; [#|2024-12-10T19:08:51.069+0000|SEVERE|Payara 6.2024.6|edu.harvard.iq.dataverse.api.errorhandlers.ThrowableHandler|_ThreadID=3121;_ThreadName=http-thread-pool::http-listener-1(8);_TimeMillis=1733857731069;_LevelValue=1000;|\ndev_dataverse&gt;   java.lang.NullPointerException: Cannot invoke &quot;jakarta.json.JsonNumber.intValue()&quot; because the return value of &quot;org.eclipse.parsson.JsonObjectBuilderImpl$JsonObjectImpl.getJsonNumber(String)&quot; is null\ndev_dataverse&gt;  at org.eclipse.parsson.JsonObjectBuilderImpl$JsonObjectImpl.getInt(JsonObjectBuilderImpl.java:264)\ndev_dataverse&gt;  at edu.harvard.iq.dataverse.util.URLTokenUtil.lambda$createPostBody$0(URLTokenUtil.java:220)\ndev_dataverse&gt;  at java.base/java.util.ArrayList.forEach(Unknown Source)\ndev_dataverse&gt;  at java.base/java.util.Collections$UnmodifiableCollection.forEach(Unknown Source)\ndev_dataverse&gt;  at edu.harvard.iq.dataverse.util.URLTokenUtil.createPostBody(URLTokenUtil.java:216)\ndev_dataverse&gt;  at edu.harvard.iq.dataverse.api.Files.getExternalToolFMParams(Files.java:845)\ndev_dataverse&gt;  at edu.harvard.iq.dataverse.api.Files$Proxy$_$$_WeldSubclass.getExternalToolFMParams(Unknown Source)\ndev_dataverse&gt;  at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\ndev_dataverse&gt;  at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\ndev_dataverse&gt;  at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\ndev_dataverse&gt;  at java.base/java.lang.reflect.Method.invoke(Unknown Source)\ndev_dataverse&gt;  at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52)\ndev_dataverse&gt;  at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:146)\ndev_dataverse&gt;  at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:189)\ndev_dataverse&gt;  at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$ResponseOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:176)\ndev_dataverse&gt;  at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:93)\ndev_dataverse&gt;  at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:478)\ndev_dataverse&gt;  at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:400)\ndev_dataverse&gt;  at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81)\ndev_dataverse&gt;  at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:261)\ndev_dataverse&gt;  at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248)\ndev_dataverse&gt;  at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244)\ndev_dataverse&gt;  at org.glassfish.jersey.internal.Errors.process(Errors.java:292)\ndev_dataverse&gt;  at org.glassfish.jersey.internal.Errors.process(Errors.java:274)\ndev_dataverse&gt;  at org.glassfish.jersey.internal.Errors.process(Errors.java:244)\ndev_dataverse&gt;  at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265)\ndev_dataverse&gt;  at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:240)\ndev_dataverse&gt;  at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:697)\ndev_dataverse&gt;  at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394)\ndev_dataverse&gt;  at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346)\ndev_dataverse&gt;  at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:357)\ndev_dataverse&gt;  at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:311)\ndev_dataverse&gt;  at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205)\ndev_dataverse&gt;  at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1554)\ndev_dataverse&gt;  at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:331)\ndev_dataverse&gt;  at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:211)\ndev_dataverse&gt;  at org.glassfish.tyrus.servlet.TyrusServletFilter.doFilter(TyrusServletFilter.java:83)\ndev_dataverse&gt;  at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:253)\ndev_dataverse&gt;  at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:211)\ndev_dataverse&gt;  at org.ocpsoft.rewrite.servlet.RewriteFilter.doFilter(RewriteFilter.java:226)\ndev_dataverse&gt;  at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:253)\ndev_dataverse&gt;  at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:211)\ndev_dataverse&gt;  at edu.harvard.iq.dataverse.api.ApiBlockingFilter.doFilter(ApiBlockingFilter.java:170)\ndev_dataverse&gt;  at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:253)\ndev_dataverse&gt;  at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:211)\ndev_dataverse&gt;  at edu.harvard.iq.dataverse.api.ApiRouter.doFilter(ApiRouter.java:31)\ndev_dataverse&gt;  at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:253)\ndev_dataverse&gt;  at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:211)\ndev_dataverse&gt;  at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:257)\ndev_dataverse&gt;  at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:166)\ndev_dataverse&gt;  at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:757)\ndev_dataverse&gt;  at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:577)\ndev_dataverse&gt;  at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:99)\ndev_dataverse&gt;  at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:158)\ndev_dataverse&gt;  at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:372)\ndev_dataverse&gt;  at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:239)\ndev_dataverse&gt;  at com.sun.enterprise.v3.services.impl.ContainerMapper$HttpHandlerCallable.call(ContainerMapper.java:520)\ndev_dataverse&gt;  at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:217)\ndev_dataverse&gt;  at org.glassfish.grizzly.http.server.HttpHandler.runService(HttpHandler.java:174)\ndev_dataverse&gt;  at org.glassfish.grizzly.http.server.HttpHandler.doHandle(HttpHandler.java:153)\ndev_dataverse&gt;  at org.glassfish.grizzly.http.server.HttpServerFilter.handleRead(HttpServerFilter.java:196)\ndev_dataverse&gt;  at org.glassfish.grizzly.filterchain.ExecutorResolver$9.execute(ExecutorResolver.java:88)\ndev_dataverse&gt;  at org.glassfish.grizzly.filterchain.DefaultFilterChain.executeFilter(DefaultFilterChain.java:246)\ndev_dataverse&gt;  at org.glassfish.grizzly.filterchain.DefaultFilterChain.executeChainPart(DefaultFilterChain.java:178)\ndev_dataverse&gt;  at org.glassfish.grizzly.filterchain.DefaultFilterChain.execute(DefaultFilterChain.java:118)\ndev_dataverse&gt;  at org.glassfish.grizzly.filterchain.DefaultFilterChain.process(DefaultFilterChain.java:96)\ndev_dataverse&gt;  at org.glassfish.grizzly.ProcessorExecutor.execute(ProcessorExecutor.java:51)\ndev_dataverse&gt;  at org.glassfish.grizzly.nio.transport.TCPNIOTransport.fireIOEvent(TCPNIOTransport.java:510)\ndev_dataverse&gt;  at org.glassfish.grizzly.strategies.AbstractIOStrategy.fireIOEvent(AbstractIOStrategy.java:82)\ndev_dataverse&gt;  at org.glassfish.grizzly.strategies.WorkerThreadIOStrategy.run0(WorkerThreadIOStrategy.java:83)\ndev_dataverse&gt;  at org.glassfish.grizzly.strategies.WorkerThreadIOStrategy$WorkerThreadRunnable.run(WorkerThreadIOStrategy.java:101)\ndev_dataverse&gt;  at org.glassfish.grizzly.threadpool.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:535)\ndev_dataverse&gt;  at org.glassfish.grizzly.threadpool.AbstractThreadPool$Worker.run(AbstractThreadPool.java:515)\ndev_dataverse&gt;  at java.base/java.lang.Thread.run(Unknown Source)\n</code></pre></div>",
        "id": 487324313,
        "sender_full_name": "nana",
        "timestamp": 1733858089
    },
    {
        "content": "<p>Does that help at all?</p>",
        "id": 487324385,
        "sender_full_name": "nana",
        "timestamp": 1733858111
    },
    {
        "content": "<p>definitely</p>",
        "id": 487324482,
        "sender_full_name": "Philip Durbin üöÄ",
        "timestamp": 1733858152
    },
    {
        "content": "<p><code>edu.harvard.iq.dataverse.util.URLTokenUtil.createPostBody(URLTokenUtil.java:216)</code></p>",
        "id": 487324491,
        "sender_full_name": "Philip Durbin üöÄ",
        "timestamp": 1733858156
    },
    {
        "content": "<p>which commit are you on?</p>",
        "id": 487324535,
        "sender_full_name": "Philip Durbin üöÄ",
        "timestamp": 1733858164
    },
    {
        "content": "<p>The latest</p>",
        "id": 487324574,
        "sender_full_name": "nana",
        "timestamp": 1733858177
    },
    {
        "content": "<p>Well actually one second</p>",
        "id": 487324594,
        "sender_full_name": "nana",
        "timestamp": 1733858186
    },
    {
        "content": "<p>Let me double check that haha</p>",
        "id": 487324612,
        "sender_full_name": "nana",
        "timestamp": 1733858192
    },
    {
        "content": "<p>I'm on this commit: <a href=\"https://github.com/IQSS/dataverse/commit/82dad99d4eefbb194519fdadcfc630ff05b6e1b9\">https://github.com/IQSS/dataverse/commit/82dad99d4eefbb194519fdadcfc630ff05b6e1b9</a></p>",
        "id": 487325002,
        "sender_full_name": "nana",
        "timestamp": 1733858371
    },
    {
        "content": "<p>Ok, so the error is being thrown here: <a href=\"https://github.com/IQSS/dataverse/blob/82dad99d4eefbb194519fdadcfc630ff05b6e1b9/src/main/java/edu/harvard/iq/dataverse/util/URLTokenUtil.java#L216\">https://github.com/IQSS/dataverse/blob/82dad99d4eefbb194519fdadcfc630ff05b6e1b9/src/main/java/edu/harvard/iq/dataverse/util/URLTokenUtil.java#L216</a></p>",
        "id": 487325148,
        "sender_full_name": "Philip Durbin üöÄ",
        "timestamp": 1733858428
    },
    {
        "content": "<p>I see... This is the manifest I use to register the app, is there anything I should change?<br>\nconfigure:</p>\n<div class=\"codehilite\"><pre><span></span><code>{\n  &quot;displayName&quot;: &quot;Data Explorer&quot;,\n  &quot;description&quot;: &quot;Odesi Data Explorer for viewing, configuring and editing variables&quot;,\n  &quot;scope&quot;: &quot;file&quot;,\n  &quot;type&quot;: &quot;configure&quot;,\n  &quot;contentType&quot;: &quot;text/tab-separated-values&quot;,\n  &quot;toolUrl&quot;: &quot;http://localhost:4200/&quot;,\n  &quot;toolParameters&quot;: {\n    &quot;queryParameters&quot;: [\n      {\n        &quot;fileId&quot;: &quot;{fileId}&quot;\n      },\n      {\n        &quot;fileMetadataId&quot;: &quot;{fileMetadataId}&quot;\n      },\n      {\n        &quot;datasetPid&quot;: &quot;{datasetPid}&quot;\n      },\n      {\n        &quot;dvLocale&quot;: &quot;{localeCode}&quot;\n      }\n    ]\n  },\n  &quot;allowedApiCalls&quot;: [\n    {\n      &quot;name&quot;: &quot;retrieveDataFileDDI&quot;,\n      &quot;httpMethod&quot;: &quot;GET&quot;,\n      &quot;urlTemplate&quot;: &quot;/api/v1/access/datafile/{fileId}/metadata/ddi&quot;,\n      &quot;timeOut&quot;: 270\n    },\n    {\n      &quot;name&quot;: &quot;retrieveDataFile&quot;,\n      &quot;httpMethod&quot;: &quot;GET&quot;,\n      &quot;urlTemplate&quot;: &quot;/api/v1/access/datafile/{fileId}&quot;\n    },\n    {\n      &quot;name&quot;: &quot;uploadDataFile&quot;,\n      &quot;httpMethod&quot;: &quot;PUT&quot;,\n      &quot;urlTemplate&quot;: &quot;/api/v1/edit/{fileId}&quot;\n    }\n  ]\n}\n</code></pre></div>\n<p>explore:</p>\n<div class=\"codehilite\"><pre><span></span><code>{\n  &quot;displayName&quot;: &quot;Data Explorer&quot;,\n  &quot;description&quot;: &quot;Odesi Data Explorer for viewing, and configuring variables&quot;,\n  &quot;scope&quot;: &quot;file&quot;,\n  &quot;type&quot;: &quot;explore&quot;,\n  &quot;contentType&quot;: &quot;text/tab-separated-values&quot;,\n  &quot;toolUrl&quot;: &quot;http://localhost:4200&quot;,\n  &quot;toolParameters&quot;: {\n    &quot;queryParameters&quot;: [\n      {\n        &quot;fileId&quot;: &quot;{fileId}&quot;\n      },\n      {\n        &quot;fileMetadataId&quot;: &quot;{fileMetadataId}&quot;\n      },\n      {\n        &quot;datasetPid&quot;: &quot;{datasetPid}&quot;\n      },\n      {\n        &quot;dvLocale&quot;: &quot;{localeCode}&quot;\n      }\n    ]\n  },\n  &quot;allowedApiCalls&quot;: [\n    {\n      &quot;name&quot;: &quot;retrieveDataFile&quot;,\n      &quot;httpMethod&quot;: &quot;GET&quot;,\n      &quot;urlTemplate&quot;: &quot;/api/v1/access/datafile/{fileId}&quot;\n    },\n    {\n      &quot;name&quot;: &quot;retrieveDataFileDDI&quot;,\n      &quot;httpMethod&quot;: &quot;GET&quot;,\n      &quot;urlTemplate&quot;: &quot;/api/v1/access/datafile/{fileId}/metadata/ddi&quot;,\n      &quot;timeOut&quot;: 270\n    }\n  ]\n}\n</code></pre></div>",
        "id": 487325462,
        "sender_full_name": "nana",
        "timestamp": 1733858571
    },
    {
        "content": "<p>Some of your <code>allowedApiCalls</code> don't have a <code>timeOut</code>.</p>\n<p>Could that be the problem?</p>\n<p>I suspect this might be the line that's giving you trouble:</p>\n<p><code>int timeout = apiObj.getInt(TIMEOUT);</code></p>",
        "id": 487325695,
        "sender_full_name": "Philip Durbin üöÄ",
        "timestamp": 1733858666
    },
    {
        "content": "<p>I can try changing that, can i set it to -1 for unlimited time or should all urls have a limit?</p>",
        "id": 487325851,
        "sender_full_name": "nana",
        "timestamp": 1733858737
    },
    {
        "content": "<p>buh, I'm not sure</p>",
        "id": 487325982,
        "sender_full_name": "Philip Durbin üöÄ",
        "timestamp": 1733858780
    },
    {
        "content": "<p>\"For non-public datasets and datafiles, how many minutes the signed URLs given to the tool should be valid for. Must be an integer.\" <a href=\"https://guides.dataverse.org/en/6.4/api/external-tools.html\">https://guides.dataverse.org/en/6.4/api/external-tools.html</a></p>",
        "id": 487326064,
        "sender_full_name": "Philip Durbin üöÄ",
        "timestamp": 1733858820
    },
    {
        "content": "<p>Please feel free to open an issue to clarify the docs.</p>",
        "id": 487326116,
        "sender_full_name": "Philip Durbin üöÄ",
        "timestamp": 1733858842
    },
    {
        "content": "<p>Judging from the code, <code>-1</code> is not supported. I guess you could open a separate issue for that, if you want it.</p>",
        "id": 487326504,
        "sender_full_name": "Philip Durbin üöÄ",
        "timestamp": 1733858985
    },
    {
        "content": "<p>Okay I will. Thanks, Philip!</p>",
        "id": 487333250,
        "sender_full_name": "nana",
        "timestamp": 1733861590
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"787413\">nana</span> has marked this topic as resolved.</p>",
        "id": 528686587,
        "sender_full_name": "Notification Bot",
        "timestamp": 1752506602
    }
]