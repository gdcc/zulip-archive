[
    {
        "content": "<p>Hello, </p>\n<p>(dataverse 6.6)</p>\n<p>We just uploaded/ingested some material into a new collection. When we published it, we are seeing a License/Data Use Agreement  (DUA) popup in the previewer section of  a files page - even when it's a CC0 file.   We did put some material in the \"Restricted Files + Terms of Access\" section - putting the word \"Public\" in \"Terms of Access for Restricted File\". </p>\n<p>Does putting anything in this field made the \"Request Access\" active?</p>\n<p>I'm sure we've made some metadata error along the way -- just not sure what it was and how to fix it. </p>\n<p>Here's a record:  <a href=\"https://dataverse.yale.edu/dataset.xhtml?persistentId=doi:10.60600/YU/TY05NA&amp;version=1.0\">https://dataverse.yale.edu/dataset.xhtml?persistentId=doi:10.60600/YU/TY05NA&amp;version=1.0</a></p>\n<p>Here's the terms of use config page: </p>\n<p><a href=\"/user_uploads/53090/yWZGWpTSapI5D47XtxyI_u6M/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/53090/yWZGWpTSapI5D47XtxyI_u6M/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1279x846\" src=\"/user_uploads/thumbnail/53090/yWZGWpTSapI5D47XtxyI_u6M/image.png/840x560.webp\"></a></div><p>Ideally we would not get a pop up for a DUA at all for anything in this collection (even the non CC0 records).  </p>\n<p>Thoughts?  <br>\nThanks in advance!</p>",
        "id": 566832260,
        "sender_full_name": "Bethany Seeger",
        "timestamp": 1767823779
    },
    {
        "content": "<p>noting I saw this email thread:  <a href=\"https://groups.google.com/g/dataverse-community/c/vXxyexUASoI/m/oqIHv1xpBAAJ\">https://groups.google.com/g/dataverse-community/c/vXxyexUASoI/m/oqIHv1xpBAAJ</a></p>\n<p>Not sure if it is still applicable or not.</p>",
        "id": 566833076,
        "sender_full_name": "Bethany Seeger",
        "timestamp": 1767824205
    },
    {
        "content": "<p>Yes, the popup is normal in this case. There are terms that must be agreed to before the file can be previewed.</p>\n<p>\"If a preview tool for a specific file type is available, the preview will be created and will display automatically, after terms have been agreed to or a guestbook entry has been made, if necessary.\" -- <a href=\"https://guides.dataverse.org/en/6.9/user/dataset-management.html#file-previews\">https://guides.dataverse.org/en/6.9/user/dataset-management.html#file-previews</a></p>",
        "id": 566960374,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1767883753
    },
    {
        "content": "<p>Thanks, Phil.  So technically speaking, anytime you put anything in the \"Terms of Access for Restricted Files\", you'll get the popup?   (regardless of actual license type)</p>\n<p>The UI won't let me take out the popup via the edit terms page (it's grayed out).   How can I clear that \"Terms of Access for Restricted Files\" field?</p>",
        "id": 566962214,
        "sender_full_name": "Bethany Seeger",
        "timestamp": 1767884188
    },
    {
        "content": "<p>Right, same for downloads, not just previews. The popup will be shown.</p>",
        "id": 566962667,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1767884290
    },
    {
        "content": "<p>Hmm, I see what you mean, how it's grayed out:</p>\n<p><a href=\"/user_uploads/53090/RuWWSmodFDdJIyzNvY5mozEx/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/53090/RuWWSmodFDdJIyzNvY5mozEx/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1279x846\" src=\"/user_uploads/thumbnail/53090/RuWWSmodFDdJIyzNvY5mozEx/image.png/840x560.webp\"></a></div>",
        "id": 566962973,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1767884363
    },
    {
        "content": "<p>Seems like a bug. Can you reproduce it on <a href=\"https://demo.dataverse.org\">https://demo.dataverse.org</a> ?</p>",
        "id": 566964823,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1767884755
    },
    {
        "content": "<p>I just tried this out there and not sure if it worked or not.  I did this manually -- created the dataset and choose CC0, then added a few files.   The txt file preview is failing, so I can't tell if it would have shown a popup:  </p>\n<p><a href=\"https://demo.dataverse.org/dataset.xhtml?persistentId=doi:10.70122/FK2/0BEISU\">https://demo.dataverse.org/dataset.xhtml?persistentId=doi:10.70122/FK2/0BEISU</a></p>\n<p>When I look at the terms of the dataset, I do see the same boxes grayed out -- and I didn't change anything there.  Maybe this is normal?   Maybe I'm just missing something...</p>",
        "id": 566968620,
        "sender_full_name": "Bethany Seeger",
        "timestamp": 1767885687
    },
    {
        "content": "<p>Not sure. I asked in Slack and Jim had this suggestion:</p>\n<p>\"One possibility: Those a greyed when there are no restricted files. Perhaps a bug to not let you clear it, but the work-around would be to mark a file restricted, make the change, and then unrestrict it.\"</p>",
        "id": 566969142,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1767885804
    },
    {
        "content": "<p>Ok - that makes sense -- just tried it out on our staging server and it worked. </p>\n<p>So the system thinks the files are unrestricted, but because we put a string in that terms field, the system also thinks we need the popup. </p>\n<p>Because they are not restricted, those fields are grayed out and we can't edit them.</p>",
        "id": 566970796,
        "sender_full_name": "Bethany Seeger",
        "timestamp": 1767886205
    },
    {
        "content": "<p>Sounds like a bug, right? Do you mind opening an issue?</p>",
        "id": 566970995,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1767886257
    },
    {
        "content": "<p>Was just typing about that -- yeah it does sound like a bug - a minor one.  I'll open an issue.  Thanks so much for your help.</p>",
        "id": 566971161,
        "sender_full_name": "Bethany Seeger",
        "timestamp": 1767886297
    },
    {
        "content": "<p>No problem! Thanks to Jim for the workaround!</p>",
        "id": 566971277,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1767886324
    },
    {
        "content": "<p>Thanks for creating <a href=\"https://github.com/IQSS/dataverse/issues/12080\">https://github.com/IQSS/dataverse/issues/12080</a> !</p>",
        "id": 567180134,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1767975748
    },
    {
        "content": "<p>Thanks for noting it here -- I meant to come back and do that, and then forgot because I did it at the end of the day.</p>",
        "id": 567180411,
        "sender_full_name": "Bethany Seeger",
        "timestamp": 1767975807
    },
    {
        "content": "<p>That's what unread messages are for. <span aria-label=\"smile\" class=\"emoji emoji-1f604\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 567181001,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1767975936
    },
    {
        "content": "<p>Hey all. </p>\n<p>Would it also be possible to adjust the Native API endpoint that Bethany used to remove or reduce the chance that datasets can get in this state, where there's something in the \"Terms of Access for Restricted File\" field but there's no restricted files? Maybe if the dataset doesn't have restricted files, but there's anything in the \"Terms of Access for Restricted File\" field, the API endpoint returns an error that the dataset has no restricted files, so the \"Terms of Access for Restricted File\" field must be blank?</p>\n<p><span class=\"user-mention\" data-user-id=\"737390\">@Bethany Seeger</span>, you wrote that ideally people wouldn't see a pop up for a DUA at all for anything in this collection (even the non CC0 records). Could you write more about why you'd prefer that people didn't see a popup when they try to preview a file in a dataset in this collection?</p>",
        "id": 567539396,
        "sender_full_name": "Julian Gautier",
        "timestamp": 1768226040
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"621770\">@Julian Gautier</span> yes, good idea</p>",
        "id": 567540329,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1768226238
    },
    {
        "content": "<p>Hi Julian - I think tweaking that API call is a good idea, to prevent this scenario. </p>\n<p>I'd like to talk with the stakeholder more about the popup and then will get back to you.  I want to make sure I underestand what she expected before representing it here.  Thanks!</p>",
        "id": 567995444,
        "sender_full_name": "Bethany Seeger",
        "timestamp": 1768399900
    }
]