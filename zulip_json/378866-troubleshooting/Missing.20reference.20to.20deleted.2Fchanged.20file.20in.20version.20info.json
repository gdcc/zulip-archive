[
    {
        "content": "<p>Hi there .. we have a dataset where the user uploaded a file in v1, then posted several new revisions, then needed to change that original uploaded file. This person uploaded a new file with the changes, but then realized the old file could just be replaced, so we deleted the new file, made changes to the original file, and replaced it. However, none of these changes appear in the version history for the file or for the dataset. Usually these type of changes do appear in the history. Any ideas? <br>\n<a href=\"/user_uploads/53090/q_bxhwzWL9qXcFK1iNoBPo_m/df-file-changes.jpg\">df-file-changes.jpg</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/53090/q_bxhwzWL9qXcFK1iNoBPo_m/df-file-changes.jpg\" title=\"df-file-changes.jpg\"><img data-original-content-type=\"image/jpeg\" data-original-dimensions=\"1154x268\" src=\"/user_uploads/thumbnail/53090/q_bxhwzWL9qXcFK1iNoBPo_m/df-file-changes.jpg/840x560.webp\"></a></div>",
        "id": 572906261,
        "sender_full_name": "Deirdre Kirmis",
        "timestamp": 1770678854
    },
    {
        "content": "<p>Hmm, want to try replicating this on <a href=\"https://demo.dataverse.org\">https://demo.dataverse.org</a> ?</p>",
        "id": 573062419,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1770734814
    },
    {
        "content": "<p>okay I did test on the demo DV .. I uploaded a file &gt; published &gt; uploaded second copy of file &gt; published &gt; deleted second copy &gt; published &gt; made a change to original file and replaced &gt; published .. all of those changes showed in the version history except for the file replacement .. so likely a publish was not done after each step on our side .. makes sense that if not, the version info wouldn't show as the diff is just between published versions .. </p>\n<p>.. but there was definitely a publish after the final replacement of the original file .. would that not show a change in version history? (ie: do file changes done via \"Replace\" show in the version history?)<br>\n<a href=\"/user_uploads/53090/1WgBPSTEIDSD3_ZAqPSH8gYQ/test-2.jpg\">test 2.jpg</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/53090/1WgBPSTEIDSD3_ZAqPSH8gYQ/test-2.jpg\" title=\"test 2.jpg\"><img data-original-content-type=\"image/jpeg\" data-original-dimensions=\"454x141\" src=\"/user_uploads/thumbnail/53090/1WgBPSTEIDSD3_ZAqPSH8gYQ/test-2.jpg/840x560.webp\"></a></div>",
        "id": 573083174,
        "sender_full_name": "Deirdre Kirmis",
        "timestamp": 1770739476
    },
    {
        "content": "<p>I'm confused. Are you saying you replaced a file between these two versions?</p>\n<ul>\n<li><a href=\"https://demo.dataverse.org/dataset.xhtml?persistentId=doi:10.70122/FK2/4JSMVV&amp;version=5.0\">https://demo.dataverse.org/dataset.xhtml?persistentId=doi:10.70122/FK2/4JSMVV&amp;version=5.0</a></li>\n<li><a href=\"https://demo.dataverse.org/dataset.xhtml?persistentId=doi:10.70122/FK2/4JSMVV&amp;version=5.1\">https://demo.dataverse.org/dataset.xhtml?persistentId=doi:10.70122/FK2/4JSMVV&amp;version=5.1</a></li>\n</ul>\n<p>I'm asking because I see the same file with the same md5.</p>",
        "id": 573090289,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1770741175
    },
    {
        "content": "<p>Yea the plot is thickening on this .. <span class=\"user-mention\" data-user-id=\"744896\">@Rachel Fernandez</span> did some detective work here on our repo and noticed that any file that is uploaded via \"Replace\" is not actually registering the uploaded file. The same thing has happened here, which is why those 2 files are the same. I did a \"replace\" and publish but the second publish did not capture the changed file. Both files exist on S3 though, so I know it is making it that far. The step to register the changed file to dataverse just does not seem to be happening.</p>",
        "id": 573154564,
        "sender_full_name": "Deirdre Kirmis",
        "timestamp": 1770759353
    },
    {
        "content": "<p>We didn't  notice originally that the changed file was not showing the changes in the dataset itself.</p>",
        "id": 573154652,
        "sender_full_name": "Deirdre Kirmis",
        "timestamp": 1770759389
    },
    {
        "content": "<p>smells like a bug <span aria-label=\"lady beetle\" class=\"emoji emoji-1f41e\" role=\"img\" title=\"lady beetle\">:lady_beetle:</span></p>",
        "id": 573155870,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1770759883
    },
    {
        "content": "<p>i will submit a ticket .. i think this could be related to <a href=\"https://github.com/IQSS/dataverse/issues/11976\">https://github.com/IQSS/dataverse/issues/11976</a> as we are having that issue as well</p>",
        "id": 573158532,
        "sender_full_name": "Deirdre Kirmis",
        "timestamp": 1770760937
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"598843\">@Deirdre Kirmis</span> thanks for opening this issue!</p>\n<p>Replace feature does not replace the fileÂ <a href=\"https://github.com/IQSS/dataverse/issues/12157\">#12157</a></p>",
        "id": 573565968,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1770913251
    },
    {
        "content": "<p>I hope you don't mind but I edited the issue to link to this topic on Zulip.</p>",
        "id": 573567126,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1770913542
    },
    {
        "content": "<p>oh sure, no problem .. thanks for doing that <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span></p>",
        "id": 573571808,
        "sender_full_name": "Deirdre Kirmis",
        "timestamp": 1770914758
    },
    {
        "content": "<p>Sure. Can you also mention in the issue that you were able to reproduce it on demo?</p>",
        "id": 573572103,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1770914848
    },
    {
        "content": "<p>Also, I'm wondering if you happen to know if replacing file via API is a good workaround.</p>",
        "id": 573572209,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1770914877
    },
    {
        "content": "<p>yes will do .. good point on the API .. I tried it and it does seem that the API replaced the file with the changed one correctly (it created a new draft, and the draft file is the new one, and then the published dataset has the correct file</p>",
        "id": 573602893,
        "sender_full_name": "Deirdre Kirmis",
        "timestamp": 1770924478
    },
    {
        "content": "<p>phew!</p>",
        "id": 573607095,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1770925958
    }
]