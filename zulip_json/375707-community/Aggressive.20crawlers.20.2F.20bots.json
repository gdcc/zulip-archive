[
    {
        "content": "<p>I'd like to learn from other installations, on how they manage the aggressive bots that ignore robot.txt and crawl-delay. The IP blocking is not working as the AI bots are using legits IP as proxy. <br>\nWe are currently exploring captcha or silent challenge on WAF.</p>\n<p>related news, posts, etc:<br>\n<a href=\"https://arstechnica.com/ai/2025/03/devs-say-ai-crawlers-dominate-traffic-forcing-blocks-on-entire-countries/\">https://arstechnica.com/ai/2025/03/devs-say-ai-crawlers-dominate-traffic-forcing-blocks-on-entire-countries/</a><br>\n<a href=\"https://www.linkedin.com/pulse/bots-coming-our-metadata-rosalyn-metz-0kyve/\">https://www.linkedin.com/pulse/bots-coming-our-metadata-rosalyn-metz-0kyve/</a></p>",
        "id": 515186761,
        "sender_full_name": "Yuyun Wirawati",
        "timestamp": 1745977014
    },
    {
        "content": "<p>Thanks for also starting the <a href=\"https://groups.google.com/g/dataverse-community/c/_sefDLswDbQ/m/4hUwvAS2CAAJ\">thread</a> on the mailing list about these bots.</p>",
        "id": 515271390,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1746010834
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"598183\">@Oliver Bertuch</span> I am very interested to hear what you're doing to combat botnets. I've found at least four startup companies selling bot-detection-evasion-as-a-service =(</p>",
        "id": 515308253,
        "sender_full_name": "Don Sizemore",
        "timestamp": 1746020448
    },
    {
        "content": "<p>Try <a href=\"https://anubis.techaro.lol\">https://anubis.techaro.lol</a> or <a href=\"https://git.gammaspectra.live/git/go-away\">https://git.gammaspectra.live/git/go-away</a> <span aria-label=\"smiley\" class=\"emoji emoji-1f603\" role=\"img\" title=\"smiley\">:smiley:</span></p>",
        "id": 515309920,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1746020876
    },
    {
        "content": "<p>See Anubis in action at <a href=\"https://data.fz-juelich.de\">https://data.fz-juelich.de</a></p>",
        "id": 515310058,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1746020905
    },
    {
        "content": "<p><a href=\"/user_uploads/53090/pSVZwyjRIJF2_WPuOyGkv62S/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/53090/pSVZwyjRIJF2_WPuOyGkv62S/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"594x258\" src=\"/user_uploads/thumbnail/53090/pSVZwyjRIJF2_WPuOyGkv62S/image.png/840x560.webp\"></a></div><p>And that's just from the last ~6 hours</p>",
        "id": 515310466,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1746021016
    },
    {
        "content": "<p>yikes</p>",
        "id": 515310561,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1746021041
    },
    {
        "content": "<p>These people are crazy. I'm thinking about using go-away's proxy mode to lure the failing clients into a Nephentes tar pit. So let them burn CPU on nonsense and poison their training materials</p>",
        "id": 515310767,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1746021096
    },
    {
        "content": "<p>I had to turn off the Opengraph Preview Passthrough in Anubis though. They just kept on hammering on the root collection. <span aria-label=\"shrug\" class=\"emoji emoji-1f937\" role=\"img\" title=\"shrug\">:shrug:</span></p>",
        "id": 515311178,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1746021192
    },
    {
        "content": "<p>Meanwhile, I'm playing with a top secret AI tool from <span class=\"user-mention\" data-user-id=\"598432\">@Slava Tykhonov</span> and contributing to the problem. <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 515311188,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1746021197
    },
    {
        "content": "<p>I might let those AI bots with proper user agents back in. They seem to behave. Will need to verify their origin IPs though.</p>",
        "id": 515311553,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1746021301
    },
    {
        "content": "<p>In addition, thinking about adding a cache layer to my NGINX Ingress so I can re-enable OpenGraph previews.</p>",
        "id": 515311915,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1746021387
    },
    {
        "content": "<p>When you say hammering the root collection do you mean the homepage?</p>",
        "id": 515312176,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1746021454
    },
    {
        "content": "<p>We don't have a static home page, we just present the root collection. So any visitor triggers a Solr search.</p>",
        "id": 515312332,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1746021488
    },
    {
        "content": "<p>Solr seemed to be fine with that, but the performance of Dataverse loading the required stuff from the result just wasn't there. It couldn't keep up.</p>",
        "id": 515312466,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1746021525
    },
    {
        "content": "<p>Gotcha. Hitting the homepage does call into the database as well.</p>",
        "id": 515313658,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1746021797
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"598183\">@Oliver Bertuch</span> Anubis doesn't cause any problems with callbacks?</p>",
        "id": 515316181,
        "sender_full_name": "Don Sizemore",
        "timestamp": 1746022418
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"626369\">Don Sizemore</span> <a href=\"#narrow/stream/375707-community/topic/Aggressive.20crawlers.20.2F.20bots/near/515316181\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"598183\">Oliver Bertuch</span> Anubis doesn't cause any problems with callbacks?</p>\n</blockquote>\n<p>I have no idea! Didn't test that yet. How would you suggest testing it?</p>",
        "id": 515327188,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1746025018
    },
    {
        "content": "<p>OAuth2 / DataCite publishing, anything that would call back.<br>\nAlso, you're using Nginx and not Apache, correct?</p>",
        "id": 515335617,
        "sender_full_name": "Don Sizemore",
        "timestamp": 1746027049
    },
    {
        "content": "<p>Yes, I'm using NGINX (Ingress Controller). But  Anubis and Go-Away are usable with anything, as they just are reverse proxies.</p>",
        "id": 515336518,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1746027250
    },
    {
        "content": "<p>OAuth2 happens in the browser. As you solve the challenge once and then have a JWT in a cookie, that's no problemo</p>",
        "id": 515336718,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1746027300
    },
    {
        "content": "<p>What kind of DataCite callbacks are you referring to? Registering a new DOI etc is just outgoing traffic, aye?</p>",
        "id": 515336812,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1746027323
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"598183\">@Oliver Bertuch</span> I'm glad to hear it's all working for you! My remaining question concerns our use of Shibboleth, and subsequent use of the AJP protocol through the Apache proxy. I'll look into this.</p>",
        "id": 515357966,
        "sender_full_name": "Don Sizemore",
        "timestamp": 1746033027
    },
    {
        "content": "<p>I'm using it like this: NGINX Ingress -&gt; Anubis -&gt; NGINX Router -&gt; Dataverse Backend/Static Files/...</p>",
        "id": 515358728,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1746033247
    },
    {
        "content": "<p>So you could just front your Apache with Anubis.</p>",
        "id": 515358783,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1746033267
    },
    {
        "content": "<p>That obviously leaves the question of SSL termination</p>",
        "id": 515358847,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1746033296
    },
    {
        "content": "<p>If you do that in Apache right now, you might need to split the setup a little</p>",
        "id": 515358933,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1746033322
    },
    {
        "content": "<p>Or take a look at go-away, they have SSL stuff builtin including TLS fingerprinting</p>",
        "id": 515359131,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1746033387
    },
    {
        "content": "<p>We don't have Shibboleth in the mix pending InCommon Federation publication, but Anubis seems to work well with Apache and Dataverse. Instead of specifying a DocumentRoot in the last listener, we gave it the standard ProxyPass:</p>\n<div class=\"codehilite\"><pre><span></span><code>&lt;VirtualHost *:3000&gt;\n  ServerAdmin &lt;e-mail&gt;\n  ServerName &lt;fqdn&gt;\n  ErrorLog /var/log/httpd/anubis_dataverse6_error.log\n  CustomLog /var/log/httpd/anubis_dataverse6_access.log combined\n\n  ProxyPass / ajp://localhost:8009/\n  ProxyPassReverse / ajp://localhost:8009/\n&lt;/VirtualHost&gt;\n</code></pre></div>",
        "id": 516909158,
        "sender_full_name": "Don Sizemore",
        "timestamp": 1746714300
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"598183\">@Oliver Bertuch</span> William got Anubis working with Shibboleth! Our current ssl.conf includes:</p>\n<div class=\"codehilite\"><pre><span></span><code>  # these headers are required for Anubis\n  RequestHeader set &quot;X-Real-Ip&quot; expr=%{REMOTE_ADDR}\n  RequestHeader set X-Forwarded-Proto &quot;https&quot;\n  ProxyPreserveHost On\n  ProxyRequests Off\n  ProxyVia Off\n\n  &lt;Location /shib.xhtml&gt;\n    AuthType shibboleth\n    ShibRequestSetting requireSession 1\n    require valid-user\n\n    ProxyPass ajp://localhost:8009/shib.xhtml\n    ProxyPassReverse ajp://localhost:8009/shib.xhtml\n  &lt;/Location&gt;\n\n  # port Anubis listens on\n  ProxyPass / http://localhost:8923/\n  ProxyPassReverse / http://localhost:8923/\n&lt;/VirtualHost&gt;\n\n# actual website config\n&lt;VirtualHost *:3000&gt;\n  ServerAdmin &lt;e-mail&gt;\n  ServerName &lt;fqdn&gt;\n  ErrorLog /var/log/httpd/anubis_dataverse6_error.log\n  CustomLog /var/log/httpd/anubis_dataverse6_access.log combined\n\n  ProxyPass / ajp://localhost:8009/\n  ProxyPassReverse / ajp://localhost:8009/\n&lt;/VirtualHost&gt;\n</code></pre></div>",
        "id": 517864827,
        "sender_full_name": "Don Sizemore",
        "timestamp": 1747150949
    },
    {
        "content": "<p>Looks great! Congrats! May their connections be weighed</p>",
        "id": 517870663,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1747152445
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"598183\">@Oliver Bertuch</span> we're having trouble with Anubis' ALLOWs in bot_policies.json - are you willing to share yours?</p>",
        "id": 518809327,
        "sender_full_name": "Don Sizemore",
        "timestamp": 1747480506
    },
    {
        "content": "<p>Orly? What kind of problems? I'm using the standard config, but can also share it.</p>",
        "id": 518809444,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1747480612
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"YAML\"><pre><span></span><code><span class=\"c1\">## Anubis has the ability to let you import snippets of configuration into the main</span>\n<span class=\"c1\">## configuration file. This allows you to break up your config into smaller parts</span>\n<span class=\"c1\">## that get logically assembled into one big file.</span>\n<span class=\"c1\">##</span>\n<span class=\"c1\">## Of note, a bot rule can either have inline bot configuration or import a</span>\n<span class=\"c1\">## bot config snippet. You cannot do both in a single bot rule.</span>\n<span class=\"c1\">##</span>\n<span class=\"c1\">## Import paths can either be prefixed with (data) to import from the common/shared</span>\n<span class=\"c1\">## rules in the data folder in the Anubis source tree or will point to absolute/relative</span>\n<span class=\"c1\">## paths in your filesystem. If you don't have access to the Anubis source tree, check</span>\n<span class=\"c1\">## /usr/share/docs/anubis/data or in the tarball you extracted Anubis from.</span>\n\n<span class=\"nt\">bots</span><span class=\"p\">:</span>\n<span class=\"w\">  </span><span class=\"c1\"># Pathological bots to deny</span>\n<span class=\"w\">  </span><span class=\"p p-Indicator\">-</span><span class=\"w\"> </span><span class=\"c1\"># This correlates to data/bots/ai-robots-txt.yaml in the source tree</span>\n<span class=\"w\">    </span><span class=\"nt\">import</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">(data)/bots/ai-robots-txt.yaml</span>\n<span class=\"w\">  </span><span class=\"p p-Indicator\">-</span><span class=\"w\"> </span><span class=\"nt\">import</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">(data)/bots/cloudflare-workers.yaml</span>\n<span class=\"w\">  </span><span class=\"p p-Indicator\">-</span><span class=\"w\"> </span><span class=\"nt\">import</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">(data)/bots/headless-browsers.yaml</span>\n<span class=\"w\">  </span><span class=\"p p-Indicator\">-</span><span class=\"w\"> </span><span class=\"nt\">import</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">(data)/bots/us-ai-scraper.yaml</span>\n\n<span class=\"w\">  </span><span class=\"c1\"># Search engines to allow</span>\n<span class=\"w\">  </span><span class=\"p p-Indicator\">-</span><span class=\"w\"> </span><span class=\"nt\">import</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">(data)/crawlers/googlebot.yaml</span>\n<span class=\"w\">  </span><span class=\"p p-Indicator\">-</span><span class=\"w\"> </span><span class=\"nt\">import</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">(data)/crawlers/bingbot.yaml</span>\n<span class=\"w\">  </span><span class=\"p p-Indicator\">-</span><span class=\"w\"> </span><span class=\"nt\">import</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">(data)/crawlers/duckduckbot.yaml</span>\n<span class=\"w\">  </span><span class=\"p p-Indicator\">-</span><span class=\"w\"> </span><span class=\"nt\">import</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">(data)/crawlers/qwantbot.yaml</span>\n<span class=\"w\">  </span><span class=\"p p-Indicator\">-</span><span class=\"w\"> </span><span class=\"nt\">import</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">(data)/crawlers/internet-archive.yaml</span>\n<span class=\"w\">  </span><span class=\"p p-Indicator\">-</span><span class=\"w\"> </span><span class=\"nt\">import</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">(data)/crawlers/kagibot.yaml</span>\n<span class=\"w\">  </span><span class=\"p p-Indicator\">-</span><span class=\"w\"> </span><span class=\"nt\">import</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">(data)/crawlers/marginalia.yaml</span>\n<span class=\"w\">  </span><span class=\"p p-Indicator\">-</span><span class=\"w\"> </span><span class=\"nt\">import</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">(data)/crawlers/mojeekbot.yaml</span>\n\n<span class=\"w\">  </span><span class=\"c1\"># Allow common \"keeping the internet working\" routes (well-known, favicon, robots.txt)</span>\n<span class=\"w\">  </span><span class=\"p p-Indicator\">-</span><span class=\"w\"> </span><span class=\"nt\">import</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">(data)/common/keep-internet-working.yaml</span>\n\n<span class=\"w\">  </span><span class=\"c1\"># # Punish any bot with \"bot\" in the user-agent string</span>\n<span class=\"w\">  </span><span class=\"c1\"># # This is known to have a high false-positive rate, use at your own risk</span>\n<span class=\"w\">  </span><span class=\"c1\"># - name: generic-bot-catchall</span>\n<span class=\"w\">  </span><span class=\"c1\">#   user_agent_regex: (?i:bot|crawler)</span>\n<span class=\"w\">  </span><span class=\"c1\">#   action: CHALLENGE</span>\n<span class=\"w\">  </span><span class=\"c1\">#   challenge:</span>\n<span class=\"w\">  </span><span class=\"c1\">#     difficulty: 16  # impossible</span>\n<span class=\"w\">  </span><span class=\"c1\">#     report_as: 4    # lie to the operator</span>\n<span class=\"w\">  </span><span class=\"c1\">#     algorithm: slow # intentionally waste CPU cycles and time</span>\n\n<span class=\"w\">  </span><span class=\"c1\"># Generic catchall rule</span>\n<span class=\"w\">  </span><span class=\"p p-Indicator\">-</span><span class=\"w\"> </span><span class=\"nt\">name</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">generic-browser</span>\n<span class=\"w\">    </span><span class=\"nt\">user_agent_regex</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p p-Indicator\">&gt;-</span>\n<span class=\"w\">      </span><span class=\"no\">Mozilla|Opera</span>\n<span class=\"w\">    </span><span class=\"nt\">action</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">CHALLENGE</span>\n\n<span class=\"nt\">dnsbl</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"l l-Scalar l-Scalar-Plain\">false</span>\n</code></pre></div>",
        "id": 518809629,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1747480768
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"598183\">@Oliver Bertuch</span> so you haven't had to specifically allow for example <code>^/api.*</code> ? (for us, it was shib.xhtml, we had to tell Apache to bypass Anubis for that location. Shib wouldn't work even with shib.xhtml.* set to ALLOW</p>",
        "id": 518810949,
        "sender_full_name": "Don Sizemore",
        "timestamp": 1747481918
    },
    {
        "content": "<p>We're not using Shib, so your mileage vary.</p>",
        "id": 518812502,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1747483223
    },
    {
        "content": "<p>I didn't have to do any of that, because most clients going to the API only will use not Mozilla or  Opera as their user agents.</p>",
        "id": 518812550,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1747483260
    },
    {
        "content": "<p>If someone uses their browser to access the API, it seems unlikely they go directly to it, but probably will go through the UI first.</p>",
        "id": 518812636,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1747483319
    },
    {
        "content": "<p>Then they have the solved challenge cached and can send it along with the request</p>",
        "id": 518812706,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1747483338
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"598183\">@Oliver Bertuch</span> my grad student worked around that with:</p>\n<div class=\"codehilite\"><pre><span></span><code>  &lt;Location /shib.xhtml&gt;\n    AuthType shibboleth\n    ShibRequestSetting requireSession 1\n    require valid-user\n\n    ProxyPass ajp://localhost:8009/shib.xhtml\n    ProxyPassReverse ajp://localhost:8009/shib.xhtml\n  &lt;/Location&gt;\n</code></pre></div>",
        "id": 519095315,
        "sender_full_name": "Don Sizemore",
        "timestamp": 1747657919
    },
    {
        "content": "<p>though I think I see a bit of missing configuration which should fix our excludes problem.</p>",
        "id": 519105569,
        "sender_full_name": "Don Sizemore",
        "timestamp": 1747660026
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"598183\">@Oliver Bertuch</span> I did find that Anubis broke one other thing: dataverse-previewers. We switched course with Anubis, and told it only to challenge <code>/dataverse/</code> <code>/dataverse.xhtml</code> and <code>dataset.xhtml</code> (and kept the explicit AJP bypass in the shib.xhtml location block). FWIW the test server is seeing a botnet matching Anubis' \"aggressive Brazilian scrapers\" criteria: <a href=\"https://github.com/TecharoHQ/anubis/blob/main/data/bots/aggressive-brazilian-scrapers.yaml\">https://github.com/TecharoHQ/anubis/blob/main/data/bots/aggressive-brazilian-scrapers.yaml</a> I am very nearly ready to implement this on UNC Dataverse.</p>",
        "id": 519201294,
        "sender_full_name": "Don Sizemore",
        "timestamp": 1747682237
    },
    {
        "content": "<p>I don't have previewers yet, so I didn't notice that one! Good catch! <a href=\"https://static1.colliderimages.com/wordpress/wp-content/uploads/2022/04/Moon-Knight-Episode-5-duat-copy.jpg\">Let the folks realm through the wheat of Duat freely.</a> <span aria-label=\"relieved\" class=\"emoji emoji-1f60c\" role=\"img\" title=\"relieved\">:relieved:</span></p>\n<div class=\"message_inline_image\"><a href=\"https://static1.colliderimages.com/wordpress/wp-content/uploads/2022/04/Moon-Knight-Episode-5-duat-copy.jpg\" title=\"Let the folks realm through the wheat of Duat freely.\"><img src=\"https://uploads.zulipusercontent.net/ec3ff5aabeec0c391fecc0d1cb4a9389323d0a78/68747470733a2f2f737461746963312e636f6c6c69646572696d616765732e636f6d2f776f726470726573732f77702d636f6e74656e742f75706c6f6164732f323032322f30342f4d6f6f6e2d4b6e696768742d457069736f64652d352d647561742d636f70792e6a7067\"></a></div>",
        "id": 519202031,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1747682448
    },
    {
        "content": "<p>are you using direct upload/download? (that seems to work fine)</p>",
        "id": 519208357,
        "sender_full_name": "Don Sizemore",
        "timestamp": 1747684250
    },
    {
        "content": "<p>Nope, not yet. Will need to build an S3 proxy first.</p>",
        "id": 519208532,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1747684306
    },
    {
        "content": "<p>Thanks a lot for this thread. We are facing the same problem and will try <a href=\"https://anubis.techaro.lol/\">https://anubis.techaro.lol/</a>.</p>",
        "id": 522101248,
        "sender_full_name": "Dorothea Iglezakis",
        "timestamp": 1748951638
    },
    {
        "content": "<p>If you need something brandable <em>now</em>, take a look at <a href=\"https://git.gammaspectra.live/git/go-away\">https://git.gammaspectra.live/git/go-away</a>. Techaro wanted to make Anubis brandable but as a paid option only.</p>",
        "id": 522101563,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1748951717
    },
    {
        "content": "<p>We found disabling Solr Facet works reasonably well <a href=\"https://guides.dataverse.org/en/latest/installation/config.html#disablesolrfacetswithoutjsession\">https://guides.dataverse.org/en/latest/installation/config.html#disablesolrfacetswithoutjsession</a> (did a manual adjustment since our version does not have this functionality). Thanks to Jim Myers for suggesting.</p>",
        "id": 522246397,
        "sender_full_name": "Yuyun Wirawati",
        "timestamp": 1749001280
    },
    {
        "content": "<p>Related: <a href=\"https://library.unc.edu/news/library-it-vs-the-ai-bots/\">https://library.unc.edu/news/library-it-vs-the-ai-bots/</a></p>",
        "id": 524280195,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1750087283
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"719882\">@Bikram</span> you're going to talk about these bots in a future community call, right? Should we start hyping it? <span aria-label=\"smile\" class=\"emoji emoji-1f604\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 533981971,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1755005391
    },
    {
        "content": "<p>haha surprisingly Borealis is getting lesser Bot attention as compared to other service we host, but we are using same preventive measures for Borealis as they share the same front-end proxy.</p>",
        "id": 533999068,
        "sender_full_name": "Bikram",
        "timestamp": 1755010470
    },
    {
        "content": "<p>That's good.</p>",
        "id": 533999317,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1755010552
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"719882\">@Bikram</span> and do I have it right that you want 10-15 minutes during the next call, in September?</p>",
        "id": 533999581,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1755010639
    },
    {
        "content": "<p>yes, Amber suggested doing so</p>",
        "id": 534003276,
        "sender_full_name": "Bikram",
        "timestamp": 1755011771
    },
    {
        "content": "<p>Great, Julian is running that call and already created an <a href=\"https://docs.google.com/document/d/1daw0hHWOtd3PtSF-meM1BN6nK8JwoYhbTChUAiC-GwQ/edit?usp=sharing\">agenda</a> for it. <span class=\"user-mention\" data-user-id=\"621770\">@Julian Gautier</span> I'm happy to go ahead and add a bullet about bots if you like.</p>",
        "id": 534003696,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1755011918
    },
    {
        "content": "<p>Thanks all. Like I wrote in the email thread I'd like confirm with Jenna first before editing the agenda</p>",
        "id": 534013049,
        "sender_full_name": "Julian Gautier",
        "timestamp": 1755014903
    },
    {
        "content": "<p>Thanks for confirming with Jenna and updating the agenda! Looks like we're on!</p>",
        "id": 534291823,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1755113581
    },
    {
        "content": "<p>A critical remark on Anubis: <a href=\"https://lock.cmpxchg8b.com/anubis.html\">https://lock.cmpxchg8b.com/anubis.html</a></p>",
        "id": 535618307,
        "sender_full_name": "Yuyun Wirawati",
        "timestamp": 1755841162
    },
    {
        "content": "<p>We're starting the call that includes <span class=\"user-mention\" data-user-id=\"719882\">@Bikram</span> on bots! <a href=\"https://docs.google.com/document/d/1daw0hHWOtd3PtSF-meM1BN6nK8JwoYhbTChUAiC-GwQ/edit?usp=sharing\">https://docs.google.com/document/d/1daw0hHWOtd3PtSF-meM1BN6nK8JwoYhbTChUAiC-GwQ/edit?usp=sharing</a></p>",
        "id": 537293750,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1756821742
    },
    {
        "content": "<p><a href=\"/user_uploads/53090/0GoKLKJSqzuj0gL3M8WxFgAB/Screenshot-2025-09-02-at-10.04.44AM.png\">Screenshot 2025-09-02 at 10.04.44â€¯AM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/53090/0GoKLKJSqzuj0gL3M8WxFgAB/Screenshot-2025-09-02-at-10.04.44AM.png\" title=\"Screenshot 2025-09-02 at 10.04.44â€¯AM.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"3680x2234\" src=\"/user_uploads/thumbnail/53090/0GoKLKJSqzuj0gL3M8WxFgAB/Screenshot-2025-09-02-at-10.04.44AM.png/840x560.webp\"></a></div>",
        "id": 537294396,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1756821913
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"719882\">@Bikram</span> great talk and thanks for posting your <a href=\"https://docs.google.com/presentation/d/13UCVcQRhVZCEANwFWyl0afA3RyJfgx7pa7yHEhvmkSI/edit?usp=sharing\">slides</a>! <img alt=\":dataverse_man:\" class=\"emoji\" src=\"https://avatars.zulip.com/53090/emoji/images/c7b94a03.png\" title=\"dataverse man\"></p>",
        "id": 537300279,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1756823628
    },
    {
        "content": "<p>thank you <span class=\"user-mention\" data-user-id=\"598112\">@Philip Durbin ðŸš€</span>  :)</p>",
        "id": 537315602,
        "sender_full_name": "Bikram",
        "timestamp": 1756827966
    },
    {
        "content": "<p>Sure, here's the <a href=\"https://harvard.zoom.us/rec/share/WWBZ-_UtWm8gbmZf6l2FFnmh9qqYT53UDlEt8qxXdgH8XoDhd9XsRdFcSQIwFkQ7.iWL9iur3fjm2aEef\">recording</a>!</p>",
        "id": 537319637,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1756829065
    },
    {
        "content": "<p>Thanks for the sharing <span class=\"user-mention\" data-user-id=\"719882\">@Bikram</span>  can pls share with us if you have tested / implemented the Cloudflare Turnstile on Borealis data download? <span aria-label=\"nerd\" class=\"emoji emoji-1f913\" role=\"img\" title=\"nerd\">:nerd:</span></p>",
        "id": 537601683,
        "sender_full_name": "Yuyun Wirawati",
        "timestamp": 1756969068
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"903222\">@Yuyun Wirawati</span>, we have not implemented Cloudflare turnstile yet, because Borealis does not run on single URL. We have another project Odesi which is integrated with Borealis and for Odesi data Lot of schools access Borealis via Ezproxy, so the URL changes for each school. First challenge is to add all the URLs to Turnstile allowlist, second challenge is Free Cloudflare only allow 15 URLs per widget, we were in talks with them to get a 100 URL limit widget but the quotes were too high and did not work for us. We may end of moving Borealis behind Cloudflare Proxy which is included for free.</p>",
        "id": 537659521,
        "sender_full_name": "Bikram",
        "timestamp": 1756988584
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"626369\">@Don Sizemore</span> <span class=\"user-mention\" data-user-id=\"637063\">@Leo Andreev</span> you have Anubis in place, right? Is one of you still using normal upload instead of S3 Direct Upload? I'm having trouble with Anubis not forwarding error messages from the API when a file upload fails due to size restrictions.</p>",
        "id": 542482221,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1759321763
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"598183\">@Oliver Bertuch</span> We have Anubis in place but haven't run into this particular problem (yet)</p>",
        "id": 542484897,
        "sender_full_name": "Don Sizemore",
        "timestamp": 1759322594
    },
    {
        "content": "<p>Are you using Anubis in a reverse-proxy mode in between Apache and Dataverse? Also, which version are you running?</p>",
        "id": 542485785,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1759322824
    },
    {
        "content": "<p>our particular config is written up here as a sample: <a href=\"https://github.com/IQSS/dataverse-security/wiki/Protecting-Dataverse-with-Anubis\">https://github.com/IQSS/dataverse-security/wiki/Protecting-Dataverse-with-Anubis</a> additions and corrections always welcome.</p>",
        "id": 542545156,
        "sender_full_name": "Don Sizemore",
        "timestamp": 1759338503
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"598183\">Oliver Bertuch</span> <a href=\"#narrow/channel/375707-community/topic/Aggressive.20crawlers.20.2F.20bots/near/542485785\">said</a>:</p>\n<blockquote>\n<p>Are you using Anubis in a reverse-proxy mode in between Apache and Dataverse? Also, which version are you running?</p>\n</blockquote>\n<p>In the case of Shibboleth, we provided an explicit Anubis bypass. I think Leonid did this for the API as well?</p>\n<div class=\"codehilite\"><pre><span></span><code>      ProxyPass ajp://localhost:8009/shib.xhtml\n      ProxyPassReverse ajp://localhost:8009/shib.xhtml\n</code></pre></div>",
        "id": 543006121,
        "sender_full_name": "Don Sizemore",
        "timestamp": 1759517356
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"626369\">Don Sizemore</span> <a href=\"#narrow/channel/375707-community/topic/Aggressive.20crawlers.20.2F.20bots/near/542545156\">said</a>:</p>\n<blockquote>\n<p>our particular config is written up here as a sample: <a href=\"https://github.com/IQSS/dataverse-security/wiki/Protecting-Dataverse-with-Anubis\">https://github.com/IQSS/dataverse-security/wiki/Protecting-Dataverse-with-Anubis</a> additions and corrections always welcome.</p>\n</blockquote>\n<p>I'm getting a 404 on that url <span class=\"user-mention\" data-user-id=\"626369\">@Don Sizemore</span></p>",
        "id": 543260870,
        "sender_full_name": "Michael Madsen",
        "timestamp": 1759742883
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"972936\">@Michael Madsen</span> correct, that's a private repo. you may request access via <a href=\"mailto:security@dataverse.org\">security@dataverse.org</a></p>",
        "id": 543303921,
        "sender_full_name": "Don Sizemore",
        "timestamp": 1759754683
    },
    {
        "content": "<p>I'm new to bot mitigation and find this thread useful!</p>\n<p>Based on the conversations here I see that most are opting for a 3rd party solution - which we will be investigating.  Meanwhile I've tried simple rate limiting as provided by setting :RateLimitingDefaultCapacityTiers.  We've found that during intense bot activity we will get to the point where the 429 response kicks in. </p>\n<p>I was expecting that just the IPs of the bots exceeding set values would be blocked.  Instead it appears all non signed in users were getting blocked once the count exceeded settings - including myself via a browser.</p>\n<p>Is this expected behavior?  Is :RateLimitingDefaultCapacityTiers (and :RateLimitingCapacityByTierAndAction) not intended to deter bots? Are there additional settings other than \"-X PUT -d '[x],[y]'\" that need to be set?  Thanks</p>",
        "id": 546313301,
        "sender_full_name": "Frank Smutniak",
        "timestamp": 1761075200
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"899920\">@Frank Smutniak</span> yes, I owe Leonid a documentation pull request here. IIRC not-logged-in users are tier 0 and subject to the rate limit, while logged-in users are tier 1 and not subject to any limit. The fix is to manually browse to /loginpage.xhtml and sign in. This was the \"nuclear\" option in bot protection.</p>",
        "id": 546316773,
        "sender_full_name": "Don Sizemore",
        "timestamp": 1761076632
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"760572\">@Steven Winship</span> is the expert on rate limiting. He might have some more insight for us.</p>",
        "id": 546317422,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1761076870
    },
    {
        "content": "<p>Tier0 is the rate limit for all Guest users. Logged in users can be added to a tier but there is no way to limit by IP address.</p>",
        "id": 546319206,
        "sender_full_name": "Steven Winship",
        "timestamp": 1761077556
    },
    {
        "content": "<p>Thanks all.  That corresponds with what we saw and we will investigate other options mentioned in this topic.</p>",
        "id": 546331769,
        "sender_full_name": "Frank Smutniak",
        "timestamp": 1761082571
    }
]