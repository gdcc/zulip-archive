[
    {
        "content": "<p>Hello Dataverse community,</p>\n<p>I have a question about how to migrate datasets with the correct licensing terms.</p>\n<p>In the documentation (version 5.10) it is indicated that you must specify which license you want to transfer in the JSON file,<br>\nBut this is not taken into account with the API command (<a href=\"https://guides.dataverse.org/en/5.10/api/native-api.html#id41\">https://guides.dataverse.org/en/5.10/api/native-api.html#id41</a>)</p>\n<p>I want to integrate this but the \"license\" field under \"datasetVersion\" in the Json doesn't seem to work.<br>\nI tested it on the same Dataverse installation with the same version 5.10.</p>\n<p>The other condition fields work but not this one...<br>\nIs there a way to explain this or tell how to put this field correctly in the Json file?<br>\nNote: the field 'termsOfUse' is not present or set to null (it doesn't change the result)</p>\n<p>Thanks in advance,<br>\nBest regards</p>",
        "id": 393639056,
        "sender_full_name": "Julien C",
        "timestamp": 1695886453
    },
    {
        "content": "<p>One important precision: the controlled Vocabulary field for 'license' is the same on the target server.</p>",
        "id": 393639367,
        "sender_full_name": "Julien C",
        "timestamp": 1695886563
    },
    {
        "content": "<p>Quite possibly you have found a bug.</p>",
        "id": 393683239,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1695899238
    },
    {
        "content": "<p>What license are you using here?</p>\n<div class=\"codehilite\"><pre><span></span><code>    &quot;license&quot;: {\n      &quot;name&quot;: &quot;CC0 1.0&quot;,\n      &quot;uri&quot;: &quot;http://creativecommons.org/publicdomain/zero/1.0&quot;\n    },\n</code></pre></div>",
        "id": 393683320,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1695899257
    },
    {
        "content": "<p>Hello Philip,<br>\nThe license concerned is :<br>\n<code>\"license\": {\"name\": \"etalab 2.0\", \"uri\": \"https://spdx.org/licenses/etalab-2.0.html\"}</code><br>\nSame license on source server and target server.<br>\nI can't get to it to work.</p>",
        "id": 393862476,
        "sender_full_name": "Julien C",
        "timestamp": 1695968211
    },
    {
        "content": "<p>Sorry, sorry, busy with <a href=\"https://github.com/IQSS/dataverse/issues/9919\">#9919</a>. If I don't look at this early next week, please remind me! Have a good weekend!</p>",
        "id": 394004357,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1696021643
    },
    {
        "content": "<p>Hello Philippe,<br>\nNo problem, I checked it several times and tested it, same results every time.<br>\nThe licenses are the same on both sides (origin and target server with the same API version 5.10).<br>\nThis is annoying because other terms and conditions are taken into account.<br>\nMaybe I'm defining things the wrong way in JSON for licensing.</p>",
        "id": 394350666,
        "sender_full_name": "Julien C",
        "timestamp": 1696233237
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"599826\">@Sherry Lake</span> does this sound reminiscent of problems you were having updating licenses/terms via API?</p>",
        "id": 395890442,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1696946423
    },
    {
        "content": "<p>Could be... but my question about this unique license is has it been defined (\"added/configured\") before it is used in the migration json?</p>",
        "id": 395974639,
        "sender_full_name": "Sherry Lake",
        "timestamp": 1696980949
    },
    {
        "content": "<p>I had lunch with <span class=\"user-mention\" data-user-id=\"622847\">@Dimitri Szabo</span> today and yes, he confirmed that the license should be there on the server side.</p>",
        "id": 395980933,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1696984229
    },
    {
        "content": "<p>Hello, thank you for your answers.<br>\nI specified that my test was on a duplicate server (same licenses on both sides) and with the correct license indicated in the JSON file and it doesn't work: I mean the API request was OK but the license has not been selected.<br>\nAm I missing something for this to work correctly?</p>",
        "id": 396522910,
        "sender_full_name": "Julien C",
        "timestamp": 1697209402
    },
    {
        "content": "<p>Jim thinks we should try the Migration API. However, it requires an API token. Can you please send me the JSON from the \"get dataset metadata\" curl command at <a href=\"https://guides.dataverse.org/en/5.10/developers/dataset-semantic-metadata-api.html\">https://guides.dataverse.org/en/5.10/developers/dataset-semantic-metadata-api.html</a> ?</p>",
        "id": 396569966,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1697230625
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"651537\">@Julien C</span> did you get a chance to try this?</p>",
        "id": 397138309,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1697557729
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"651537\">@Julien C</span> and did you see this? A new Python script for migrating datasets from one installation to another: <a href=\"https://groups.google.com/g/dataverse-community/c/PfKIZFxFZhE/m/RBC0j4q1HQAJ\">https://groups.google.com/g/dataverse-community/c/PfKIZFxFZhE/m/RBC0j4q1HQAJ</a></p>",
        "id": 397319808,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1697637662
    },
    {
        "content": "<p>Hello and thanks for sharing (I see some SQL on dvobject table). This is not something I can do on the target server.<br>\nMaybe it can be done in the future, but I need to have confirmation this type of modification directly in SQL is Ok for the whole integrity of Database.</p>",
        "id": 397668732,
        "sender_full_name": "Julien C",
        "timestamp": 1697794263
    },
    {
        "content": "<p><a href=\"https://guides.dataverse.org/en/5.10/developers/dataset-semantic-metadata-api.html\">https://guides.dataverse.org/en/5.10/developers/dataset-semantic-metadata-api.html</a><br>\nI will run some tests. Thanks,  If it works it needs to be done separately with one more step for license.<br>\nMy initial attempt was to integrate this with the rest of all available metadata. (not working for license field but all others terms tab working)<br>\n{ \"datasetVersion\": {\"license\": {\"name\": \"etalab 2.0\", \"uri\": \"https://spdx.org/licenses/etalab-2.0.html\"}, ...}]</p>",
        "id": 397669608,
        "sender_full_name": "Julien C",
        "timestamp": 1697794632
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"598112\">Philip Durbin</span> <a href=\"#narrow/stream/375707-community/topic/Datasets.20-.20Migration.20-.20License.20JSON/near/397319808\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"651537\">Julien C</span> and did you see this? A new Python script for migrating datasets from one installation to another: <a href=\"https://groups.google.com/g/dataverse-community/c/PfKIZFxFZhE/m/RBC0j4q1HQAJ\">https://groups.google.com/g/dataverse-community/c/PfKIZFxFZhE/m/RBC0j4q1HQAJ</a></p>\n</blockquote>\n<p>There is many things to consider. <br>\nDataset published and only  in version 1.0, others with versions and possible Draft, those only on draft and with no publication yet. <br>\nGet a perfect image of the installation is possible (I'm pretty close to make it done). <br>\nBut remain the problem of DOI for Datasets, and DOI for DataFiles and change the date of publication (version included) and date of upload for resources, it's a lot of things to consider (Datasets version it's more complicated because you need a DOI validation on 1st version before u can do some update on metadata for Datasets itself and DataFiles in version (with addition, deletion)...<br>\nMy main problem is to handle correctly all DOI migration.  If Publication date and upload date can be done with SQL, ok but I need these too before updating to DOI provider on first version of a dataset.</p>\n<p>I have forgot to mentioned all my work in actually scripted (Python in ETL). So no manual edition possible, especially when you have 15 000 published Datafiles for a total of 22 000 for around 100 Go of data.</p>",
        "id": 397671597,
        "sender_full_name": "Julien C",
        "timestamp": 1697795342
    },
    {
        "content": "<p>Right, it sounds like keeping the DOIs (for both datasets and files) is super important for you, which makes sense.</p>",
        "id": 397683532,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1697799210
    },
    {
        "content": "<p>Please let me know how the testing with the Migration API goes.</p>",
        "id": 397683602,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1697799239
    },
    {
        "content": "<p>At a high level, especially for the SQL question (which I can't answer), I'll be looking for help from the team via the ticket you opened: <a href=\"https://help.hmdc.harvard.edu/Ticket/Display.html?id=349765\">https://help.hmdc.harvard.edu/Ticket/Display.html?id=349765</a></p>",
        "id": 397686173,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1697800158
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"651537\">@Julien C</span> I just checked with our tech lead and either he or someone else will reach out via that ticket on Monday.</p>",
        "id": 397757078,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1697825859
    },
    {
        "content": "<p>SOLVED<br>\nWith API called Dataset Semantic Metadata the modification of license attribution works. (tested and approved).<br>\n<a href=\"https://guides.dataverse.org/en/5.12/developers/dataset-semantic-metadata-api.html\">https://guides.dataverse.org/en/5.12/developers/dataset-semantic-metadata-api.html</a></p>\n<p>The only important thing  is that the target server must already have implemented the equivalent license for selection.<br>\nIn python with request library it's simple, the json-ld must be indicated in data parameter in the put request.</p>\n<p>Maybe it will help other people in the same situation.<br>\nRegards</p>",
        "id": 398044103,
        "sender_full_name": "Julien C",
        "timestamp": 1698052693
    },
    {
        "content": "<p>Great news! <span aria-label=\"tada\" class=\"emoji emoji-1f389\" role=\"img\" title=\"tada\">:tada:</span></p>",
        "id": 398066756,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1698061467
    }
]