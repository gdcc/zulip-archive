[
    {
        "content": "<p>I just thought I'd kick off a topic to discuss and issued <span class=\"user-mention\" data-user-id=\"616555\">@Vera Clemens</span> opened: Feature Request/Idea: Add psql to the configbaker image <a href=\"https://github.com/IQSS/dataverse/issues/10487\">#10487</a></p>",
        "id": 432869945,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1712915653
    },
    {
        "content": "<p>Sure, go ahead and create a PR</p>",
        "id": 432870520,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1712915892
    },
    {
        "content": "<p>I would like to point out though that a cleaner and more testable solution would be to make Dataverse pick up the procedures via Flyway</p>",
        "id": 432870616,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1712915934
    },
    {
        "content": "<p>Obviously that is a lot more effort...</p>",
        "id": 432870648,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1712915948
    },
    {
        "content": "<p>Yeah, that sounds like a new topic <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 432870768,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1712915999
    },
    {
        "content": "<p>Adding psql should be straighforward, right? Just add to an existing list of <code>apt-get install</code> packages or something?</p>",
        "id": 432870920,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1712916044
    },
    {
        "content": "<p>It's Alpine so it will be \"apk\", but yes, more or less straightforward</p>",
        "id": 432872460,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1712916528
    },
    {
        "content": "<p>Might be nice to have a little helper script that adds the connection options for you to sane defaults so you don't have to deal with that in simple cases</p>",
        "id": 432872578,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1712916584
    },
    {
        "content": "<p>ARG APK_PACKAGES=\"curl bind-tools netcat-openbsd jq bash dumb-init wait4x ed\" at <a href=\"https://github.com/IQSS/dataverse/blob/v6.2/modules/container-configbaker/Dockerfile#L24\">https://github.com/IQSS/dataverse/blob/v6.2/modules/container-configbaker/Dockerfile#L24</a></p>",
        "id": 432884161,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1712921626
    },
    {
        "content": "<p>thanks!</p>",
        "id": 432884177,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1712921631
    },
    {
        "content": "<p>If people feel like we should add another ARG to include custom packages during build time, that's doable</p>",
        "id": 432885617,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1712922043
    },
    {
        "content": "<p>(So you would use a Maven property in your build pipeline to add more packages)</p>",
        "id": 432885662,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1712922068
    },
    {
        "content": "<p>Sure, but what do you think? Separate issue and PR?</p>",
        "id": 432885978,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1712922207
    },
    {
        "content": "<p>Don't look now, <span class=\"user-mention\" data-user-id=\"617722\">@Johannes D</span> made a PR: Added postgresql-client to the list of installed apk packages <a href=\"https://github.com/IQSS/dataverse/issues/10488\">#10488</a></p>",
        "id": 432887218,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1712922702
    },
    {
        "content": "<p>Is it also possible to get the package in Dataverse image? This allows you to run certain custom scripts. </p>\n<p><a href=\"https://github.com/IQSS/dataverse/blob/ae149dec1d319c2b383de32e8af01a47fcaaccdf/modules/container-base/src/main/docker/Dockerfile#L97\">https://github.com/IQSS/dataverse/blob/ae149dec1d319c2b383de32e8af01a47fcaaccdf/modules/container-base/src/main/docker/Dockerfile#L97</a></p>\n<p>\"postgresql-client\"</p>\n<p>or is there something against it?</p>",
        "id": 437600539,
        "sender_full_name": "Benedikt",
        "timestamp": 1715155985
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"699150\">@Benedikt</span> sounds fine to me. Please feel free to create an issue and a pull request.</p>",
        "id": 437620834,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1715163781
    },
    {
        "content": "<p><a href=\"https://github.com/IQSS/dataverse/pull/10546\">https://github.com/IQSS/dataverse/pull/10546</a></p>",
        "id": 437622907,
        "sender_full_name": "Benedikt",
        "timestamp": 1715164680
    },
    {
        "content": "<p>Thanks!</p>",
        "id": 437627621,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1715166546
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"699150\">@Benedikt</span> hi! <span class=\"user-mention\" data-user-id=\"598183\">@Oliver Bertuch</span> <span class=\"user-mention\" data-user-id=\"720428\">@Thomas van Erven</span> and I are discussing this during the weekly call and we're wondering if adding psql to the base image is necessary. It adds more exposure, possible security risks, and psql could be run from configbaker or the postgres image. Can you please say some more about your use cases? Thanks!</p>",
        "id": 443064386,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1717681537
    },
    {
        "content": "<p>Thanks for talking this out just now on the call.</p>",
        "id": 443075383,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1717684454
    },
    {
        "content": "<p>I have closed it, and I understand why it should not be intrgated. My question is why do you have wget and curl in there? <br>\nIf you want to keep it small and clean, then you can do a bit more. Or is there a reason for this?</p>",
        "id": 443075597,
        "sender_full_name": "Benedikt",
        "timestamp": 1717684520
    },
    {
        "content": "<p>Hmm, good question, where to draw the line.</p>",
        "id": 443075803,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1717684569
    },
    {
        "content": "<p>Should we add a comment above the <code>ARG PKGS</code> line? To provide some guidance?</p>",
        "id": 443076519,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1717684769
    },
    {
        "content": "<p>I think what's relevant (as well) is what's the dependency chain for those packages and how much of that is provided by the base image? Are we going out of our way to include them (hence unnecessarily increasing exposure) or is it a really minor detour?</p>",
        "id": 443078312,
        "sender_full_name": "Thomas van Erven",
        "timestamp": 1717685253
    }
]