[
    {
        "content": "<p>I just created <a href=\"https://github.com/IQSS/dataverse/issues/11239\">#11239</a>. Can anyone reproduce this? Can anyone suggest anything for me to try?</p>",
        "id": 498852557,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1739218149
    },
    {
        "content": "<p>It works for <span class=\"user-mention\" data-user-id=\"648750\">@Juan Pablo Tosca Villanueva</span>. Weird.</p>\n<p>I have a slightly newer version of Docker and macOS.</p>",
        "id": 498856115,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1739219384
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>% diff --side-by-side /tmp/phil /tmp/jp\nClient:                             Client:\n Version:           27.5.1                    |  Version:           27.4.0\n API version:       1.47                     API version:       1.47\n Go version:        go1.22.11                     |  Go version:        go1.22.10\n Git commit:        9f9e405                   |  Git commit:        bde2b89\n Built:             Wed Jan 22 13:37:19 2025              |  Built:             Sat Dec  7 10:35:43 2024\n OS/Arch:           darwin/arm64                 OS/Arch:           darwin/arm64\n Context:           desktop-linux                Context:           desktop-linux\n\nServer: Docker Desktop 4.38.0 (181591)                | Server: Docker Desktop 4.37.2 (179585)\n Engine:                             Engine:\n  Version:          27.5.1                    |   Version:          27.4.0\n  API version:      1.47 (minimum version 1.24)           API version:      1.47 (minimum version 1.24)\n  Go version:       go1.22.11                     |   Go version:       go1.22.10\n  Git commit:       4c9b3b0                   |   Git commit:       92a8393\n  Built:            Wed Jan 22 13:41:25 2025              |   Built:            Sat Dec  7 10:38:33 2024\n  OS/Arch:          linux/arm64                   OS/Arch:          linux/arm64\n  Experimental:     false                     Experimental:     false\n containerd:                             containerd:\n  Version:          1.7.25                    |   Version:          1.7.21\n  GitCommit:        bcc810d6b9066471b0b6fa75f557a15a1cbf31bb  |   GitCommit:        472731909fa34bd7bc9c087e4c27943f9835f111\n runc:                               runc:\n  Version:          1.1.12                    |   Version:          1.1.13\n  GitCommit:        v1.1.12-0-g51d5e946               |   GitCommit:        v1.1.13-0-g58aa920\n docker-init:                            docker-init:\n  Version:          0.19.0                    Version:          0.19.0\n  GitCommit:        de40ad0                   GitCommit:        de40ad0\nSoftware:                           Software:\n\n    System Software Overview:                       System Software Overview:\n\n      System Version: macOS 15.3 (24D60)              |       System Version: macOS 14.6.1 (23G93)\n      Kernel Version: Darwin 24.3.0               |       Kernel Version: Darwin 23.6.0\n      Boot Volume: Macintosh HD                       Boot Volume: Macintosh HD\n      Boot Mode: Normal                           Boot Mode: Normal\n      Computer Name: PDurbinâ€™s MacBook Pro            |       Computer Name: JPâ€™s MacBook Pro\n      User Name: Philip Durbin (PDurbin)              |       User Name: JP Tosca (jptosca)\n      Secure Virtual Memory: Enabled                      Secure Virtual Memory: Enabled\n      System Integrity Protection: Enabled                System Integrity Protection: Enabled\n      Time since boot: 11 minutes, 9 seconds              |       Time since boot: 7 days, 23 hours, 53 minutes\n</code></pre></div>",
        "id": 498856133,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1739219391
    },
    {
        "content": "<p>Sounds like they changed the CLI \"API\" in Docker...</p>",
        "id": 498860879,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1739220955
    },
    {
        "content": "<p>When looking for buildx unknown command there are results appearing that they might have removed buildx as core functions. You might need to install a plugin</p>",
        "id": 498861173,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1739221059
    },
    {
        "content": "<p>Hmm, I'm seeing \"Docker Buildx is included in Docker Desktop for Windows and macOS\" at <a href=\"https://github.com/docker/buildx\">https://github.com/docker/buildx</a></p>",
        "id": 498861416,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1739221133
    },
    {
        "content": "<p>on Ubuntu the docker-buildx plugin is a separate package. I left the results of my (vanilla, squeaky-new) build attempt as a comment on <a href=\"https://github.com/IQSS/dataverse/issues/11239\">#11239</a></p>",
        "id": 498861611,
        "sender_full_name": "Don Sizemore",
        "timestamp": 1739221195
    },
    {
        "content": "<p>Have you tried running docker buildx in a terminal?</p>",
        "id": 498861809,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1739221244
    },
    {
        "content": "<p>Is the command available there?</p>",
        "id": 498861829,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1739221252
    },
    {
        "content": "<p>\"version\" seems to work:</p>\n<div class=\"codehilite\"><pre><span></span><code>% docker buildx version\ngithub.com/docker/buildx v0.20.1-desktop.2 aaf7c2bc7f9ec3afee1cec77d671845a4b57a0c8\n</code></pre></div>",
        "id": 498861919,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1739221282
    },
    {
        "content": "<p>Ok so it might be that path problem again</p>",
        "id": 498861985,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1739221303
    },
    {
        "content": "<p>Remember <a href=\"https://github.com/docker/for-mac/issues/6928\">https://github.com/docker/for-mac/issues/6928</a>?</p>",
        "id": 498862040,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1739221320
    },
    {
        "content": "<p>If this keeps breaking I don't know if we should keep the Maven plugin. It's nice and all but it needs to work and not break every now and then because of some update.</p>",
        "id": 498862726,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1739221543
    },
    {
        "content": "<p>yeah</p>",
        "id": 498863266,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1739221709
    },
    {
        "content": "<p>The main reasons to use it was a) put the dependencies in an extra layer and b) have a convenient, integrated thing with the rest of the build pipeline. Wrt (a) we might decide to not give a whatev about optimization and wrt (b) well IDK what folks want and like.</p>",
        "id": 498863653,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1739221849
    },
    {
        "content": "<p>It looks like I can download the version JP is on (4.37.2) from <a href=\"https://docs.docker.com/desktop/release-notes/\">https://docs.docker.com/desktop/release-notes/</a></p>",
        "id": 498863712,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1739221869
    },
    {
        "content": "<p>Not sure it will restore any fixes we might have done before.</p>",
        "id": 498863773,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1739221895
    },
    {
        "content": "<p>I downgraded to 4.37.2 but I'm getting the same error.</p>",
        "id": 498864623,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1739222155
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>[INFO] --- docker:0.45.0:build (default-build) @ container-base ---\n[INFO] Reading assembly descriptor: /Users/PDurbin/github/iqss/dataverse/modules/container-base/src/main/docker/assembly.xml\n[INFO] Copying files to /Users/PDurbin/github/iqss/dataverse/modules/container-base/target/docker/gdcc/base/6.6-noble-p6.2024.6-j17/build/maven\n[INFO] Building tar: /Users/PDurbin/github/iqss/dataverse/modules/container-base/target/docker/gdcc/base/6.6-noble-p6.2024.6-j17/tmp/docker-build.tar\n[INFO] DOCKER&gt; [gdcc/base:6.6-noble-p6.2024.6-j17] &quot;base&quot;: Created docker-build.tar in 2 seconds\n[INFO] DOCKER&gt; Credentials helper reply for &quot;docker-credential-desktop&quot; is docker-credential-desktop (github.com/docker/docker-credential-helpers) v0.8.2\n[WARNING] DOCKER&gt; docker: &#39;buildx&#39; is not a docker command.\n[WARNING] DOCKER&gt; See &#39;docker --help&#39;\n[INFO] Expanding: /Users/PDurbin/github/iqss/dataverse/modules/container-base/target/docker/gdcc/base/6.6-noble-p6.2024.6-j17/tmp/docker-build.tar into /Users/PDurbin/github/iqss/dataverse/modules/container-base/target/docker/gdcc/base/6.6-noble-p6.2024.6-j17/tmp/docker-build\n[INFO] DOCKER&gt; docker --config /Users/PDurbin/github/iqss/dataverse/modules/container-base/target/buildx-state buildx build --progress=plain --builder maven --platform linux/arm64 --tag gdcc/base:6.6-noble-p6.2024.6-j17 --build-arg GID=1000 --build-arg JAVA_IMAGE=eclipse-temurin:17-jre-noble --build-arg UID=1000 --file=/Users/PDurbin/github/iqss/dataverse/modules/container-base/target/docker/gdcc/base/6.6-noble-p6.2024.6-j17/tmp/docker-build/Dockerfile /Users/PDurbin/github/iqss/dataverse/modules/container-base/target/docker/gdcc/base/6.6-noble-p6.2024.6-j17/tmp/docker-build --load\n[INFO] DOCKER&gt; unknown flag: --progress\n[INFO] DOCKER&gt; See &#39;docker --help&#39;.\n[INFO] DOCKER&gt;\n[INFO] DOCKER&gt; Usage:  docker [OPTIONS] COMMAND\n[INFO] DOCKER&gt;\n[INFO] DOCKER&gt; A self-sufficient runtime for containers\n[INFO] DOCKER&gt;\n[INFO] DOCKER&gt; Common Commands:\n[INFO] DOCKER&gt;   run         Create and run a new container from an image\n[INFO] DOCKER&gt;   exec        Execute a command in a running container\n[INFO] DOCKER&gt;   ps          List containers\n[INFO] DOCKER&gt;   build       Build an image from a Dockerfile\n[INFO] DOCKER&gt;   pull        Download an image from a registry\n[INFO] DOCKER&gt;   push        Upload an image to a registry\n[INFO] DOCKER&gt;   images      List images\n[INFO] DOCKER&gt;   login       Authenticate to a registry\n[INFO] DOCKER&gt;   logout      Log out from a registry\n[INFO] DOCKER&gt;   search      Search Docker Hub for images\n[INFO] DOCKER&gt;   version     Show the Docker version information\n[INFO] DOCKER&gt;   info        Display system-wide information\n[INFO] DOCKER&gt;\n[INFO] DOCKER&gt; Management Commands:\n[INFO] DOCKER&gt;   builder     Manage builds\n[INFO] DOCKER&gt;   container   Manage containers\n[INFO] DOCKER&gt;   context     Manage contexts\n[INFO] DOCKER&gt;   image       Manage images\n[INFO] DOCKER&gt;   manifest    Manage Docker image manifests and manifest lists\n[INFO] DOCKER&gt;   network     Manage networks\n[INFO] DOCKER&gt;   plugin      Manage plugins\n[INFO] DOCKER&gt;   system      Manage Docker\n[INFO] DOCKER&gt;   trust       Manage trust on Docker images\n[INFO] DOCKER&gt;   volume      Manage volumes\n[INFO] DOCKER&gt;\n[INFO] DOCKER&gt; Swarm Commands:\n[INFO] DOCKER&gt;   swarm       Manage Swarm\n[INFO] DOCKER&gt;\n[INFO] DOCKER&gt; Commands:\n[INFO] DOCKER&gt;   attach      Attach local standard input, output, and error streams to a running container\n[INFO] DOCKER&gt;   commit      Create a new image from a container&#39;s changes\n[INFO] DOCKER&gt;   cp          Copy files/folders between a container and the local filesystem\n[INFO] DOCKER&gt;   create      Create a new container\n[INFO] DOCKER&gt;   diff        Inspect changes to files or directories on a container&#39;s filesystem\n[INFO] DOCKER&gt;   events      Get real time events from the server\n[INFO] DOCKER&gt;   export      Export a container&#39;s filesystem as a tar archive\n[INFO] DOCKER&gt;   history     Show the history of an image\n[INFO] DOCKER&gt;   import      Import the contents from a tarball to create a filesystem image\n[INFO] DOCKER&gt;   inspect     Return low-level information on Docker objects\n[INFO] DOCKER&gt;   kill        Kill one or more running containers\n[INFO] DOCKER&gt;   load        Load an image from a tar archive or STDIN\n[INFO] DOCKER&gt;   logs        Fetch the logs of a container\n[INFO] DOCKER&gt;   pause       Pause all processes within one or more containers\n[INFO] DOCKER&gt;   port        List port mappings or a specific mapping for the container\n[INFO] DOCKER&gt;   rename      Rename a container\n[INFO] DOCKER&gt;   restart     Restart one or more containers\n[INFO] DOCKER&gt;   rm          Remove one or more containers\n[INFO] DOCKER&gt;   rmi         Remove one or more images\n[INFO] DOCKER&gt;   save        Save one or more images to a tar archive (streamed to STDOUT by default)\n[ERROR] DOCKER&gt; Error status (125) when building\n[INFO] DOCKER&gt;   start       Start one or more stopped containers\n[INFO] DOCKER&gt;   stats       Display a live stream of container(s) resource usage statistics\n[INFO] DOCKER&gt;   stop        Stop one or more running containers\n[INFO] DOCKER&gt;   tag         Create a tag TARGET_IMAGE that refers to SOURCE_IMAGE\n[INFO] DOCKER&gt;   top         Display the running processes of a container\n[INFO] DOCKER&gt;   unpause     Unpause all processes within one or more containers\n[INFO] DOCKER&gt;   update      Update configuration of one or more containers\n[INFO] DOCKER&gt;   wait        Block until one or more containers stop, then print their exit codes\n[INFO] DOCKER&gt;\n[INFO] DOCKER&gt; Global Options:\n[INFO] DOCKER&gt;       --config string      Location of client config files (default\n[INFO] DOCKER&gt;                            &quot;/Users/PDurbin/.docker&quot;)\n[INFO] DOCKER&gt;   -c, --context string     Name of the context to use to connect to the\n[INFO] DOCKER&gt;                            daemon (overrides DOCKER_HOST env var and\n[INFO] DOCKER&gt;                            default context set with &quot;docker context use&quot;)\n[INFO] DOCKER&gt;   -D, --debug              Enable debug mode\n[INFO] DOCKER&gt;   -H, --host list          Daemon socket to connect to\n[INFO] DOCKER&gt;   -l, --log-level string   Set the logging level (&quot;debug&quot;, &quot;info&quot;,\n[INFO] DOCKER&gt;                            &quot;warn&quot;, &quot;error&quot;, &quot;fatal&quot;) (default &quot;info&quot;)\n[INFO] DOCKER&gt;       --tls                Use TLS; implied by --tlsverify\n[INFO] DOCKER&gt;       --tlscacert string   Trust certs signed only by this CA (default\n[INFO] DOCKER&gt;                            &quot;/Users/PDurbin/.docker/ca.pem&quot;)\n[INFO] DOCKER&gt;       --tlscert string     Path to TLS certificate file (default\n[INFO] DOCKER&gt;                            &quot;/Users/PDurbin/.docker/cert.pem&quot;)\n[INFO] DOCKER&gt;       --tlskey string      Path to TLS key file (default\n[INFO] DOCKER&gt;                            &quot;/Users/PDurbin/.docker/key.pem&quot;)\n[INFO] DOCKER&gt;       --tlsverify          Use TLS and verify the remote\n[INFO] DOCKER&gt;   -v, --version            Print version information and quit\n[INFO] DOCKER&gt;\n[INFO] DOCKER&gt; Run &#39;docker COMMAND --help&#39; for more information on a command.\n[INFO] DOCKER&gt;\n[INFO] DOCKER&gt; For more help on how to use Docker, head to https://docs.docker.com/go/guides/\n[INFO] DOCKER&gt;\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD FAILURE\n[INFO] ------------------------------------------------------------------------\n[INFO] Total time:  6.469 s\n[INFO] Finished at: 2025-02-10T16:15:20-05:00\n[INFO] ------------------------------------------------------------------------\n[ERROR] Failed to execute goal io.fabric8:docker-maven-plugin:0.45.0:build (default-build) on project container-base: Error status (125) when building -&gt; [Help 1]\n[ERROR]\n[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.\n[ERROR] Re-run Maven using the -X switch to enable full debug logging.\n[ERROR]\n[ERROR] For more information about the errors and possible solutions, please read the following articles:\n[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException\n</code></pre></div>",
        "id": 498864746,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1739222187
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>Client:\n Version:           27.4.0\n API version:       1.47\n Go version:        go1.22.10\n Git commit:        bde2b89\n Built:             Sat Dec  7 10:35:43 2024\n OS/Arch:           darwin/arm64\n Context:           desktop-linux\n\nServer: Docker Desktop 4.37.2 (179585)\n Engine:\n  Version:          27.4.0\n  API version:      1.47 (minimum version 1.24)\n  Go version:       go1.22.10\n  Git commit:       92a8393\n  Built:            Sat Dec  7 10:38:33 2024\n  OS/Arch:          linux/arm64\n  Experimental:     false\n containerd:\n  Version:          1.7.21\n  GitCommit:        472731909fa34bd7bc9c087e4c27943f9835f111\n runc:\n  Version:          1.1.13\n  GitCommit:        v1.1.13-0-g58aa920\n docker-init:\n  Version:          0.19.0\n  GitCommit:        de40ad0\n</code></pre></div>",
        "id": 498864798,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1739222203
    },
    {
        "content": "<p>We're using the docker maven plugin at <a href=\"https://github.com/IQSS/dataverse-hub\">https://github.com/IQSS/dataverse-hub</a> and <a href=\"https://github.com/IQSS/dataverse-marketplace\">https://github.com/IQSS/dataverse-marketplace</a> by the way.</p>",
        "id": 498865281,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1739222349
    },
    {
        "content": "<p>Bumping the version didn't help:</p>\n<div class=\"codehilite\"><pre><span></span><code>% git diff\ndiff --git a/modules/dataverse-parent/pom.xml b/modules/dataverse-parent/pom.xml\nindex 9612988b3e..a6266ecff0 100644\n--- a/modules/dataverse-parent/pom.xml\n+++ b/modules/dataverse-parent/pom.xml\n@@ -198,7 +198,7 @@\n         &lt;pomchecker-maven-plugin.version&gt;1.7.0&lt;/pomchecker-maven-plugin.version&gt;\n\n         &lt;!-- Container related --&gt;\n-        &lt;fabric8-dmp.version&gt;0.45.0&lt;/fabric8-dmp.version&gt;\n+        &lt;fabric8-dmp.version&gt;0.45.1&lt;/fabric8-dmp.version&gt;\n     &lt;/properties&gt;\n</code></pre></div>",
        "id": 498867223,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1739222936
    },
    {
        "content": "<p>Wait, wait, wait, maybe I fixed it with this:</p>\n<div class=\"codehilite\"><pre><span></span><code>cd modules/container-base\nmvn clean\n</code></pre></div>",
        "id": 498869130,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1739223567
    },
    {
        "content": "<p>Yeah. Works now. I even re-upgraded to the latest version of Docker.</p>",
        "id": 498870365,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1739223996
    },
    {
        "content": "<p>Sounds like there was a stale Docker config sticking around. Not sure if it might be worth not caching it. Or adding an FAQ in case of any errors first do a mvn clean and try again.</p>",
        "id": 498884275,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1739229215
    },
    {
        "content": "<p>Yeah, I might tweak our docs.</p>",
        "id": 498912503,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1739241220
    }
]