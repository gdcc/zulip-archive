[
    {
        "content": "<p><a href=\"https://github.com/IQSS/dataverse/pull/7369/files#diff-7093017fea2f3f26783632496b1b41ab0399b0c9d2c774225b66db77c5a78253\">https://github.com/IQSS/dataverse/pull/7369/files#diff-7093017fea2f3f26783632496b1b41ab0399b0c9d2c774225b66db77c5a78253</a> is a good example why we need integration testing for our migrations. It relies on havin the externaltooltype table around, but this only gets created by a new deployment, not when you run the migrations manually via flyway. Which is bad obviously, as it's not easy to change...</p>",
        "id": 448841700,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1720011329
    },
    {
        "content": "<p>(Which I am doing right now with my 4.20 DB, applying the migrations on just a database, without a deployment.)</p>",
        "id": 448842786,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1720011622
    },
    {
        "content": "<p>So as a workaround are you creating the <code>externaltooltype</code> table manually?</p>",
        "id": 448846139,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1720012359
    },
    {
        "content": "<p>I will try that. Have to be extra careful, because I need to name the constraints, indices and foreign keys all the same</p>",
        "id": 448853079,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1720014020
    },
    {
        "content": "<p>I'm also thinking about ingesting an extra migration just for us</p>",
        "id": 448853266,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1720014074
    },
    {
        "content": "<p>I need some stuff like that anyway as I need to migrate our custom licenses and special field type to something else anyway</p>",
        "id": 448853621,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1720014151
    },
    {
        "content": "<p>Haha V5.4.1.1 fails as well because in v5.5 (where this migration was added) the auxiliaryfiles table was added. Gosh we really need to fix this. I will try to investigate in creating a new baseline...</p>",
        "id": 448861509,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1720016128
    },
    {
        "content": "<p>(BTW V5.4.1.1  could have just used an additional \"IF EXISTS\" for the table to mitigate this problem)</p>",
        "id": 448861749,
        "sender_full_name": "Oliver Bertuch",
        "timestamp": 1720016187
    },
    {
        "content": "<p>Oh, right. Yes, I think we eventually got better about adding <code>IF EXISTS</code>. <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 448867379,
        "sender_full_name": "Philip Durbin ðŸš€",
        "timestamp": 1720017381
    }
]