<html>
<head><meta charset="utf-8"><title>update-fields.sh · containers · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://gdcc.github.io/zulip-archive/stream/375812-containers/index.html">containers</a></h2>
<h3>Topic: <a href="https://gdcc.github.io/zulip-archive/stream/375812-containers/topic/update-fields.2Esh.html">update-fields.sh</a></h3>

<hr>

<base href="https://dataverse.zulipchat.com">

<head><link href="https://gdcc.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="481121641"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/375812-containers/topic/update-fields.sh/near/481121641" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin 🚀 <a href="https://gdcc.github.io/zulip-archive/stream/375812-containers/topic/update-fields.2Esh.html#481121641">(Nov 07 2024 at 13:34)</a>:</h4>
<p>Do we already run <a href="http://update-fields.sh">update-fields.sh</a> in the dev persona? As far as I can tell, we don't. We rely on the fact that schema.xml already has all the fields for the 6 metadata blocks we ship.</p>
<p>I'm asking because I'm thinking about loading the CodeMeta block in the "dev" persona. But it looks like I'll need to call <a href="http://update-fields.sh">update-fields.sh</a> afterwards.</p>



<a name="481122928"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/375812-containers/topic/update-fields.sh/near/481122928" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin 🚀 <a href="https://gdcc.github.io/zulip-archive/stream/375812-containers/topic/update-fields.2Esh.html#481122928">(Nov 07 2024 at 13:41)</a>:</h4>
<p>We already had a draft issue for this so I just converted it into a real one:</p>
<p>document updating metadata block (tsv) and Solr in Dockerized dev env <a href="https://github.com/IQSS/dataverse/issues/11004">#11004</a></p>



<a name="481124606"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/375812-containers/topic/update-fields.sh/near/481124606" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin 🚀 <a href="https://gdcc.github.io/zulip-archive/stream/375812-containers/topic/update-fields.2Esh.html#481124606">(Nov 07 2024 at 13:50)</a>:</h4>
<p>It looks like <span class="user-mention" data-user-id="649905">@luddaniel</span> talked about this back in April: <a href="https://docs.google.com/document/d/1toiFxJKGvrYMy9KrW9GZ4U6FLGhMaCipJ9ggtvZFwgc/edit?usp=sharing">https://docs.google.com/document/d/1toiFxJKGvrYMy9KrW9GZ4U6FLGhMaCipJ9ggtvZFwgc/edit?usp=sharing</a></p>
<p><a href="/user_uploads/53090/8hh_ashaM4Rp8oi8SRoZqQv4/Screenshot-2024-11-07-at-8.47.33AM.png">Screenshot 2024-11-07 at 8.47.33 AM.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/53090/8hh_ashaM4Rp8oi8SRoZqQv4/Screenshot-2024-11-07-at-8.47.33AM.png" title="Screenshot 2024-11-07 at 8.47.33 AM.png"><img data-original-dimensions="2560x1440" src="/user_uploads/thumbnail/53090/8hh_ashaM4Rp8oi8SRoZqQv4/Screenshot-2024-11-07-at-8.47.33AM.png/840x560.webp"></a></div>



<a name="481124713"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/375812-containers/topic/update-fields.sh/near/481124713" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin 🚀 <a href="https://gdcc.github.io/zulip-archive/stream/375812-containers/topic/update-fields.2Esh.html#481124713">(Nov 07 2024 at 13:51)</a>:</h4>
<p>My use case it to enable the CodeMeta metadata block for testing in <a href="https://github.com/IQSS/dataverse/issues/11001">#11001</a>.</p>



<a name="481125924"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/375812-containers/topic/update-fields.sh/near/481125924" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin 🚀 <a href="https://gdcc.github.io/zulip-archive/stream/375812-containers/topic/update-fields.2Esh.html#481125924">(Nov 07 2024 at 13:56)</a>:</h4>
<p>Ah, the script is over at <a class="stream-topic" data-stream-id="379673" href="/#narrow/channel/379673-dev/topic/Run.20dataverse-external-vocab-support.20demo.20under.20docker">#dev &gt; Run dataverse-external-vocab-support demo under docker</a> (loading <code>cvocdemo.tsv</code>)</p>



<a name="481132303"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/375812-containers/topic/update-fields.sh/near/481132303" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> luddaniel <a href="https://gdcc.github.io/zulip-archive/stream/375812-containers/topic/update-fields.2Esh.html#481132303">(Nov 07 2024 at 14:27)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="598112">@Philip Durbin 🐉</span>, as we have our own customized .tsv (like citation, I know bad practice) we regularly have the need to run the <a href="http://update-fields.sh">update-fields.sh</a> script while testing/developing. For CVOC as an example.</p>



<a name="481132584"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/375812-containers/topic/update-fields.sh/near/481132584" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> luddaniel <a href="https://gdcc.github.io/zulip-archive/stream/375812-containers/topic/update-fields.2Esh.html#481132584">(Nov 07 2024 at 14:28)</a>:</h4>
<p><span class="user-mention silent" data-user-id="598112">Philip Durbin 🐉</span> <a href="#narrow/channel/375812-containers/topic/update-fields.2Esh/near/481125924">said</a>:</p>
<blockquote>
<p>Ah, the script is over at <a class="stream-topic" data-stream-id="379673" href="/#narrow/channel/379673-dev/topic/Run.20dataverse-external-vocab-support.20demo.20under.20docker">#dev &gt; Run dataverse-external-vocab-support demo under docker</a> (loading <code>cvocdemo.tsv</code>)</p>
</blockquote>
<p>I still run parts of that procedure.</p>



<a name="481134936"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/375812-containers/topic/update-fields.sh/near/481134936" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin 🚀 <a href="https://gdcc.github.io/zulip-archive/stream/375812-containers/topic/update-fields.2Esh.html#481134936">(Nov 07 2024 at 14:39)</a>:</h4>
<p>Right. I remember. And I even went back and watched part of the recording from April. <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="481136277"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/375812-containers/topic/update-fields.sh/near/481136277" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin 🚀 <a href="https://gdcc.github.io/zulip-archive/stream/375812-containers/topic/update-fields.2Esh.html#481136277">(Nov 07 2024 at 14:46)</a>:</h4>
<p>I have configbaker saving schema.xml into /shared</p>
<p>But now I need to run <a href="http://update-fields.sh">update-fields.sh</a> somehow.</p>



<a name="481136496"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/375812-containers/topic/update-fields.sh/near/481136496" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin 🚀 <a href="https://gdcc.github.io/zulip-archive/stream/375812-containers/topic/update-fields.2Esh.html#481136496">(Nov 07 2024 at 14:47)</a>:</h4>
<p>Maybe I'm thinking about this wrong but I was hoping I could run a container after configbaker/bootstrap runs like this:</p>



<a name="481136507"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/375812-containers/topic/update-fields.sh/near/481136507" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin 🚀 <a href="https://gdcc.github.io/zulip-archive/stream/375812-containers/topic/update-fields.2Esh.html#481136507">(Nov 07 2024 at 14:47)</a>:</h4>
<div class="codehilite"><pre><span></span><code>  dev_solr_finisher:
    container_name: &quot;dev_solr_finisher&quot;
    image: gdcc/configbaker:unstable
    depends_on:
      - dev_bootstrap
    restart: &quot;no&quot;
    command:
      - sh
      - -c
      - &quot;cat /shared/schema.xml&quot;
    volumes:
      - ./docker-dev-volumes/solr/data:/var/solr
      - ./docker-dev-volumes/solr/conf:/solr-template
      - ./docker-dev-volumes/shared:/shared
</code></pre></div>



<a name="481136678"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/375812-containers/topic/update-fields.sh/near/481136678" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin 🚀 <a href="https://gdcc.github.io/zulip-archive/stream/375812-containers/topic/update-fields.2Esh.html#481136678">(Nov 07 2024 at 14:48)</a>:</h4>
<p>But this new "dev_solr_finisher" container doesn't wait for "dev_bootstrap". It runs right away and can't find /shared/schema.xml <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="481139303"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/375812-containers/topic/update-fields.sh/near/481139303" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> luddaniel <a href="https://gdcc.github.io/zulip-archive/stream/375812-containers/topic/update-fields.2Esh.html#481139303">(Nov 07 2024 at 15:00)</a>:</h4>
<p>I think <span class="user-mention" data-user-id="598183">@Oliver Bertuch</span> will have the correct idea.<br>
In my mind I'm thinking about a "toolbox ready to be use", you give one .tsv and it updates everything. As you did for <a href="https://dataverse-guide--10940.org.readthedocs.build/en/10940/container/running/demo.html#multiple-languages">https://dataverse-guide--10940.org.readthedocs.build/en/10940/container/running/demo.html#multiple-languages</a><br>
<span class="user-mention" data-user-id="651106">@Jérôme Roucou</span> I don't reminber, but you might have a .sh for this.</p>



<a name="481139772"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/375812-containers/topic/update-fields.sh/near/481139772" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin 🚀 <a href="https://gdcc.github.io/zulip-archive/stream/375812-containers/topic/update-fields.2Esh.html#481139772">(Nov 07 2024 at 15:02)</a>:</h4>
<p>I was hoping this would work but it doesn't:</p>
<div class="codehilite"><pre><span></span><code>    depends_on:
      dev_bootstrap:
        condition: service_completed_successfully
</code></pre></div>



<a name="481139879"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/375812-containers/topic/update-fields.sh/near/481139879" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin 🚀 <a href="https://gdcc.github.io/zulip-archive/stream/375812-containers/topic/update-fields.2Esh.html#481139879">(Nov 07 2024 at 15:03)</a>:</h4>
<p>I end up with <code>[**ERROR**] DOCKER&gt; [gdcc/configbaker:unstable] "dev_bootstrap": Timeout after 10267 ms while waiting on exit code 0</code></p>



<a name="481139998"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/375812-containers/topic/update-fields.sh/near/481139998" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> luddaniel <a href="https://gdcc.github.io/zulip-archive/stream/375812-containers/topic/update-fields.2Esh.html#481139998">(Nov 07 2024 at 15:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="598112">Philip Durbin 🐉</span> <a href="#narrow/channel/375812-containers/topic/update-fields.2Esh/near/481139772">said</a>:</p>
<blockquote>
<p>I was hoping this would work but it doesn't:</p>
<p><div class="codehilite"><pre><span></span><code>    depends_on:
      dev_bootstrap:
        condition: service_completed_successfully
</code></pre></div><br>
</p>
</blockquote>
<p>There is a something that wait for <a href="http://localhost:8080">http://localhost:8080</a> to be started maybe you use the same idea.</p>



<a name="481141778"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/375812-containers/topic/update-fields.sh/near/481141778" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin 🚀 <a href="https://gdcc.github.io/zulip-archive/stream/375812-containers/topic/update-fields.2Esh.html#481141778">(Nov 07 2024 at 15:12)</a>:</h4>
<p><code>condition: service_completed_successfully</code> works fine here: <a href="https://github.com/IQSS/dataverse-frontend/pull/180/files">https://github.com/IQSS/dataverse-frontend/pull/180/files</a></p>



<a name="481144925"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/375812-containers/topic/update-fields.sh/near/481144925" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin 🚀 <a href="https://gdcc.github.io/zulip-archive/stream/375812-containers/topic/update-fields.2Esh.html#481144925">(Nov 07 2024 at 15:28)</a>:</h4>
<p>Waiting 3 minutes like this is dumb but it works and unblocks me <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> </p>
<p><code>sleep 180 &amp;&amp; cat /shared/schema.xml</code></p>



<a name="481201039"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/375812-containers/topic/update-fields.sh/near/481201039" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin 🚀 <a href="https://gdcc.github.io/zulip-archive/stream/375812-containers/topic/update-fields.2Esh.html#481201039">(Nov 07 2024 at 21:12)</a>:</h4>
<p>Nice, I got something hacky working:</p>
<p><code>dev_solr_finisher&gt;     &lt;copyField source="codeVersion" dest="_text_" maxChars="3000"/&gt;</code></p>



<a name="481381416"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/375812-containers/topic/update-fields.sh/near/481381416" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin 🚀 <a href="https://gdcc.github.io/zulip-archive/stream/375812-containers/topic/update-fields.2Esh.html#481381416">(Nov 08 2024 at 20:24)</a>:</h4>
<p>Ok, I got a proper solution working. I'm happy for feedback though: <a href="https://github.com/IQSS/dataverse/pull/11001/commits/5afad8e6ac390461d42603f56efa583e70d87421">https://github.com/IQSS/dataverse/pull/11001/commits/5afad8e6ac390461d42603f56efa583e70d87421</a></p>



<hr><p>Last updated: Nov 01 2025 at 23:12 UTC</p>
</html>