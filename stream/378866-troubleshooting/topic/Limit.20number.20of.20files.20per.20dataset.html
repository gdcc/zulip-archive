<html>
<head><meta charset="utf-8"><title>Limit number of files per dataset Â· troubleshooting Â· Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/index.html">troubleshooting</a></h2>
<h3>Topic: <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Limit.20number.20of.20files.20per.20dataset.html">Limit number of files per dataset</a></h3>

<hr>

<base href="https://dataverse.zulipchat.com">

<head><link href="https://gdcc.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="508553116"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Limit%20number%20of%20files%20per%20dataset/near/508553116" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Markus HaarlÃ¤nder <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Limit.20number.20of.20files.20per.20dataset.html#508553116">(Mar 27 2025 at 15:40)</a>:</h4>
<p>Hi @all,<br>
We recently had a user who uploaded more than 35.000 files into one dataset on our Dataverse (6.5) instance. Subsequently, not only the dataset, but the whole system became unstable and unusable for most of the time. Deleting the dataset via API or UI did not work anymore, we had to remove the files from the different database tables to get back a running system.<br>
I know that Dataverse does not get along well with such a large number of files, so I was looking for a configuration setting that allows to limit the number of files per dataset. Couldn't find one, and I also could not find any related issues on GitHub. I know that <span class="user-mention" data-user-id="614964">@Eryk Kulikowski</span> worked on performance improvements some time ago regarding large number of files, and I have in mind that it worked better for some time, but it seems the improvements are gone in v6.5?<br>
So we would be interested how other instances handle such issues? Is there some kind of configuration option I just can't find? Wouldn't it make sense to have such an option, so a user cannot bring the whole system to a halt by just uploading too many files?</p>



<a name="508555003"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Limit%20number%20of%20files%20per%20dataset/near/508555003" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Limit.20number.20of.20files.20per.20dataset.html#508555003">(Mar 27 2025 at 15:47)</a>:</h4>
<p>The issue is less than a month old: Feature Request: (internal request) Add quota-like limit on the number of files in a datasetÂ <a href="https://github.com/IQSS/dataverse/issues/11275">#11275</a></p>



<a name="508555037"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Limit%20number%20of%20files%20per%20dataset/near/508555037" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Limit.20number.20of.20files.20per.20dataset.html#508555037">(Mar 27 2025 at 15:47)</a>:</h4>
<p>But we've talked about it off and on for years. <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="508555257"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Limit%20number%20of%20files%20per%20dataset/near/508555257" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Limit.20number.20of.20files.20per.20dataset.html#508555257">(Mar 27 2025 at 15:48)</a>:</h4>
<p>It completely makes sense that users should not be able to bring the system to a halt by uploading too many files!</p>



<a name="508555408"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Limit%20number%20of%20files%20per%20dataset/near/508555408" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Limit.20number.20of.20files.20per.20dataset.html#508555408">(Mar 27 2025 at 15:48)</a>:</h4>
<p>We do have a rate limiting feature: <a href="https://guides.dataverse.org/en/6.5/installation/config.html#rate-limiting">https://guides.dataverse.org/en/6.5/installation/config.html#rate-limiting</a></p>



<a name="508555484"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Limit%20number%20of%20files%20per%20dataset/near/508555484" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Limit.20number.20of.20files.20per.20dataset.html#508555484">(Mar 27 2025 at 15:49)</a>:</h4>
<p>But I'm wondering if there's a command you can target. <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="508555656"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Limit%20number%20of%20files%20per%20dataset/near/508555656" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Limit.20number.20of.20files.20per.20dataset.html#508555656">(Mar 27 2025 at 15:49)</a>:</h4>
<p>When lots of upload are happening, do you see a lot of the same command in the actionlogrecord table? <a href="https://guides.dataverse.org/en/6.5/admin/monitoring.html#actionlogrecord">https://guides.dataverse.org/en/6.5/admin/monitoring.html#actionlogrecord</a></p>



<a name="508558935"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Limit%20number%20of%20files%20per%20dataset/near/508558935" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Markus HaarlÃ¤nder <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Limit.20number.20of.20files.20per.20dataset.html#508558935">(Mar 27 2025 at 16:02)</a>:</h4>
<p>Thanks Phil.<br>
There's the "CreateNewDataFilesCommand" in the actionlogrecord, but not sure if rate limiting is the right way to go here. <br>
But glad to hear that the discussion about this is alive. We'll also have to discuss internally, if such a feature will be available, what numbers would make sense. An instance-wide config option would be sufficient for us. I'm currently quite busy with another project, but when I find the time I'll try to understand the current implementation of the collection quotas and maybe get some ideas out of it for such a file limit configuration.</p>



<a name="508559832"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Limit%20number%20of%20files%20per%20dataset/near/508559832" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Limit.20number.20of.20files.20per.20dataset.html#508559832">(Mar 27 2025 at 16:05)</a>:</h4>
<p>Sounds good!</p>



<a name="508567405"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Limit%20number%20of%20files%20per%20dataset/near/508567405" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sherry Lake <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Limit.20number.20of.20files.20per.20dataset.html#508567405">(Mar 27 2025 at 16:33)</a>:</h4>
<p><span class="user-mention" data-user-id="652521">@Markus HaarlÃ¤nder</span> <br>
Can you say more about what tables you edited to remove the files? We at University of Virginia have such a dataset that I can't delete (over 14,000 files). See my ask in the google group: <a href="https://groups.google.com/g/dataverse-community/c/WFf34d8R0Aw">https://groups.google.com/g/dataverse-community/c/WFf34d8R0Aw</a></p>
<p>You can either reply here or send email to <a href="mailto:shlake@virginia.edu">shlake@virginia.edu</a></p>



<a name="508580434"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Limit%20number%20of%20files%20per%20dataset/near/508580434" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Markus HaarlÃ¤nder <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Limit.20number.20of.20files.20per.20dataset.html#508580434">(Mar 27 2025 at 17:30)</a>:</h4>
<p>Hi Sherry<br>
Here's a (not very sophisticated) SQL script which I used. Not 100% sure if everything was removed, but it worked for us. The files didn't have any tags or restrictions. If they do, maybe other tables have to be cleaned, too.</p>
<div class="codehilite" data-code-language="SQL"><pre><span></span><code><span class="k">UPDATE</span><span class="w"> </span><span class="n">dataset</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">thumbnailfile_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'&lt;dataset-id&gt;'</span><span class="p">;</span>

<span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">filemetadata</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">datafile_id</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">dvobject</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">owner_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'&lt;dataset-id&gt;'</span><span class="p">);</span>

<span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">datafile</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">dvobject</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">owner_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'&lt;dataset-id&gt;'</span><span class="p">);</span>

<span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">dvobject</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">owner_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'&lt;dataset-id&gt;'</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">dtype</span><span class="o">=</span><span class="s1">'DataFile'</span><span class="p">;</span>
</code></pre></div>



<hr><p>Last updated: Nov 01 2025 at 23:12 UTC</p>
</html>