<html>
<head><meta charset="utf-8"><title>Upgrading 5.14 to 6.2 Â· troubleshooting Â· Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/index.html">troubleshooting</a></h2>
<h3>Topic: <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html">Upgrading 5.14 to 6.2</a></h3>

<hr>

<base href="https://dataverse.zulipchat.com">

<head><link href="https://gdcc.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="442829526"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/442829526" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Florez <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#442829526">(Jun 05 2024 at 16:08)</a>:</h4>
<p>Hello everyone, how are you?</p>
<p>I have been trying to upgrade my Dataverse installation, from 5.14 to 6.2, but I have had a problem deploying the dataverse war file. The problem is with postgres.</p>
<p>I have created a new database, but the problem continues. There is an image showing the problem.</p>
<p><a href="/user_uploads/53090/19kPYEoBWfdEVkYd92TzLY53/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/53090/19kPYEoBWfdEVkYd92TzLY53/image.png" title="image.png"><img src="/user_uploads/53090/19kPYEoBWfdEVkYd92TzLY53/image.png"></a></div><p>Does anyone know what I should do?</p>



<a name="442831830"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/442831830" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Florez <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#442831830">(Jun 05 2024 at 16:16)</a>:</h4>
<p>I downloaded the war file from <a href="https://github.com/IQSS/dataverse/releases/tag/v6.2">https://github.com/IQSS/dataverse/releases/tag/v6.2</a></p>
<p><a href="/user_uploads/53090/HefY3dlWlzQVr3IIqD-7lyyG/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/53090/HefY3dlWlzQVr3IIqD-7lyyG/image.png" title="image.png"><img src="/user_uploads/53090/HefY3dlWlzQVr3IIqD-7lyyG/image.png"></a></div>



<a name="442857716"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/442857716" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#442857716">(Jun 05 2024 at 18:07)</a>:</h4>
<p>Hi! First, you have to upgrade to 6.0, then 6.1, then 6.2.</p>
<p>Second, can you please show us server.log?</p>



<a name="442859702"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/442859702" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Florez <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#442859702">(Jun 05 2024 at 18:17)</a>:</h4>
<p><span class="user-mention" data-user-id="598112">@Philip Durbin</span> thanks for answer, so, I'm gonna upgrade version by version.</p>
<p>This is the log file.<br>
<a href="/user_uploads/53090/oB0sgSlit_wlIBBJMuqpUmvi/Error_Dataverse6.2.txt">Error_Dataverse6.2.txt</a></p>



<a name="442860569"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/442860569" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Florez <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#442860569">(Jun 05 2024 at 18:22)</a>:</h4>
<p>I don't understand why I have this postgres error</p>



<a name="442861734"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/442861734" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#442861734">(Jun 05 2024 at 18:29)</a>:</h4>
<p>Did you do this step from <a href="https://github.com/IQSS/dataverse/releases/tag/v6.0">https://github.com/IQSS/dataverse/releases/tag/v6.0</a> ?</p>
<p><code>sudo -u dataverse /usr/local/payara6/bin/asadmin create-jvm-options --add-opens=java.base/java.io=ALL-UNNAMED</code></p>
<p>I'm asking because in your log I see <code>module java.base does not "opens java.io" to unnamed module</code> and I'm reminded of <a href="https://github.com/IQSS/dataverse/issues/10068">#10068</a>.</p>



<a name="443098731"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/443098731" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Florez <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#443098731">(Jun 06 2024 at 15:59)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="598112">@Philip Durbin</span> I have decided to install the new dataverse version from scratch. Thank goodness I didn't have any information loaded yet.</p>



<a name="443124772"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/443124772" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#443124772">(Jun 06 2024 at 18:00)</a>:</h4>
<p>Sounds easier!</p>



<a name="443284740"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/443284740" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sherry Lake <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#443284740">(Jun 07 2024 at 12:09)</a>:</h4>
<p>I noticed Harvard is at 6.2, but this version: v. 6.2 build "v6.2+10451+10463+10383-iqss"</p>
<p>Any special reason why this not "the" 6.2 release? </p>
<p>UVa is upgrading from 5.14 to 6.2 next week and am wondering about running into problems. There seem to be a few folks have encountered (from the Dataverse google group and here on Zulip).</p>



<a name="443298049"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/443298049" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#443298049">(Jun 07 2024 at 13:25)</a>:</h4>
<p>As you might guess, <a href="https://github.com/IQSS/dataverse/issues/10451">#10451</a> <a href="https://github.com/IQSS/dataverse/issues/10463">#10463</a> and <a href="https://github.com/IQSS/dataverse/issues/10383">#10383</a> are all pull requests:</p>
<ul>
<li>IQSS/10450 - Fixes for Globus download (transfer out) and related info messages <a href="https://github.com/IQSS/dataverse/issues/10451">#10451</a></li>
<li>IQSS/10462 - Fix when MDC is displayed <a href="https://github.com/IQSS/dataverse/issues/10463">#10463</a></li>
<li>Resolve performance issues with large datasets <a href="https://github.com/IQSS/dataverse/issues/10383">#10383</a></li>
</ul>
<p>I guess these are all fixes we needed for Harvard Dataverse. They will all be included in 6.3.</p>



<a name="444356938"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444356938" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444356938">(Jun 13 2024 at 00:44)</a>:</h4>
<p>I'm finally able to list buckets via aws cli.  Â The production bucket policy doesn't have an explicate line for listing the bucket and doesn't seem to need it.Â  But I aded the explict list ("Action": "s3:ListBucket",) to dataverse-test-oregon and suddenly I could list it with aws cli.<br>
I'm not sure what the difference is but will do this for the new production system.   <br>
Back to  shibboleth and doi setup correctly in domain.xml.</p>



<a name="444519506"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444519506" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444519506">(Jun 13 2024 at 17:24)</a>:</h4>
<p>s3 bucket issues.   The production bucket policy (RHEL 7) doesn't have an explicate line for listing the bucket and doesn't seem to need it.Â  But I aded the explict list ("Action": "s3:ListBucket",) to dataverse-test-oregon and suddenly I could list it with aws cli.  I don't know if this is a difference between the 5.14 and 6.2 but I'm going to follow this example for the production 6.2.</p>



<a name="444520651"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444520651" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444520651">(Jun 13 2024 at 17:28)</a>:</h4>
<p>Hmm, it this something we should fix in our guides?</p>



<a name="444521481"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444521481" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444521481">(Jun 13 2024 at 17:33)</a>:</h4>
<p>I haven't installed a clean system since 4.11 or there about.  It seems that what worked up to 5.14 is different in 6.2.   Bit of a jump between versions so I may have missed something.    Examples for the pid/doi settings might be helpful.  I'll post mine when I get through this install.</p>



<a name="444521915"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444521915" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444521915">(Jun 13 2024 at 17:35)</a>:</h4>
<p>Sorry,  I just realized I posted in the wrong place.  I'm limping through 5.14 to 6.2</p>



<a name="444522087"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444522087" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444522087">(Jun 13 2024 at 17:36)</a>:</h4>
<p>My new errors are actually helpful.   Things I need to correct in domain.xml.     <br>
[#|2024-06-11T02:46:25.683+0000|WARNING|Payara 6.2023.8|edu.harvard.iq.dataverse.ThumbnailServiceWrapper|_ThreadID=90;_ThreadName=http-thread-pool::jk-connector(4);_TimeMillis=1718073985683;_LevelValue=900;|<br>
  getDatasetCardImageAsUrl(): Failed to initialize dataset StorageIO for s3://10.5072/FK2/QF48PD (getDataAccessObject: Unsupported storage method.)|#]</p>
<p>[#|2024-06-11T02:46:25.688+0000|WARNING|Payara 6.2023.8|edu.harvard.iq.dataverse.dataaccess.DataAccess|_ThreadID=90;_ThreadName=http-thread-pool::jk-connector(4);_TimeMillis=1718073985688;_LevelValue=900;|<br>
  Could not find storage driver for: s3|#]</p>
<p>[#|2024-06-11T02:46:25.688+0000|WARNING|Payara 6.2023.8|edu.harvard.iq.dataverse.ThumbnailServiceWrapper|_ThreadID=90;_ThreadName=http-thread-pool::jk-connector(4);_TimeMillis=1718073985688;_LevelValue=900;|<br>
  getDatasetCardImageAsUrl(): Failed to initialize dataset StorageIO for s3://10.5072/FK2/MN0MUZ (getDataAccessObject: Unsupported storage method.)|#]</p>
<p>[#|2024-06-11T02:46:25.693+0000|WARNING|Payara 6.2023.8|edu.harvard.iq.dataverse.dataaccess.DataAccess|_ThreadID=90;_ThreadName=http-thread-pool::jk-connector(4);_TimeMillis=1718073985693;_LevelValue=900;|<br>
  Could not find storage driver for: s3|#]</p>
<p>[#|2024-06-11T02:46:25.693+0000|WARNING|Payara 6.2023.8|edu.harvard.iq.dataverse.ThumbnailServiceWrapper|_ThreadID=90;_ThreadName=http-thread-pool::jk-connector(4);_TimeMillis=1718073985693;_LevelValue=900;|<br>
  getDatasetCardImageAsUrl(): Failed to initialize dataset StorageIO for s3://10.5072/FK2/KHOWY6 (getDataAccessObject: Ulogs/server.log</p>



<a name="444523073"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444523073" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444523073">(Jun 13 2024 at 17:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="653479">jamie jamison</span> <a href="#narrow/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2/near/444521915">said</a>:</p>
<blockquote>
<p>Sorry,  I just realized I posted in the wrong place.  I'm limping through 5.14 to 6.2</p>
</blockquote>
<p>No worries, I moved the messages.</p>



<a name="444524173"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444524173" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444524173">(Jun 13 2024 at 17:48)</a>:</h4>
<p>I'm not sure what some of the domain.xml settings should be so I'm working it out via trail and error.</p>



<a name="444526907"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444526907" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444526907">(Jun 13 2024 at 18:03)</a>:</h4>
<p>documentation question (<a href="https://guides.dataverse.org/en/latest/installation/config.html#second-configure-your-dataverse-installation-to-use-s3-storage">https://guides.dataverse.org/en/latest/installation/config.html#second-configure-your-dataverse-installation-to-use-s3-storage</a>): <br>
example: dataverse.files.storage-driver-id  &lt;id&gt;   Enable &lt;id&gt; as the defaultÂ storageÂ driver.  <code>file</code> (&lt;- default)<br>
Since all my storage is in s3 buckets, should this be:  Ddataverse.files.storage-driver-id=s3</p>



<a name="444527133"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444527133" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444527133">(Jun 13 2024 at 18:04)</a>:</h4>
<p>As long as your id is "s3", yes. If your id is "foobar" it should be "foobar".</p>



<a name="444528444"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444528444" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444528444">(Jun 13 2024 at 18:11)</a>:</h4>
<p>I'm trying to track down storage errors:</p>
<p>[#|2024-06-11T02:46:25.683+0000|WARNING|Payara 6.2023.8|edu.harvard.iq.dataverse.ThumbnailServiceWrapper|_ThreadID=90;_ThreadName=http-thread-pool::jk-connector(4);_TimeMillis=1718073985683;_LevelValue=900;|<br>
  getDatasetCardImageAsUrl(): Failed to initialize dataset StorageIO for s3://10.5072/FK2/QF48PD (getDataAccessObject: Unsupported storage method.)|#]</p>
<p>[#|2024-06-11T02:46:25.688+0000|WARNING|Payara 6.2023.8|edu.harvard.iq.dataverse.dataaccess.DataAccess|_ThreadID=90;_ThreadName=http-thread-pool::jk-connector(4);_TimeMillis=1718073985688;_LevelValue=900;|<br>
  Could not find storage driver for: s3|#]</p>



<a name="444531015"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444531015" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444531015">(Jun 13 2024 at 18:20)</a>:</h4>
<p><span class="user-mention" data-user-id="598112">@Philip Durbin</span>  <span class="user-mention" data-user-id="653479">@jamie jamison</span> Dataverse doesn't need <code>listBucket</code> but the CLI does, if you want to pull a listing.</p>



<a name="444531561"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444531561" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444531561">(Jun 13 2024 at 18:23)</a>:</h4>
<p>Perhaps inaccurately I was using aws cli to check if the buckets were accessable.  <br>
Right now I'm stuck at the point where payara6 is running but dataverse pages aren't loading.</p>



<a name="444575647"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444575647" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444575647">(Jun 13 2024 at 22:35)</a>:</h4>
<p>I managed to break the test system to the point it no longer loads.  Since I thought it was  idempotent I tried running the ansible script again.   I stopped and disabled payara6, ran the script and got this message: <br>
ASK [dataverse : fire off installer] <strong>*</strong><strong>*</strong><strong>*</strong><strong>*</strong><strong>*</strong><strong>*</strong><strong>*</strong><strong>*</strong><strong>*</strong><strong>*</strong><strong>*</strong><strong>*</strong><strong>*</strong><strong>*</strong><strong>*</strong><strong>*</strong><strong>*</strong><strong>*</strong><strong>*</strong><strong>*</strong><strong>*</strong><strong>*</strong><br>
fatal: [localhost]: FAILED! =&gt; {"changed": true, "cmd": "/usr/bin/python3 /tmp/dvinstall/install.py -f --config_file=default.config --noninteractive &gt; /tmp/dvinstall/install.out 2&gt;&amp;1", "delta": "0:01:26.506903", "end": "2024-06-13 22:32:09.208629", "msg": "non-zero return code", "rc": 1, "start": "2024-06-13 22:30:42.701726", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}</p>
<p>So I realize now it's not idempotent.   I can rebuild from scratch if necessary, had some practice.   But I'm wondering if dropping the dataverse database table would help?</p>



<a name="444585209"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444585209" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444585209">(Jun 14 2024 at 00:13)</a>:</h4>
<p>To rerun the ansible script: 1) stop and disable payara6, 2) drop (and probably dump) the dvndb, 3) probably doesn't hurt to delete the domain.xml file and then rerun the ansible script.</p>



<a name="444592752"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444592752" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444592752">(Jun 14 2024 at 01:42)</a>:</h4>
<p>Go go go!</p>



<a name="444610939"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444610939" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444610939">(Jun 14 2024 at 04:28)</a>:</h4>
<p>Well that was fun while it lasted.Â  Now can't start or restart payara6</p>



<a name="444763755"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444763755" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444763755">(Jun 14 2024 at 18:27)</a>:</h4>
<p>Anyone out there with postgres experience?<br>
I was able to reload the dvndb database but I have to set (or reset) the privlidges.  I 'm trying to figure out what  '=Tc/postgres postgres=CTc/postgres dvnuser=CTc/postgres ' so I can add that to dvndb.</p>



<a name="444764138"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444764138" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444764138">(Jun 14 2024 at 18:30)</a>:</h4>
<p><code>=Tc/postgres</code>? Where are you seeing that?</p>



<a name="444764252"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444764252" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444764252">(Jun 14 2024 at 18:30)</a>:</h4>
<p>I log into postgres and display the tables<br>
dvndb      | postgres | UTF8     | C.UTF-8 | C.UTF-8 |<br>
 dvndb_bkup | postgres | UTF8     | C.UTF-8 | C.UTF-8 | =Tc/postgres         +<br>
            |          |          |         |         | postgres=CTc/postgres+<br>
            |          |          |         |         | dvnuser=CTc/postgres<br>
 dvndp      | postgres | UTF8     | C.UTF-8 | C.UTF-8 |<br>
 postgres   | postgres | UTF8     | C.UTF-8 | C.UTF-8 |<br>
 template0  | postgres | UTF8     | C.UTF-8 | C.UTF-8 | =c/postgres          +<br>
            |          |          |         |         | postgres=CTc/postgres<br>
 template1  | postgres | UTF8     | C.UTF-8 | C.UTF-8 | =c/postgres          +<br>
            |          |          |         |         | postgres=CTc/postgres<br>
(6 rows)</p>
<p>And yes, dvndp is a mispelling error</p>



<a name="444764369"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444764369" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444764369">(Jun 14 2024 at 18:31)</a>:</h4>
<p><a href="/user_uploads/53090/GUVE13_SssbbQoRssg0L_AIF/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/53090/GUVE13_SssbbQoRssg0L_AIF/image.png" title="image.png"><img src="/user_uploads/53090/GUVE13_SssbbQoRssg0L_AIF/image.png"></a></div>



<a name="444764544"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444764544" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444764544">(Jun 14 2024 at 18:32)</a>:</h4>
<p>Just found Create, connect and temporary (stackexchange)</p>



<a name="444764980"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444764980" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444764980">(Jun 14 2024 at 18:35)</a>:</h4>
<p>After running ansible it seems you have do drop or rename that initial dvndb, make a new dvndb and then reload,  and the add privlidges.    (By the way did I mention that I lost my sys admin support a week before RHEL7 end-of-life, hense the frantic googling to rebuild on a new system.)</p>



<a name="444765300"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444765300" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444765300">(Jun 14 2024 at 18:37)</a>:</h4>
<p>I see, like this:</p>
<div class="codehilite"><pre><span></span><code> dvndb      | postgres | UTF8     | C.UTF-8 | C.UTF-8 |
 dvndb_bkup | postgres | UTF8     | C.UTF-8 | C.UTF-8 | =Tc/postgres         +
            |          |          |         |         | postgres=CTc/postgres+
            |          |          |         |         | dvnuser=CTc/postgres
 dvndp      | postgres | UTF8     | C.UTF-8 | C.UTF-8 |
 postgres   | postgres | UTF8     | C.UTF-8 | C.UTF-8 |
 template0  | postgres | UTF8     | C.UTF-8 | C.UTF-8 | =c/postgres          +
            |          |          |         |         | postgres=CTc/postgres
 template1  | postgres | UTF8     | C.UTF-8 | C.UTF-8 | =c/postgres          +
            |          |          |         |         | postgres=CTc/postgres
(6 rows)
</code></pre></div>
<p>I'm using fenced code blocks above. Very useful here in <a href="https://zulip.com/help/code-blocks">Zulip</a> and in <a href="https://docs.github.com/en/get-started/writing-on-github/working-with-advanced-formatting/creating-and-highlighting-code-blocks">GitHub</a>. You could try this if you want:</p>
<div class="codehilite"><pre><span></span><code>```
test
```
</code></pre></div>



<a name="444765604"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444765604" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444765604">(Jun 14 2024 at 18:39)</a>:</h4>
<p>But yeah, I'm not familiar with <code>=Tc/postgres</code>.</p>



<a name="444765716"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444765716" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444765716">(Jun 14 2024 at 18:39)</a>:</h4>
<p>Check this out: <a href="https://www.postgresql.org/docs/current/ddl-priv.html#PRIVILEGE-ABBREVS-TABLE">https://www.postgresql.org/docs/current/ddl-priv.html#PRIVILEGE-ABBREVS-TABLE</a></p>



<a name="444766009"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444766009" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444766009">(Jun 14 2024 at 18:41)</a>:</h4>
<p>and <a href="https://dba.stackexchange.com/questions/264441/is-my-database-secure-what-does-tc-postgres-allow/264445#264445">https://dba.stackexchange.com/questions/264441/is-my-database-secure-what-does-tc-postgres-allow/264445#264445</a> seem to say the same thing, that "T" is for TEMPORARY and "c" is for CONNECT.</p>



<a name="444767483"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444767483" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444767483">(Jun 14 2024 at 18:50)</a>:</h4>
<p><span class="user-mention" data-user-id="653479">@jamie jamison</span> IIRC postgres ownership and privileges may need to be modified table-by-table</p>



<a name="444767620"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444767620" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444767620">(Jun 14 2024 at 18:50)</a>:</h4>
<p><span class="user-mention" data-user-id="653479">@jamie jamison</span> if you dump and import as Phil suggests you can use the <code>-O</code> (no "owner") flag which may greatly simplify the process?</p>



<a name="444767700"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444767700" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444767700">(Jun 14 2024 at 18:51)</a>:</h4>
<p>That makes rebuilding the database a bit more daunting   I'll go back and try that - dump from the previous test system and bring over to new.</p>



<a name="444778361"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444778361" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444778361">(Jun 14 2024 at 19:58)</a>:</h4>
<p>Dropped the database and reloaded from  a dump.  It now matches up to what the old server postgres looked like  but still not getting the dataverse front page.  May take waiting longer</p>



<a name="444778790"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444778790" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444778790">(Jun 14 2024 at 20:00)</a>:</h4>
<p>Anything at the equivalent of <a href="https://demo.dataverse.org/api/info/version">https://demo.dataverse.org/api/info/version</a> ?</p>



<a name="444779034"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444779034" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444779034">(Jun 14 2024 at 20:02)</a>:</h4>
<p>I'll try that as soon as I can get payara6 to start again</p>



<a name="444779358"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444779358" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444779358">(Jun 14 2024 at 20:04)</a>:</h4>
<p>404 page not found, requested service not available</p>



<a name="444779715"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444779715" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444779715">(Jun 14 2024 at 20:06)</a>:</h4>
<p>any errors in server.log?</p>



<a name="444782332"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444782332" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444782332">(Jun 14 2024 at 20:22)</a>:</h4>
<p>But I do get the payara page</p>



<a name="444782363"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444782363" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444782363">(Jun 14 2024 at 20:22)</a>:</h4>
<p>I'm digging in the server log now</p>



<a name="444782720"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444782720" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444782720">(Jun 14 2024 at 20:24)</a>:</h4>
<p>[#|2024-06-14T00:19:37.128+0000|SEVERE|Payara 6.2023.8|edu.harvard.iq.dataverse.mydata.DataRetrieverAPI|_ThreadID=90;_ThreadName=http-thread-pool::jk-connector(5);_TimeMillis=1718324377128;_LevelValue=1000;|<br>
  Sorry, nothing was found for these roles: Admin, File Downloader, Dataverse + Dataset Creator, Dataverse Creator, Dataset Creator, Contributor, Curator, Member|#]</p>



<a name="444782749"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444782749" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444782749">(Jun 14 2024 at 20:24)</a>:</h4>
<p>Looks like the database is messed up somehow</p>



<a name="444784758"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444784758" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444784758">(Jun 14 2024 at 20:35)</a>:</h4>
<p>Huh. Yeah, sounds like it. <span aria-label="disappointed" class="emoji emoji-1f61e" role="img" title="disappointed">:disappointed:</span></p>



<a name="444784853"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444784853" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444784853">(Jun 14 2024 at 20:35)</a>:</h4>
<p>There has to be a way to reload or restore a database</p>



<a name="444785822"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444785822" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444785822">(Jun 14 2024 at 20:41)</a>:</h4>
<p>I mean, a long time ago I used scripts like this to dump and restore:</p>
<ul>
<li><a href="https://github.com/IQSS/dataverse/blob/v6.2/scripts/database/homebrew/dump">https://github.com/IQSS/dataverse/blob/v6.2/scripts/database/homebrew/dump</a></li>
<li><a href="https://github.com/IQSS/dataverse/blob/v6.2/scripts/database/homebrew/restore">https://github.com/IQSS/dataverse/blob/v6.2/scripts/database/homebrew/restore</a></li>
</ul>
<p>10 years ago according to git. But something like that should work, I would think.</p>



<a name="444786032"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444786032" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444786032">(Jun 14 2024 at 20:42)</a>:</h4>
<p>that looks like what I did (will paste the commands in)</p>



<a name="444786243"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444786243" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444786243">(Jun 14 2024 at 20:44)</a>:</h4>
<p>It looks like <span class="user-mention" data-user-id="598843">@Deirdre Kirmis</span> has experience with database backup and recovery: <a href="https://groups.google.com/g/dataverse-community/c/kTEUkxHB_ZM/m/T6aRZ9SpCwAJ">https://groups.google.com/g/dataverse-community/c/kTEUkxHB_ZM/m/T6aRZ9SpCwAJ</a></p>



<a name="444786935"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444786935" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444786935">(Jun 14 2024 at 20:49)</a>:</h4>
<p>Ok,  this is probably not an official way to fix things but after reloading the database I reran ansible and now the test looks ok.<br>
At that point I did as <span class="user-mention" data-user-id="598112">@Philip Durbin</span>  suggested and ran with "/api/info/version" and got status 'ok' and version '6.2'</p>



<a name="444787089"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/444787089" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#444787089">(Jun 14 2024 at 20:49)</a>:</h4>
<p>Is it possible that rerunning the ansible script fixed the missing roles?</p>



<a name="445184642"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/445184642" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#445184642">(Jun 17 2024 at 17:18)</a>:</h4>
<p>I that I'm following the directions exactly from <a href="https://guides.dataverse.org/en/latest/installation/config.html#second-configure-your-dataverse-installation-to-use-s3-storage">https://guides.dataverse.org/en/latest/installation/config.html#second-configure-your-dataverse-installation-to-use-s3-storage</a></p>
<p>Example :<br>
&lt;jvm-options&gt;-Ddataverse.files.storage-driver-id=file&lt;/jvm-options&gt;<br>
        &lt;jvm-options&gt;-Xmx3841m&lt;/jvm-options&gt;<br>
        &lt;jvm-options&gt;-Ddataverse.files.dataverse-test-oregon.type=s3&lt;/jvm-options&gt;<br>
        &lt;jvm-options&gt;-Ddataverse.files.dataverse-test-oregon.label=dataverse-test-oregon&lt;/jvm-options&gt;<br>
        &lt;jvm-options&gt;-Ddataverse.files.dataverse-test-oregon.type=s3&lt;/jvm-options&gt;<br>
        &lt;jvm-options&gt;-Ddataverse.files.dataverse-test-oregon=dataverse-test-oregon&lt;/jvm-options&gt;<br>
        &lt;jvm-options&gt;-Ddataverse.files.dataverse-test-oregon.download-redirect=true&lt;/jvm-options&gt;<br>
        &lt;jvm-options&gt;-Ddataverse.files.dataverse-test-oregon.upload-redirect=true&lt;/jvm-options&gt;</p>
<p>If I restart and check status of payar6 I get:<br>
sudo systemctl status payara6<br>
Ã— payara6.service - Payara Server<br>
     Loaded: loaded (/etc/systemd/system/payara6.service; enabled; preset: disabled)<br>
     Active: failed (Result: exit-code) since Mon 2024-06-17 17:07:10 UTC; 8min ago<br>
    Process: 43806 ExecStart=/usr/bin/java -jar /usr/local/payara6/glassfish/lib/client/appserver-cli.jar start-domain (code=exited, status=1/FAILURE)<br>
        CPU: 2.396s</p>
<p>Jun 17 17:07:08 ip-172-31-23-165.us-west-2.compute.internal systemd[1]: Starting Payara Server...<br>
Jun 17 17:07:10 ip-172-31-23-165.us-west-2.compute.internal java[43806]: Port 7676 is in use<br>
Jun 17 17:07:10 ip-172-31-23-165.us-west-2.compute.internal java[43806]: Command start-domain failed.<br>
Jun 17 17:07:10 ip-172-31-23-165.us-west-2.compute.internal systemd[1]: payara6.service: Control process exited, code=exited, status=1/FAILURE<br>
Jun 17 17:07:10 ip-172-31-23-165.us-west-2.compute.internal systemd[1]: payara6.service: Failed with result 'exit-code'.<br>
Jun 17 17:07:10 ip-172-31-23-165.us-west-2.compute.internal systemd[1]: Failed to start Payara Server.<br>
Jun 17 17:07:10 ip-172-31-23-165.us-west-2.compute.internal systemd[1]: payara6.service: Consumed 2.396s CPU time.<br>
[rocky@ip-172-31-23-165 ~]$</p>
<p>And, oddly the test system looks like it's up,  though with no buckets until I reboot the system then I get a 500</p>



<a name="445211004"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/445211004" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#445211004">(Jun 17 2024 at 19:41)</a>:</h4>
<p>And another question.  When it's up  I'm not able to log into the test dataverse with the default admin account.   In the ansible script it looks like the admin account is 'dataverseAdmin' and thepassword is "admin1"  which gets the error "username, email address, or password you entered is invalid."</p>



<a name="445213589"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/445213589" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#445213589">(Jun 17 2024 at 19:57)</a>:</h4>
<p>And for shibboleth,  following <a href="https://guides.dataverse.org/en/latest/installation/shibboleth.html#install-shibboleth-via-yum">https://guides.dataverse.org/en/latest/installation/shibboleth.html#install-shibboleth-via-yum</a><br>
I'm stuck at the error:   Error: GPG check FAILED</p>



<a name="445375759"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/445375759" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#445375759">(Jun 18 2024 at 14:40)</a>:</h4>
<p>is there anything more descriptive in the Payara server.log?<br>
on Shibboleth: worst case you can set gpg_enable=0 in the repo config, but better to import the GPG key</p>



<a name="445390351"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/445390351" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#445390351">(Jun 18 2024 at 15:31)</a>:</h4>
<p>For the payara server log part of the problem is I'm not sure what to look for.  I'm partially relying on the time stamp.<br>
For shib I'm obviously not importing the GPG correctly.     I have back-to-back patron consults till noon and then will dig back in.</p>



<a name="445434564"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/445434564" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#445434564">(Jun 18 2024 at 18:44)</a>:</h4>
<p>my shibboleth.repo is looking at</p>
<div class="codehilite"><pre><span></span><code>gpgkey=https://shibboleth.net/downloads/service-provider/RPMS/repomd.xml.key
https://shibboleth.net/downloads/service-provider/RPMS/cantor.repomd.xml.key
</code></pre></div>



<a name="445438383"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/445438383" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#445438383">(Jun 18 2024 at 19:04)</a>:</h4>
<p>That is the same thing that I have:<br>
**</p>
<p>[shibboleth]<br>
name=Shibboleth (rockylinux9)</p>
<h1>Please report any problems to <a href="https://shibboleth.atlassian.net/jira">https://shibboleth.atlassian.net/jira</a></h1>
<p>type=rpm-md<br>
mirrorlist=https://shibboleth.net/cgi-bin/mirrorlist.cgi/rockylinux9<br>
gpgcheck=1<br>
gpgkey=https://shibboleth.net/downloads/service-provider/RPMS/repomd.xml.key<br>
<a href="https://shibboleth.net/downloads/service-provider/RPMS/cantor.repomd.xml.key">https://shibboleth.net/downloads/service-provider/RPMS/cantor.repomd.xml.key</a><br>
enabled=1<br>
**</p>



<a name="446684134"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/446684134" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#446684134">(Jun 24 2024 at 18:17)</a>:</h4>
<p>One thing I am running into is that out-of-the-box I can't log into Dataverse. I've tried to unblock admin in the main.yml script but that didn't help.<br>
Is there a way via the api to change the dataverseAdmin password?  I'm reading through the documenation but havent found that yet</p>



<a name="446702863"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/446702863" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#446702863">(Jun 24 2024 at 19:48)</a>:</h4>
<p><span class="user-mention" data-user-id="653479">@jamie jamison</span> if you're using Dataverse-Ansible you can set it as a group_var?</p>



<a name="446706689"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/446706689" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#446706689">(Jun 24 2024 at 20:09)</a>:</h4>
<p>Ok, I'll look into that. I did try setting the dataverseAdmin password in the ansible script.</p>
<p>Other thing: even before I try to add s3 buckets I get this:<br>
<strong>exception</strong></p>
<p>jakarta.servlet.ServletException: /dataset.xhtml @595,164 rendered="#{settingsWrapper.makeDataCountDisplayEnabled and DatasetPage.doi}": The class 'edu.harvard.iq.dataverse.DatasetPage' does not have the property 'doi'.<br>
<strong>root cause</strong></p>
<p>jakarta.el.PropertyNotFoundException: /dataset.xhtml @595,164 rendered="#{settingsWrapper.makeDataCountDisplayEnabled and DatasetPage.doi}": The class 'edu.harvard.iq.dataverse.DatasetPage' does not have the property 'doi'.</p>
<p>I'm wondering where makeDataCount is enabled - trying to find in main.yml</p>



<a name="446906643"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/446906643" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#446906643">(Jun 25 2024 at 14:52)</a>:</h4>
<p><span class="user-mention" data-user-id="653479">@jamie jamison</span> I don't think Ansible knows about MDC yet?</p>



<a name="446933082"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/446933082" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#446933082">(Jun 25 2024 at 16:26)</a>:</h4>
<p>Ok,  mostly I'm trying to understand the error messages - lot of this is new to me so I'm still limping up the learning curve</p>



<a name="446933821"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/446933821" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#446933821">(Jun 25 2024 at 16:29)</a>:</h4>
<p>Since I'm using a reloaded dvndb database (from the REHL7 test dataverse)  I'm wondering if it's possilbe that MDC is in the database and causing that error.</p>



<a name="446934839"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/446934839" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#446934839">(Jun 25 2024 at 16:33)</a>:</h4>
<p>And I may have found something in 6.2 documentaation - <a href="https://guides.dataverse.org/en/latest/admin/make-data-count.html#enable-or-disable-display-of-make-data-count-metrics">https://guides.dataverse.org/en/latest/admin/make-data-count.html#enable-or-disable-display-of-make-data-count-metrics</a></p>
<p>And that seems to solve at least that error.   I'm putting that in my notes - things to consider when restoring a pervious database</p>



<a name="446990768"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/446990768" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#446990768">(Jun 25 2024 at 20:41)</a>:</h4>
<p>Actually the most exasperating issue at this point is that the default, out-of-the-box  dataverseAdmin password doesn't work though this might also be because of the reloaded dvdnb database.  Is that where passwords are stored?</p>



<a name="447296906"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/447296906" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#447296906">(Jun 26 2024 at 18:26)</a>:</h4>
<p>Also, sometimes payara6 seems 'stuck'.  Unable to stop or restart or even kill the process.</p>
<p>payara6.service - Payara Server<br>
     Loaded: loaded (/etc/systemd/system/payara6.service; enabled; preset: disabled)<br>
     Active: failed (Result: exit-code) since Wed 2024-06-26 17:43:43 UTC; 39min ago<br>
    Process: 720 ExecStart=/usr/bin/java -jar /usr/local/payara6/glassfish/lib/client/appserver-cli.jar start-domain (code=exited, st&gt;<br>
        CPU: 1.304s</p>
<p>Jun 26 17:43:38 ip-172-31-23-165.us-west-2.compute.internal systemd[1]: Starting Payara Server...<br>
Jun 26 17:43:43 ip-172-31-23-165.us-west-2.compute.internal java[720]: com.sun.enterprise.universal.xml.MiniXmlParserException: "Xml &gt;<br>
Jun 26 17:43:43 ip-172-31-23-165.us-west-2.compute.internal java[720]: Message: elementGetText() function expects text only elment bu&gt;<br>
Jun 26 17:43:43 ip-172-31-23-165.us-west-2.compute.internal java[720]: Command start-domain failed.<br>
Jun 26 17:43:43 ip-172-31-23-165.us-west-2.compute.internal systemd[1]: payara6.service: Control process exited, code=exited, status=&gt;<br>
Jun 26 17:43:43 ip-172-31-23-165.us-west-2.compute.internal systemd[1]: payara6.service: Failed with result 'exit-code'.<br>
Jun 26 17:43:43 ip-172-31-23-165.us-west-2.compute.internal systemd[1]: Failed to start Payara Server.<br>
Jun 26 17:43:43 ip-172-31-23-165.us-west-2.compute.internal systemd[1]: payara6.service: Consumed 1.304s CPU time.<br>
[rocky@ip-172-31-23-165 logs]$</p>



<a name="447523107"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/447523107" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#447523107">(Jun 27 2024 at 16:41)</a>:</h4>
<p><span class="user-mention" data-user-id="653479">@jamie jamison</span> I've seen Payara do this on <a href="http://beta.dataverse.org">beta.dataverse.org</a> - is there more information in server.log? on dataverseAdmin - since you have access to the DB, you could update the e-mail address associated with userid '1' in the authenticateuser table and trigger a password reset, or you could just blank the password entry?</p>



<a name="447523331"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/447523331" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#447523331">(Jun 27 2024 at 16:42)</a>:</h4>
<p>on restoring databases / moving servers: I keep a shell script around on test machines, <a href="http://reset_settings.sh">reset_settings.sh</a> or some such, with a list of commonly-required curl commands to make the test server a test server when I've imported a copy of the production database</p>



<a name="447556412"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/447556412" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#447556412">(Jun 27 2024 at 18:52)</a>:</h4>
<p>And they problem turned out to be a typo by me.   Now back on track. </p>
<p>The current s3 bucket related error is:<br>
6.2023.8|edu.harvard.iq.dataverse.dataaccess.DataAccess|_ThreadID=88;_ThreadName=http-thread-pool::jk-connector(2);_TimeMillis=1719511203190;_LevelValue=900;|<br>
Â Â Could not find storage driver for: s3|#]</p>
<p>Lastly, I can't seem to wget the <a href="http://reset_settings.sh">reset_settings.sh</a> file.  Is there another place to get it?</p>



<a name="447604034"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/447604034" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#447604034">(Jun 27 2024 at 22:31)</a>:</h4>
<p>About the storage driver issue,  here is part of the domain.xml code:</p>
<p>&lt;jvm-options&gt;-Ddataverse.files.storage-driver-id=s3&lt;/jvm-options&gt;  &lt;- is this correct,  the default is 'file' but should it be changed to 's3' for the s3 buckets?</p>
<div class="codehilite"><pre><span></span><code>    &lt;jvm-options&gt;-Xmx3841m&lt;/jvm-options&gt;
    &lt;jvm-options&gt;-Ddataverse.files.dataverse-test-oregon.type=s3&lt;/jvm-options&gt;
    &lt;jvm-options&gt;-Ddataverse.files.dataverse-test-oregon.label=dataverse-test-oregon&lt;/jvm-options&gt;
    &lt;jvm-options&gt;-Ddataverse.files.dataverse-test-oregon.bucket-name=dataverse-test-oregon&lt;/jvm-options&gt;
    &lt;jvm-options&gt;-Ddataverse.files.dataverse-test-oregon.download-redirect=true&lt;/jvm-options&gt;
    &lt;jvm-options&gt;-Ddataverse.files.dataverse-test-oregon.upload-redirect=true&lt;/jvm-options&gt;
</code></pre></div>



<a name="448375805"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/448375805" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#448375805">(Jul 01 2024 at 16:10)</a>:</h4>
<p><span class="user-mention" data-user-id="653479">@jamie jamison</span> the script was just something I threw together to make a copy of my production database suitable for our test server. I'm happy to share mine with you (just some API calls to change settings). if you're all S3, then yes you want <code>storage-driver-id=s3</code>.  it may be because your label is dataverse-test-oregon instead of s3?</p>



<a name="448407331"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/448407331" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#448407331">(Jul 01 2024 at 18:32)</a>:</h4>
<p>This is what I'm a bit confused about.   According to the documentation:<br>
dataverse.files.&lt;id&gt;.label&lt;?&gt;  <strong>Required</strong>Â label to be shown in the UI for thisÂ storage  default (none)</p>
<p>So is it correct that the label is what's shown in the UI wouldn't the lable be 'dataverse-test-oregon'?</p>



<a name="448901324"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/448901324" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#448901324">(Jul 03 2024 at 16:45)</a>:</h4>
<p>Did you figure it out, what's shown in the UI? (I'm not sure, myself.)</p>



<a name="448902924"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/448902924" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#448902924">(Jul 03 2024 at 16:55)</a>:</h4>
<p>we're still working on it.  Fresh install with reloaded database is messier then fresh install.  You guys get the notes on how we did it when done.</p>



<a name="448903159"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/448903159" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#448903159">(Jul 03 2024 at 16:56)</a>:</h4>
<p>Great, much appreciated. Good luck!</p>



<a name="449366959"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/449366959" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#449366959">(Jul 05 2024 at 17:55)</a>:</h4>
<p><span class="user-mention" data-user-id="653479">@jamie jamison</span> the label appears to be a friendly name, the <code>&lt;id&gt;</code> value identifies the datastore. does that make sense?</p>



<a name="449376071"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/449376071" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#449376071">(Jul 05 2024 at 18:47)</a>:</h4>
<p>In my case probably not.   I understand the label. For the test I'm using the bucket name as the friendly name. For the &lt;id&gt; I guess that's were I'm confused.     If the default is 'file' for local files system, what is appropriate for s3 storage?</p>
<p>Documentation:<br>
dataverse.files.storage-driver-id &lt;id&gt; Enable &lt;id&gt; as the defaultÂ storageÂ driver. <code>file</code></p>



<a name="450162139"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/450162139" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#450162139">(Jul 09 2024 at 12:44)</a>:</h4>
<p><span class="user-mention" data-user-id="653479">@jamie jamison</span> the &lt;id&gt; bit threw me as well, our is simply "s3" and suits us for now. i'll need to get more descriptive as we add datastores.</p>



<a name="450236880"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/450236880" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#450236880">(Jul 09 2024 at 17:31)</a>:</h4>
<p>Ok.   Right now dataverse 6.2 is dead in the water becuase it can't access the s3 buckets and 5.14 is giving me grief since the operating system is end-of-life.</p>



<a name="450261850"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/450261850" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#450261850">(Jul 09 2024 at 19:17)</a>:</h4>
<p><span class="user-mention" data-user-id="653479">@jamie jamison</span> remind me of the error you get accessing the buckets from 6.2?</p>



<a name="450263012"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/450263012" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#450263012">(Jul 09 2024 at 19:22)</a>:</h4>
<p>jamie jamison:Â And they problem turned out to be a typo by me. Now back on track.</p>
<p>The current s3 bucket related error is:<br>
6.2023.8|edu.harvard.iq.dataverse.dataaccess.DataAccess|_ThreadID=88;_ThreadName=http-thread-pool::jk-connector(2);_TimeMillis=1719511203190;_LevelValue=900;|<br>
Â Â Could not find storage driver for: s3|#]</p>
<p>Lastly, I can't seem to wget theÂ <a href="http://reset_settings.sh/">reset_settings.sh</a>Â file. Is there another place to get it?</p>
<p>jamie jamison:Â About the storage driver issue, here is part of the domain.xml code:</p>
<p>&lt;jvm-options&gt;-Ddataverse.files.storage-driver-id=s3&lt;/jvm-options&gt; &lt;- is this correct, the default is 'file' but should it be changed to 's3' for the s3 buckets?</p>
<div class="codehilite"><pre><span></span><code>    &lt;jvm-options&gt;-Xmx3841m&lt;/jvm-options&gt;
    &lt;jvm-options&gt;-Ddataverse.files.dataverse-test-oregon.type=s3&lt;/jvm-options&gt;
    &lt;jvm-options&gt;-Ddataverse.files.dataverse-test-oregon.label=dataverse-test-oregon&lt;/jvm-options&gt;
    &lt;jvm-options&gt;-Ddataverse.files.dataverse-test-oregon.bucket-name=dataverse-test-oregon&lt;/jvm-options&gt;
    &lt;jvm-options&gt;-Ddataverse.files.dataverse-test-oregon.download-redirect=true&lt;/jvm-options&gt;
    &lt;jvm-options&gt;-Ddataverse.files.dataverse-test-orego
n.upload-redirect=true&lt;/jvm-options&gt;
</code></pre></div>



<a name="450266955"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/450266955" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#450266955">(Jul 09 2024 at 19:43)</a>:</h4>
<p>I'm glad fixing the typo is helping!</p>



<a name="450267021"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/450267021" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#450267021">(Jul 09 2024 at 19:43)</a>:</h4>
<p>Sorry, a reset settings script? I'm not familiar with it. You're seeing this in the guides or a release note somewhere?</p>



<a name="450504733"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/450504733" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#450504733">(Jul 10 2024 at 16:33)</a>:</h4>
<p>reset settings script was a suggestion from Don.  Not in the guides or release notes.   <br>
So far still can't access the s3 buckets and unable to get letsencrypt working.</p>



<a name="450508321"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/450508321" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#450508321">(Jul 10 2024 at 16:54)</a>:</h4>
<p>Oh, I understand now, thanks</p>



<a name="450550455"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/450550455" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#450550455">(Jul 10 2024 at 19:57)</a>:</h4>
<p><span class="user-mention" data-user-id="653479">@jamie jamison</span> in this case your storage-driver-id for s3 is <code>dataverse-test-oregon</code></p>



<a name="450550775"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/450550775" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#450550775">(Jul 10 2024 at 19:58)</a>:</h4>
<p>the reset settings script is just a handful of curl commands I threw together in a script to set the Authority of our test server instead of our production, use the throw-away shoulder, and put up a banner warning that the test server is just a test server. it's really a way to automate the stuff I had to manually fix each time I imported a copy of our production database.</p>



<a name="450550805"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/450550805" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#450550805">(Jul 10 2024 at 19:58)</a>:</h4>
<p>I guess I didn't completely understand the documentation.  Right now test is down due while trying to get letsencrypt working.   But as soon as it's back I'll try that.  Clarification helpful</p>



<a name="450610160"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/450610160" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#450610160">(Jul 11 2024 at 02:45)</a>:</h4>
<p>This is aside from the installation problem.  Since Dataverse 5.14 on RedHat7 is barely working or staying up I've found I can still publish some of the user datasets with the API - so they can get DOIs for publishing.  API works great.</p>



<a name="450818475"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/450818475" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#450818475">(Jul 11 2024 at 21:48)</a>:</h4>
<p>I anyone else having issues with 'stuck' payara6.  Service can't be stopped, restarted or killed.<br>
sudo systemctl status payara6<br>
Ã— payara6.service - Payara Server<br>
     Loaded: loaded (/etc/systemd/system/payara6.service; enabled; preset: disabled)<br>
     Active: failed (Result: timeout) since Tue 2024-07-09 17:49:42 UTC; 2 days ago<br>
        CPU: 28.414s</p>
<p>Jul 09 17:47:41 ip-172-31-23-165.us-west-2.compute.internal systemd[1]: Starting Payara Server...<br>
Jul 09 17:49:41 ip-172-31-23-165.us-west-2.compute.internal systemd[1]: payara6.service: start operation timed out. Terminating.<br>
Jul 09 17:49:42 ip-172-31-23-165.us-west-2.compute.internal java[728]: Waiting for domain1 to start .............................&gt;<br>
Jul 09 17:49:42 ip-172-31-23-165.us-west-2.compute.internal systemd[1]: payara6.service: Control process exited, code=exited, sta&gt;<br>
Jul 09 17:49:42 ip-172-31-23-165.us-west-2.compute.internal systemd[1]: payara6.service: Failed with result 'timeout'.<br>
Jul 09 17:49:42 ip-172-31-23-165.us-west-2.compute.internal systemd[1]: Failed to start Payara Server.<br>
Jul 09 17:49:42 ip-172-31-23-165.us-west-2.compute.internal systemd[1]: payara6.service: Consumed 28.414s CPU time.<br>
lines 1-12/12 (END)</p>



<a name="450847073"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/450847073" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#450847073">(Jul 12 2024 at 01:25)</a>:</h4>
<p><span class="user-mention silent" data-user-id="626369">Don Sizemore</span> <a href="#narrow/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2/near/450550455">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="653479">jamie jamison</span> in this case your storage-driver-id for s3 is <code>dataverse-test-oregon</code></p>
</blockquote>
<p>I think I need one more clarification.  If there are 4 s3 buckets, bucket1, bucket2, bucket3, bucket4.  Does each one have to have it's own storage-driver-id?<br>
dataverse.files.bucket1-storage-driver-id=bucket1<br>
dataverse.files.bucket2-storage-driver-id=bucket2<br>
dataverse.files.bucket3-storage-driver-id=bucket3<br>
dataverse.files.bucket4-storage-driver-id=bucket4</p>



<a name="450895535"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/450895535" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#450895535">(Jul 12 2024 at 07:18)</a>:</h4>
<p>These options are all mixed up.  The <code>&lt;id&gt;</code> part needs to be a unique indentifier for your storage, the <code>storage-driver-id</code> <em>option</em> (mind the ".") references the driver to use for storage <em>&lt;id&gt;</em>.</p>
<p>Here's a complete example of an S3 storage from our beta env:</p>
<div class="codehilite"><pre><span></span><code>dataverse.files.s3.bucket-name=juelich_data_beta
dataverse.files.s3.custom-endpoint-url=https://s3.fz-juelich.de
dataverse.files.s3.label=JÃ¼lich-DATA-Object-Store
dataverse.files.s3.path-style-access=true
dataverse.files.s3.type=s3
dataverse.files.storage-driver-id=s3
</code></pre></div>
<p>So in your case, this needs to be (assuming all of them are S3):</p>
<div class="codehilite"><pre><span></span><code>dataverse.files.bucket1.storage-driver-id=s3
dataverse.files.bucket1.s3.xxx
...
dataverse.files.bucket2.storage-driver-id=s3
dataverse.files.bucket2.s3.xxx
...
dataverse.files.bucket3.storage-driver-id=s3
dataverse.files.bucket3.s3.xxx
...
dataverse.files.bucket4.storage-driver-id=s3
dataverse.files.bucket4.s3.xxx
...
</code></pre></div>



<a name="450992786"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/450992786" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#450992786">(Jul 12 2024 at 14:29)</a>:</h4>
<p>The docs say "dataverse.files.storage-driver-id" allows you to "Enable &lt;id&gt; as the default storage driver." -- <a href="https://guides.dataverse.org/en/6.3/installation/config.html#list-of-s3-storage-options">https://guides.dataverse.org/en/6.3/installation/config.html#list-of-s3-storage-options</a></p>
<p>So you'll want to pick one of your four buckets as the &lt;id&gt;, like this:</p>
<p>dataverse.files.storage-driver-id=bucket3</p>



<a name="451002744"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451002744" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451002744">(Jul 12 2024 at 15:04)</a>:</h4>
<p>Dang you're right! I mixed that up myself! See, it's fricking complicated!</p>



<a name="451002841"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451002841" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451002841">(Jul 12 2024 at 15:04)</a>:</h4>
<p>One day I will make the MPCONFIG part for the storage system and take care to rename the default driver option!</p>



<a name="451004964"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451004964" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451004964">(Jul 12 2024 at 15:11)</a>:</h4>
<p>So friggin' complicated. Need more docs, I guess, short term.</p>



<a name="451020707"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451020707" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451020707">(Jul 12 2024 at 16:15)</a>:</h4>
<p>I'll make an example along with the ntoes I send you.   Last question to clarify.  You only need 1 default-driver-id?  Even with 2 or more s3 buckets?</p>



<a name="451038053"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451038053" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451038053">(Jul 12 2024 at 17:46)</a>:</h4>
<p>Yes. That's the driver that will be assigned to a new collection if you don't specify a different one.</p>



<a name="451038091"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451038091" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451038091">(Jul 12 2024 at 17:46)</a>:</h4>
<p>There's only 1 instance wide default :-)</p>



<a name="451038240"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451038240" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451038240">(Jul 12 2024 at 17:47)</a>:</h4>
<p>Thank you for clarifying.   I'll send over my example as soon as I get finished setting up the new server.</p>



<a name="451073779"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451073779" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451073779">(Jul 12 2024 at 20:54)</a>:</h4>
<p>Hereis some code following the example:<br>
&lt;jvm-options&gt;-**Ddataverse.files.datavers-test-oregon.storage-driver-id=s3&lt;/jvm-options&gt;<br>
&lt;jvm-options&gt;-Ddataverse.files.dataverese-test-oregon.type=s3&lt;/jvm-options&gt;<br>
&lt;jvm-options&gt;-Ddataverse.files.dataverse-test-oregon=dataverse-test-oregon&lt;/jvm-options&gt;<br>
&lt;jvm-options&gt;-Ddataverse.files.dataverse-test-oregon.download-redirect=true&lt;/jvm-o**ptions&gt;<br>
&lt;jvm-options&gt;-Ddataverse.files.dataverse-test-oregon.upload-redirect=true&lt;/jvm-options&gt;</p>
<p>&lt;jvm-options&gt;-<strong>Ddataverse.files.ssda-files.storage-driver-id=s3</strong>&lt;/jvm-options&gt;<br>
&lt;jvm-options&gt;-Ddataverse.files.ssda-files.type=s3&lt;/jvm-options&gt;<br>
&lt;jvm-options&gt;-Ddataverse.files.ssda-files=ssda-files&lt;/jvm-options&gt;<br>
&lt;jvm-options&gt;-Ddataverse.files.ssda-files.download-redirect=true&lt;/jvm-options&gt;<br>
&lt;jvm-options&gt;-Ddataverse.files.ssda-files.upload-redirect=true&lt;/jvm-options&gt;</p>
<p>and I still get:<br>
[#|2024-07-12T20:14:08.003+0000|WARNING|Payara 6.2023.8|edu.harvard.iq.dataverse.dataaccess.DataAccess|_ThreadID=88;_ThreadName=http-thread-pool::jk-connector(3);_TimeMillis=1720815248003;_LevelValue=900;|<br>
  Could not find storage driver for: s3|#]</p>
<p>[#|2024-07-12T20:14:08.003+0000|WARNING|Payara 6.2023.8|edu.harvard.iq.dataverse.ThumbnailServiceWrapper|_ThreadID=88;_ThreadName=http-thread-pool::jk-connector(3);_TimeMillis=1720815248003;_LevelValue=900;|<br>
  getDatasetCardImageAsUrl(): Failed to initialize dataset StorageIO for s3://10.5072/FK2/MN0MUZ (getDataAccessObject: Unsupported storage method.)|#]</p>
<p>[#|2024-07-12T20:14:08.008+0000|WARNING|Payara 6.2023.8|edu.harvard.iq.dataverse.dataaccess.DataAccess|_ThreadID=88;_ThreadName=http-thread-pool::jk-connector(3);_TimeMillis=1720815248008;_LevelValue=900;|<br>
  Could not find storage driver for: s3|#]</p>
<p>[#|2024-07-12T20:14:08.009+0000|WARNING|Payara 6.2023.8|edu.harvard.iq.dataverse.ThumbnailServiceWrapper|_ThreadID=88;_ThreadName=http-thread-pool::jk-connector(3);_TimeMillis=1720815248009;_LevelValue=900;|<br>
  getDatasetCardImageAsUrl(): Failed to initialize dataset StorageIO for s3://10.5072/FK2/KHOWY6 (getDataAccessObject: Unsupported storage method.)|#]</p>
<p>So maybe the problem is something else? I did check the aws configuration and that looks correct.</p>



<a name="451074527"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451074527" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451074527">(Jul 12 2024 at 21:00)</a>:</h4>
<p><code>dataverse.files.datavers-test-oregon.storage-driver-id=s3</code> has a typo it it. An "e" is missing from the end of "dataverse".</p>



<a name="451074594"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451074594" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451074594">(Jul 12 2024 at 21:01)</a>:</h4>
<p>well that embarrassing for an old secretary...   Will go retry now</p>



<a name="451074616"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451074616" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451074616">(Jul 12 2024 at 21:01)</a>:</h4>
<p>Personally, I would use and <code>&lt;id&gt;</code> that doesn't have hyphens it in. But maybe they do work. Dunno.</p>



<a name="451075924"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451075924" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451075924">(Jul 12 2024 at 21:09)</a>:</h4>
<p>I fixed the typo.  Still get the error.  The reason I formatted the way that I did was an example from Oliver Bertuch (above):<br>
dataverse.files.bucket4.storage-driver-id=s3</p>
<p>and this is what's in documentation:<br>
dataverse.files.storage-driver-id  &lt;id&gt;  Enable &lt;id&gt; as the defaultÂ storageÂ driver. <code>file</code></p>



<a name="451078585"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451078585" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451078585">(Jul 12 2024 at 21:29)</a>:</h4>
<p>I feel like there's something amiss with your config but it's late here. Maybe I can look at it with fresh eyes next week.</p>



<a name="451078779"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451078779" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451078779">(Jul 12 2024 at 21:31)</a>:</h4>
<p>There's also the missing .label thing</p>



<a name="451078899"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451078899" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451078899">(Jul 12 2024 at 21:32)</a>:</h4>
<p>Educated guess on the error messages: the storage driver ID is IIRC built into the location URL. So there is no storage driver called "s3" around as per the config you posted</p>



<a name="451079217"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451079217" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451079217">(Jul 12 2024 at 21:34)</a>:</h4>
<p>Yupp. These storage id's need to be migrated... (DataAccess.getStorageIdFromLocation)</p>



<a name="451079320"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451079320" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451079320">(Jul 12 2024 at 21:35)</a>:</h4>
<p>Or you configure a storage driver that has an id "s3" <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="451081806"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451081806" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451081806">(Jul 12 2024 at 21:50)</a>:</h4>
<p>Could you post a sample of what that looks like? I've been using this example:<br>
dataverse.files.bucket2.storage-driver-id=s3</p>



<a name="451387353"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451387353" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451387353">(Jul 14 2024 at 22:53)</a>:</h4>
<p>Related: <a href="https://github.com/IQSS/dataverse/issues/10684">https://github.com/IQSS/dataverse/issues/10684</a></p>



<a name="451508551"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451508551" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451508551">(Jul 15 2024 at 14:07)</a>:</h4>
<p><span class="user-mention" data-user-id="653479">@jamie jamison</span> this one doesn't look right, for example:</p>
<div class="codehilite"><pre><span></span><code>&lt;jvm-options&gt;-Ddataverse.files.ssda-files=ssda-files&lt;/jvm-options&gt;
</code></pre></div>
<p><code>ssda-files</code> is your <code>&lt;id&gt;</code> and there should be something after it like <code>.type</code> or <code>.label</code> or whatever.</p>



<a name="451645336"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451645336" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451645336">(Jul 15 2024 at 22:58)</a>:</h4>
<p>Another non-s3 question.  We still having trouble with the install.  I was asked what branch we should be using if we want to install dataverse 6.2 on rocky 9.  On going issues with letsencrypt.<br>
Should we use 243_rocky_9 or 6.2?</p>



<a name="451645665"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451645665" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kristian Allen - UCLA <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451645665">(Jul 15 2024 at 23:00)</a>:</h4>
<p>Thanks @jamie, if we would like to use the community ansible scripts for dvn 6.2 on rocky 9, what is the suggested branch to use?<br>
<a href="https://github.com/gdcc/dataverse-ansible/tree/v6.2">https://github.com/gdcc/dataverse-ansible/tree/v6.2</a> or<br>
<a href="https://github.com/gdcc/dataverse-ansible/tree/243_rocky_9">https://github.com/gdcc/dataverse-ansible/tree/243_rocky_9</a></p>



<a name="451760378"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451760378" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451760378">(Jul 16 2024 at 13:35)</a>:</h4>
<p><span class="user-mention" data-user-id="736518">@Kristian Allen - UCLA</span> is this a new installation? Typically that's what the Ansible scripts are used for.</p>



<a name="451808490"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451808490" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451808490">(Jul 16 2024 at 16:52)</a>:</h4>
<p>Yes,  we are doing a fresh install because we were unable to update RHEL7 in-place.  So  we are doing a fresh install of 6.2 on Rocky 9</p>



<a name="451808963"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451808963" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451808963">(Jul 16 2024 at 16:56)</a>:</h4>
<p>Right, right. I don't want to tell you the wrong thing. Better wait for <span class="user-mention" data-user-id="626369">@Don Sizemore</span></p>



<a name="451810423"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451810423" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kristian Allen - UCLA <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451810423">(Jul 16 2024 at 17:04)</a>:</h4>
<p>yes <span class="user-mention" data-user-id="653479">@jamie jamison</span> is right -- clean install. We've been using v6.2 branch but been having a few issues , we'll submit some PRs once things settle down and we get things working. </p>
<p>The current blocker is multiple processes grabbing the same port:</p>
<ul>
<li>Cannot define multiple Listeners on the same IP:port\n\n</li>
<li>Error while running systemctl restart httpd.\n\nJob for httpd.service failed because the control process exited with error code</li>
<li>AH00526: Syntax error on line 5 of /etc/httpd/conf.d/ssl.conf</li>
</ul>
<p>Following the readme, we updated the <code>main.yml</code> </p>
<div class="codehilite"><pre><span></span><code>apache:
  enabled: true
  public_fqdn:
  ssl:
    enabled: false
    remote_cert: false
    port: 443
    cert:
    interm:
    key:
    pem:
      cert:
      key:
      interm:
  port: 80
</code></pre></div>
<p>But is 443 or 80 redefined anywhere, like in <code>dataverse-apache.yml</code>?</p>
<div class="codehilite"><pre><span></span><code>- name: certbot bonks on listen 443
  lineinfile:
    path: &#39;{{ apache_virtualhost_dir }}/http.proxy.conf&#39;
    regexp: &#39;^Listen 443 https&#39;
    state: absent
  when: letsencrypt.enabled == true
</code></pre></div>



<a name="451813727"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451813727" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451813727">(Jul 16 2024 at 17:17)</a>:</h4>
<p><span class="user-mention" data-user-id="736518">@Kristian Allen - UCLA</span> the Apache proxy bits of Dataverse-Ansible are very, very untested. pull requests to fix problems or specific issue descriptions are most welcome.</p>



<a name="451824072"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451824072" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451824072">(Jul 16 2024 at 18:03)</a>:</h4>
<p>Well we're definately testing them at ucla</p>



<a name="451861668"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/451861668" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#451861668">(Jul 16 2024 at 20:57)</a>:</h4>
<p><span class="user-mention" data-user-id="626369">@Don Sizemore</span>  We're wondering if we are using the correct branch - 243_rocky_9 or 6.2.  So I don't make a pull request for the wrong branch.</p>



<a name="452059540"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/452059540" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#452059540">(Jul 17 2024 at 12:41)</a>:</h4>
<p><span class="user-mention" data-user-id="653479">@jamie jamison</span> I could attempt to merge the 6.2 branch with Rocky9, if you like? I'm happy to schedule a meeting. The httpd portion of Dataverse-Ansible is entirely untested. LetsEncrypt refuses to issue certs for addresses ending in <a href="http://amazon.com">amazon.com</a>, so that code is theoretical.</p>



<a name="452115285"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/452115285" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#452115285">(Jul 17 2024 at 15:56)</a>:</h4>
<p>I'm going to wait for Tim and Kristian but wondering if I should just do the fresh install with 6.0 or 6.1 and then do conventional updates?  </p>
<div class="codehilite"><pre><span></span><code>
</code></pre></div>



<a name="452124758"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/452124758" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#452124758">(Jul 17 2024 at 16:29)</a>:</h4>
<p>How are most people doing a fresh install?</p>



<a name="452125519"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/452125519" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#452125519">(Jul 17 2024 at 16:32)</a>:</h4>
<p><span class="user-mention silent" data-user-id="598186">Don Sizemore</span> do you think it might help <span class="user-mention" data-user-id="653479">@jamie jamison</span> and <span class="user-mention" data-user-id="736518">@Kristian Allen - UCLA</span> using the way I'm upgrading with migrations and all?</p>



<a name="452126677"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/452126677" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#452126677">(Jul 17 2024 at 16:35)</a>:</h4>
<p>Since the ansible script for 6.2 doesn't seem to be working I'm happy to hear suggestions</p>



<a name="452126921"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/452126921" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#452126921">(Jul 17 2024 at 16:36)</a>:</h4>
<p>I can't upgrade from 5.14 because RHEL7 hit endoflife.  Have to do a fresh install (on rocky9)</p>



<a name="452128680"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/452128680" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#452128680">(Jul 17 2024 at 16:44)</a>:</h4>
<p>It's the letsencrypt part that fails.   We're going to try yet again and install lets encrypt after the fact. But I'd still like to know how other people are doing fresh installs.  <br>
Successfully, that is.</p>



<a name="452136780"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/452136780" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#452136780">(Jul 17 2024 at 17:15)</a>:</h4>
<p>Have you tried disabling the Let's Encrypt part from the DV Ansible? And then using another role that has been tested working on RHEL 9 or doing it manually?</p>



<a name="452136830"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/452136830" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#452136830">(Jul 17 2024 at 17:15)</a>:</h4>
<p>Just to get stuff going...</p>



<a name="452139339"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/452139339" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#452139339">(Jul 17 2024 at 17:23)</a>:</h4>
<p>In the 6.2 ansible script, letsencrypt out-of-the-box is disabled.  We're going to test again on a fresh Rocky 9 and see how that goes.</p>



<a name="452172169"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/452172169" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#452172169">(Jul 17 2024 at 19:42)</a>:</h4>
<p><span class="user-mention" data-user-id="626369">@Don Sizemore</span> Would you have any time to meet on a friday?</p>



<a name="452179886"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/452179886" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#452179886">(Jul 17 2024 at 20:19)</a>:</h4>
<p><span class="user-mention" data-user-id="598183">@Oliver Bertuch</span> Dataverse-Ansible works with RHEL9, but IIRC that (finally) got merged after the 6.2 branch</p>



<a name="452179988"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/452179988" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#452179988">(Jul 17 2024 at 20:19)</a>:</h4>
<p><span class="user-mention" data-user-id="653479">@jamie jamison</span> I think I should be able to meet late Friday morning or in the afternoon? You'll appreciate that a test server here started inexplicably receiving 403 Forbiddens from AWS S3. No config changes.</p>



<a name="452182509"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/452182509" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#452182509">(Jul 17 2024 at 20:32)</a>:</h4>
<p><span class="user-mention" data-user-id="653479">@jamie jamison</span> on your 403 Forbiddens: did you update your CORS rules per the CORS section of <a href="https://github.com/IQSS/dataverse/releases/v5.12">https://github.com/IQSS/dataverse/releases/v5.12</a> ?</p>



<a name="452189994"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/452189994" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#452189994">(Jul 17 2024 at 20:58)</a>:</h4>
<p>We're still back at getting letsencrypt working but I believe I did since we were at 5.14</p>



<a name="452190083"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/452190083" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#452190083">(Jul 17 2024 at 20:59)</a>:</h4>
<p>We're in a different time zone but morning or afternoon is fine.  Are you on EST?</p>



<a name="452190972"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/452190972" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#452190972">(Jul 17 2024 at 21:03)</a>:</h4>
<p>12:30 or 1pm our time? I'll figure out pst to your time</p>



<a name="452352324"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/452352324" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#452352324">(Jul 18 2024 at 14:00)</a>:</h4>
<p>we're EDT time but I'm getting 403 Forbiddens on a test server, so I'm interesting in comparing notes there.</p>



<a name="452371249"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/452371249" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#452371249">(Jul 18 2024 at 15:13)</a>:</h4>
<p>What's a good time for you?</p>



<a name="452394671"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/452394671" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#452394671">(Jul 18 2024 at 17:05)</a>:</h4>
<p><span class="user-mention" data-user-id="653479">@jamie jamison</span> I have a 9:45 EDT with Sonia, but other than that I'm free. On the 403 forbiddens: how are you defining your S3 credentials?</p>



<a name="452396498"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/452396498" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#452396498">(Jul 18 2024 at 17:15)</a>:</h4>
<p>Dealing with the letsencrypt and certbot somewhat distracted me from the s3 buckets.  I'm getting back to that today</p>



<a name="452417213"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/452417213" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#452417213">(Jul 18 2024 at 18:47)</a>:</h4>
<p>I should add that I need a working system to deal with the s3 buckets and at this time I don't have that.  I'm wondering how other people do their installations or migration installations.  Ansible script or the manual installl.</p>



<a name="453553077"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/453553077" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#453553077">(Jul 23 2024 at 23:51)</a>:</h4>
<p>I have a working test dataverse and some worI hking s3 buckets.  I'm using Oliver Oliver Bertuch's example:<br>
dataverse.files.bucket1.storage-driver-id=s3<br>
<a href="http://dataverse.files.bucket1.s3.xxx">dataverse.files.bucket1.s3.xxx</a><br>
...<br>
dataverse.files.bucket2.storage-driver-id=s3<br>
<a href="http://dataverse.files.bucket2.s3.xxx">dataverse.files.bucket2.s3.xxx</a><br>
...<br>
dataverse.files.bucket3.storage-driver-id=s3<br>
<a href="http://dataverse.files.bucket3.s3.xxx">dataverse.files.bucket3.s3.xxx</a><br>
...<br>
dataverse.files.bucket4.storage-driver-id=s3<br>
<a href="http://dataverse.files.bucket4.s3.xxx">dataverse.files.bucket4.s3.xxx</a></p>
<p>That each bucket needs to have it's own storage-id</p>



<a name="453696664"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/453696664" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#453696664">(Jul 24 2024 at 13:30)</a>:</h4>
<p>It still looks a little off to me but if it's working, great!</p>



<a name="453732783"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/453732783" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#453732783">(Jul 24 2024 at 15:52)</a>:</h4>
<p>The above is example is from <span class="user-mention" data-user-id="598183">@Oliver Bertuch</span> .  I guess what I had been trying to verify is if every bucket needs it's own storage-driver  - it they are all the same storage type.</p>



<a name="455480394"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/455480394" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kristian Allen - UCLA <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#455480394">(Jul 31 2024 at 20:43)</a>:</h4>
<p>Our current theory is to do a fresh install of 6.3 via Ansible (this is working), then migrate the database from 5.14 to 6.3 via Flyway. Does this make sense or does anyone see any areas to be aware of? <br>
The thinking was <a href="https://github.com/IQSS/dataverse/blob/0d279573bb8d7c96d7a4a1dc4b66b2258059dfba/src/main/java/edu/harvard/iq/dataverse/flyway/StartupFlywayMigrator.java#L16">https://github.com/IQSS/dataverse/blob/0d279573bb8d7c96d7a4a1dc4b66b2258059dfba/src/main/java/edu/harvard/iq/dataverse/flyway/StartupFlywayMigrator.java#L16</a> can be run on own? <br>
Or is there a cleaner way to do this via pulling objects out and putting back in via DVN API?</p>



<a name="455483654"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/455483654" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#455483654">(Jul 31 2024 at 21:00)</a>:</h4>
<p>I mean, people have pulled off similar feats but officially we ask that you step through each upgrade. (We know this is painful.)</p>



<a name="455494353"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/455494353" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kristian Allen - UCLA <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#455494353">(Jul 31 2024 at 22:11)</a>:</h4>
<p>I don't think the step through upgrade path would work in our case as our 5.14 instance is on older version of RHEL and we have to move to a new OS (Rocky), so we were trying to determine a path forward</p>



<a name="455514696"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/455514696" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kristian Allen - UCLA <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#455514696">(Aug 01 2024 at 00:48)</a>:</h4>
<p>I think we'll power forward with the manual migration but keep meticulous notes and then we'll make sure to write up for the community</p>



<a name="455626846"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/455626846" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#455626846">(Aug 01 2024 at 11:53)</a>:</h4>
<p><span class="user-mention" data-user-id="736518">@Kristian Allen - UCLA</span> I personally think that your new server is a great spot to migrate/upgrade from 5.14 to 6.0, then carry on to 6.3.</p>



<a name="455655521"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/455655521" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#455655521">(Aug 01 2024 at 13:53)</a>:</h4>
<p><span class="user-mention" data-user-id="736518">@Kristian Allen - UCLA</span> you might be interested in this "Our experience on upgrading dataverse from 4.2.2 to 6.1 in a non-standard way" thread: <a href="https://groups.google.com/g/dataverse-community/c/BUO37-reWIs/m/18SK0DZlAQAJ">https://groups.google.com/g/dataverse-community/c/BUO37-reWIs/m/18SK0DZlAQAJ</a></p>



<a name="456289293"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/456289293" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#456289293">(Aug 04 2024 at 08:50)</a>:</h4>
<p>I have been doing experiments on a similar migration from 4.20 to 6.3 using Flyway only as well.</p>



<a name="456289375"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/456289375" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#456289375">(Aug 04 2024 at 08:51)</a>:</h4>
<p>You can find the necessary extra migrations you will need when using Flyway only here: <a href="https://jugit.fz-juelich.de/fdm/dev/dataverse/-/tree/juelich-data-upgrade/src/main/resources/db/extra?ref_type=heads">https://jugit.fz-juelich.de/fdm/dev/dataverse/-/tree/juelich-data-upgrade/src/main/resources/db/extra?ref_type=heads</a></p>
<p>Obviously, you'll only need the 5.14+ migrations, not the others.</p>



<a name="456289453"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/456289453" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#456289453">(Aug 04 2024 at 08:52)</a>:</h4>
<p>I've also added the Flyway Maven Plugin in this branch to the DV app POM. <a href="https://jugit.fz-juelich.de/fdm/dev/dataverse/-/blob/juelich-data-upgrade/pom.xml?ref_type=heads#L755">https://jugit.fz-juelich.de/fdm/dev/dataverse/-/blob/juelich-data-upgrade/pom.xml?ref_type=heads#L755</a></p>



<a name="456289478"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/456289478" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#456289478">(Aug 04 2024 at 08:52)</a>:</h4>
<p>I can share more details about how I used a few local containers to get the job done if that helps.</p>



<a name="456706212"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/456706212" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#456706212">(Aug 05 2024 at 20:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="626369">Don Sizemore</span> <a href="#narrow/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2/near/455626846">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="736518">Kristian Allen - UCLA</span> I personally think that your new server is a great spot to migrate/upgrade from 5.14 to 6.0, then carry on to 6.3.</p>
</blockquote>
<p><span class="user-mention" data-user-id="626369">@Don Sizemore</span>   I'm trying to install a fresh test 5.14    Directions say "may be installed using branches tagged with that version".  What is the correct syntax to tag the version?</p>
<p>Would this look like:   **</p>
<p>git clone <a href="https://github.com/GlobalDataverseCommunityConsortium/dataverse-ansible.git">https://github.com/GlobalDataverseCommunityConsortium/dataverse-ansible.git</a> dataverse-5.14<br>
**</p>



<a name="456707460"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/456707460" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#456707460">(Aug 05 2024 at 21:06)</a>:</h4>
<p>I might get this wrong, but I believe it refers to the tagging on the Dataverse side.</p>
<p>I think you'd change this from "version:6.3" to whatever version you want but I'm not sure if it "just works": <a href="https://github.com/gdcc/dataverse-ansible/blob/c1e21f255dd00bf5d95c2a6a807ae7579974361b/defaults/main.yml#L264">https://github.com/gdcc/dataverse-ansible/blob/c1e21f255dd00bf5d95c2a6a807ae7579974361b/defaults/main.yml#L264</a></p>



<a name="456713603"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/456713603" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#456713603">(Aug 05 2024 at 21:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="598183">Oliver Bertuch</span> <a href="#narrow/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2/near/456289478">said</a>:</p>
<blockquote>
<p>I can share more details about how I used a few local containers to get the job done if that helps.</p>
</blockquote>
<p><span class="user-mention" data-user-id="598183">@Oliver Bertuch</span>      Yes, some details on how this is used would help.</p>



<a name="456783800"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/456783800" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#456783800">(Aug 06 2024 at 07:08)</a>:</h4>
<p>Ok so here's a quick list of tasks:</p>
<ol>
<li>Make a <code>pg_dump</code> of your current database into a file <code>dump.sql</code></li>
<li>Copy that file to your dev machine (or wherever you have Maven and Java SDK around)</li>
<li>Make sure you have installed Docker on that machine as well (you could also use some arbitrary Linux cloud host if that's easier to get Docker up and running)</li>
<li>Download this <a href="/user_uploads/53090/nUhAgnhM1L4j0k_7OiwsbNtx/compose.yaml">compose.yaml</a> and put it next to your <code>dump.sql</code> file.</li>
<li>Run <code>docker compose up</code> to start a PG container exposed on port 54321</li>
<li>Apply my <a href="https://jugit.fz-juelich.de/fdm/dev/dataverse/-/commit/329ac9f81cae8c727b21effc5f41ed1b7e16f4d3#442292b8a7efeabbe4cc176709b833b1792140ec">POM patch</a> to enable using the Flyway migrations locally</li>
<li>Get all the extra migrations you need that have a version number larger than your current Dataverse version (that'll be <a href="https://jugit.fz-juelich.de/fdm/dev/dataverse/-/commit/329ac9f81cae8c727b21effc5f41ed1b7e16f4d3#4f39728b19a576cb30c5acee5fa1d3495b3e5db4">this one</a> and <a href="https://jugit.fz-juelich.de/fdm/dev/dataverse/-/commit/329ac9f81cae8c727b21effc5f41ed1b7e16f4d3#a2ba977edd2c98f6f426ad7519b2693e283f6dd1">this one</a> and put them under <code>src/main/resources/db/extra</code></li>
<li>Now checkout the Flyway migrations missing from the containerized DB: <code>mvn flyway:info</code>. You should see that some migrations are missing.</li>
<li>Now apply the migrations: <code>mvn flyway:migrate -Dflyway.outOfOrder</code></li>
<li>Check migrations again, should be all applied now: <code>mvn flyway:info</code></li>
<li>Now move the migrations from the <code>extra</code> folder or comment out that location in the POM - the idea is to make them unavailable again, as we don't want them around for all eternity or during the next upgrade.</li>
<li>Now let's remove these migrations to be 100% upstream compatible again: <code>mvn flyway:repair</code></li>
<li>Running <code>mvn flyway:info</code> again should no longer list our two extra migrations!</li>
<li>Now make another dump of the migrated database: <code>docker exec -it data-next-postgres pg_dump -U dataverse &gt; dump-v6.3.sql</code></li>
<li>You can load this database into some other Postgres database now and deploy Dataverse 6.3, configuring DV to use this DB.</li>
<li>Cleanup by running <code>docker compose down</code></li>
</ol>



<a name="456845402"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/456845402" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#456845402">(Aug 06 2024 at 12:34)</a>:</h4>
<p><span class="user-mention" data-user-id="653479">@jamie jamison</span> you want to clone the 5.14 branch: <code>$ git clone -b 5.14 https://github.com/gdcc/dataverse-ansible.git 5.14</code></p>



<a name="456955471"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/456955471" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#456955471">(Aug 06 2024 at 21:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="626369">Don Sizemore</span> <a href="#narrow/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2/near/456845402">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="653479">jamie jamison</span> you want to clone the 5.14 branch: <code>$ git clone -b 5.14 https://github.com/gdcc/dataverse-ansible.git 5.14</code></p>
</blockquote>
<p>Tried that and ran ansible:  **</p>
<p>ansible-playbook --connection=local -vvv -i 5.14/inventory 5.14/dataverse.pb -e "@5.14/defaults/main.yml"<br>
**<br>
Unfortunately failed at  step: [dataverse : install java-nnn-openjdk and other packages for RedHat/Rocky] <strong>*</strong><strong>*</strong><strong>*</strong><strong>*</strong><strong>*</strong><strong>*</strong><strong>*</strong><strong>*</strong>task path: /home/rocky/dataverse/tasks/dataverse-prereqs.yml:63</p>
<p>Huge, long error message.  Don't know if you want to see that.</p>



<a name="456955715"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/456955715" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#456955715">(Aug 06 2024 at 21:08)</a>:</h4>
<p>Possible java verson error:    **</p>
<p>fatal: [localhost]: FAILED! =&gt; {</p>
<p>"msg": "An unhandled exception occurred while templating '{'version': 11, 'home': '/usr/lib/jvm/java-{{ java.version}}'}'. Error was a &lt;class 'ansible.errors.AnsibleError'&gt;, original<br>
**</p>



<a name="456980437"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/456980437" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#456980437">(Aug 07 2024 at 00:27)</a>:</h4>
<p><span class="user-mention" data-user-id="653479">@jamie jamison</span> sigh. that again. someone else introduced a reflexive group_var without testing the role. two quick fixes could be to either edit tasks/dataverse-prereqs.yml and hard-code <code>11</code> or better yet in group_vars for the <code>java.home</code> variable - either should get you going. Solr mirrors tend to remove old versions, so if it dies downloading Solr, you can give it a custom Solr download url in group_vars pointing to <a href="http://archive.apache.org">archive.apache.org</a>.</p>



<a name="459302996"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/Upgrading%205.14%20to%206.2/near/459302996" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/Upgrading.205.2E14.20to.206.2E2.html#459302996">(Aug 08 2024 at 22:17)</a>:</h4>
<p>I finally was able to restore the test.dataverse 5.14 from an aws snapshot.   I'm going to keep the notes on restring earlier versions.  Might be helpful for other projects.</p>



<hr><p>Last updated: Nov 01 2025 at 23:12 UTC</p>
</html>