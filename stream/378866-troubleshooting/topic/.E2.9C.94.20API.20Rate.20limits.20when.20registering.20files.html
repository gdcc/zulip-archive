<html>
<head><meta charset="utf-8"><title>âœ” API Rate limits when registering files Â· troubleshooting Â· Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/index.html">troubleshooting</a></h2>
<h3>Topic: <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html">âœ” API Rate limits when registering files</a></h3>

<hr>

<base href="https://dataverse.zulipchat.com">

<head><link href="https://gdcc.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="423805309"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20API%20Rate%20limits%20when%20registering%20files/near/423805309" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html#423805309">(Feb 28 2024 at 12:12)</a>:</h4>
<p>Hi @all, I have encountered issues registering many files after directly uploading to an S3 storage. </p>
<p>For context, upon direct upload the python-dvuploader library first uploads all files to the storage using the ticket system and then registers each file asynchronously at the instance. This is where I am running into, I guess, rate-limiting problems. The library that I am using throws an exception that the connection is closed and I suspect that it's simply too many requests at once or too frequent.</p>
<p>Hence, my question is, how many concurrent requests are reasonable to handle by the backend and roughly how many per minute? I am trying to find a good default that can fit most instances equally well while being somewhat performant, compared to synchronous requests. </p>
<p>I've been testing this with demo Dataverse and locally using the docker compose variant with localstack. In both cases I have encountered this issue.</p>



<a name="423806818"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20API%20Rate%20limits%20when%20registering%20files/near/423806818" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html#423806818">(Feb 28 2024 at 12:23)</a>:</h4>
<p>I'm reminded of this cartoon. <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> <br>
<a href="/user_uploads/53090/ztcTVfLT181McxvvWKyNtbc1/bridge.png">bridge.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/53090/ztcTVfLT181McxvvWKyNtbc1/bridge.png" title="bridge.png"><img src="/user_uploads/53090/ztcTVfLT181McxvvWKyNtbc1/bridge.png"></a></div>



<a name="423807267"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20API%20Rate%20limits%20when%20registering%20files/near/423807267" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html#423807267">(Feb 28 2024 at 12:26)</a>:</h4>
<p>Well, then it is time to load up the trucks <span aria-label="joy" class="emoji emoji-1f602" role="img" title="joy">:joy:</span></p>



<a name="423807401"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20API%20Rate%20limits%20when%20registering%20files/near/423807401" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html#423807401">(Feb 28 2024 at 12:27)</a>:</h4>
<p>I'd say so. We'll learn something!</p>



<a name="423836151"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20API%20Rate%20limits%20when%20registering%20files/near/423836151" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html#423836151">(Feb 28 2024 at 14:57)</a>:</h4>
<p>So I did a little more testing and tried with a larger amount of files (1000 small ones) and looked into the Dataverse logs. Once more than one request is sent simultaneously, the dataset goes into a lock. Plus, I am not able to remove the lock via the UI. If done synchronously, there is no issue and lock.</p>
<p>Do you know what could be the cause of this? I have added the logs below:</p>
<div class="codehilite"><pre><span></span><code>2024-02-28 15:52:03 dev_dataverse   | [#|2024-02-28T14:52:03.794+0000|SEVERE|Payara 6.2023.8|edu.harvard.iq.dataverse.datasetutility.AddReplaceFileHelper|_ThreadID=104;_ThreadName=http-thread-pool::http-listener-1(5);_TimeMillis=1709131923794;_LevelValue=1000;|
2024-02-28 15:52:03 dev_dataverse   |   Failed to add file to dataset.|#]
2024-02-28 15:52:03 dev_dataverse   |
2024-02-28 15:52:03 dev_dataverse   | [#|2024-02-28T14:52:03.795+0000|SEVERE|Payara 6.2023.8|edu.harvard.iq.dataverse.datasetutility.AddReplaceFileHelper|_ThreadID=104;_ThreadName=http-thread-pool::http-listener-1(5);_TimeMillis=1709131923795;_LevelValue=1000;|
2024-02-28 15:52:03 dev_dataverse   |   Dataset cannot be edited due to dataset lock.|#]
</code></pre></div>



<a name="423858599"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20API%20Rate%20limits%20when%20registering%20files/near/423858599" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html#423858599">(Feb 28 2024 at 16:39)</a>:</h4>
<p>Sadly, I'm sort of not surprised that you're getting locks when sending files asynchronously.</p>



<a name="423858720"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20API%20Rate%20limits%20when%20registering%20files/near/423858720" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html#423858720">(Feb 28 2024 at 16:39)</a>:</h4>
<p>What do you want to know the cause of? The locks? Or why you can't remove them? Or why you have to upload files synchronously? Or all of the above? <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="423867000"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20API%20Rate%20limits%20when%20registering%20files/near/423867000" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html#423867000">(Feb 28 2024 at 17:24)</a>:</h4>
<p>Have you tried this? <a href="https://guides.dataverse.org/en/6.1/developers/s3-direct-upload-api.html#to-add-multiple-uploaded-files-to-the-dataset">https://guides.dataverse.org/en/6.1/developers/s3-direct-upload-api.html#to-add-multiple-uploaded-files-to-the-dataset</a></p>



<a name="423868351"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20API%20Rate%20limits%20when%20registering%20files/near/423868351" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html#423868351">(Feb 28 2024 at 17:32)</a>:</h4>
<p>Sometimes you can't see the forest for the trees <span aria-label="dizzy" class="emoji emoji-1f635" role="img" title="dizzy">:dizzy:</span> That did the trick! Thanks Phil <img alt=":dataverse_man:" class="emoji" src="https://zulip-avatars.s3.amazonaws.com/53090/emoji/images/44207.png" title="dataverse man"></p>



<a name="423869388"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20API%20Rate%20limits%20when%20registering%20files/near/423869388" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html#423869388">(Feb 28 2024 at 17:38)</a>:</h4>
<p>Fantastic! <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span></p>



<a name="423869416"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20API%20Rate%20limits%20when%20registering%20files/near/423869416" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html#423869416">(Feb 28 2024 at 17:38)</a>:</h4>
<p>Jim wrote the code. I'm just the messenger. <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="423869443"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20API%20Rate%20limits%20when%20registering%20files/near/423869443" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html#423869443">(Feb 28 2024 at 17:39)</a>:</h4>
<p>Should we improve the docs somehow? <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="423871626"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20API%20Rate%20limits%20when%20registering%20files/near/423871626" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html#423871626">(Feb 28 2024 at 17:52)</a>:</h4>
<p>It's working flawlessly now, even with a bunch of files! Thanks again <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>
<p><a href="/user_uploads/53090/Fe8FHzd9Y48FKdlr20zajTga/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/53090/Fe8FHzd9Y48FKdlr20zajTga/image.png" title="image.png"><img src="/user_uploads/53090/Fe8FHzd9Y48FKdlr20zajTga/image.png"></a></div>



<a name="423871712"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20API%20Rate%20limits%20when%20registering%20files/near/423871712" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html#423871712">(Feb 28 2024 at 17:52)</a>:</h4>
<p>Great!</p>



<a name="423871741"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20API%20Rate%20limits%20when%20registering%20files/near/423871741" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html#423871741">(Feb 28 2024 at 17:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="598112">Philip Durbin</span> <a href="#narrow/stream/378866-troubleshooting/topic/API.20Rate.20limits.20when.20registering.20files/near/423869443">schrieb</a>:</p>
<blockquote>
<p>Should we improve the docs somehow? <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>
</blockquote>
<p>No, I think this was just my fault here. I was thinking that the default file add endpoint is used and assumed that this is the only way. You never stop learning <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="423871982"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20API%20Rate%20limits%20when%20registering%20files/near/423871982" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html#423871982">(Feb 28 2024 at 17:54)</a>:</h4>
<p>Ok, well, this should probably go in a new thread but I've been thinking that perhaps we need more tutorials in the API Guide.</p>



<a name="423872085"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20API%20Rate%20limits%20when%20registering%20files/near/423872085" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html#423872085">(Feb 28 2024 at 17:54)</a>:</h4>
<p>We have <a href="https://guides.dataverse.org/en/6.1/api/getting-started.html#uploading-files">https://guides.dataverse.org/en/6.1/api/getting-started.html#uploading-files</a> but it only references the default way.</p>



<a name="423956027"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20API%20Rate%20limits%20when%20registering%20files/near/423956027" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html#423956027">(Feb 29 2024 at 06:09)</a>:</h4>
<p>I think that listing the direct upload feature would also be good. At the very least, it raises awareness of its existence. The sentence within the Native API docs would be sufficient to add to the "uploading files" guide:</p>
<blockquote>
<p>when a Dataverse installation is configured to use S3 storage with direct upload enabled, there is API support to send a file directly to S3. This is more complex and is described in the Direct DataFile Upload/Replace API guide.</p>
</blockquote>



<a name="424000321"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20API%20Rate%20limits%20when%20registering%20files/near/424000321" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html#424000321">(Feb 29 2024 at 11:31)</a>:</h4>
<p>Sounds good. Do you want to make a PR?</p>



<a name="424174173"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20API%20Rate%20limits%20when%20registering%20files/near/424174173" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html#424174173">(Mar 01 2024 at 07:36)</a>:</h4>
<p>Of course, just opened a PR for this </p>
<p><a href="https://github.com/IQSS/dataverse/pull/10347">https://github.com/IQSS/dataverse/pull/10347</a></p>



<a name="424210043"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20API%20Rate%20limits%20when%20registering%20files/near/424210043" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html#424210043">(Mar 01 2024 at 11:11)</a>:</h4>
<p>Thanks! <span aria-label="heart" class="emoji emoji-2764" role="img" title="heart">:heart:</span> I'm making a couple minor tweaks.</p>



<a name="424220834"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20API%20Rate%20limits%20when%20registering%20files/near/424220834" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html#424220834">(Mar 01 2024 at 12:04)</a>:</h4>
<p>Merged! Thanks again!</p>



<a name="424276742"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20API%20Rate%20limits%20when%20registering%20files/near/424276742" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html#424276742">(Mar 01 2024 at 16:06)</a>:</h4>
<p>Awesome! Thanks <span aria-label="heart" class="emoji emoji-2764" role="img" title="heart">:heart:</span></p>



<a name="424276781"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20API%20Rate%20limits%20when%20registering%20files/near/424276781" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20API.20Rate.20limits.20when.20registering.20files.html#424276781">(Mar 01 2024 at 16:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="599841">Jan Range</span> has marked this topic as resolved.</p>



<hr><p>Last updated: Mar 02 2026 at 13:56 UTC</p>
</html>