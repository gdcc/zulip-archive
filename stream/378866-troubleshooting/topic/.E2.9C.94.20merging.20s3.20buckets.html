<html>
<head><meta charset="utf-8"><title>âœ” merging s3 buckets Â· troubleshooting Â· Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/index.html">troubleshooting</a></h2>
<h3>Topic: <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20merging.20s3.20buckets.html">âœ” merging s3 buckets</a></h3>

<hr>

<base href="https://dataverse.zulipchat.com">

<head><link href="https://gdcc.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="473805562"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20merging%20s3%20buckets/near/473805562" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20merging.20s3.20buckets.html#473805562">(Sep 30 2024 at 17:28)</a>:</h4>
<p>We still have some separate s3 buckets for direct upload and original buckets.  I'd like to get some of these merged to one bucket.  </p>
<p>I didn't see bucket merging mentioned in documentation.  Is there anything I should be planning or doing for this?</p>
<p>Thank you,</p>
<p>Jamie</p>



<a name="473816435"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20merging%20s3%20buckets/near/473816435" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20merging.20s3.20buckets.html#473816435">(Sep 30 2024 at 18:15)</a>:</h4>
<p>I should probably explain.  Earlier version of Dataverse required a separate s3 bucket for direct uploads.  SInce that is no longer the case I'm trying to clean that up now.</p>



<a name="473818493"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20merging%20s3%20buckets/near/473818493" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20merging.20s3.20buckets.html#473818493">(Sep 30 2024 at 18:26)</a>:</h4>
<p>Yeah, it makes sense. I just don't have experience with doing such a clean up. <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="473820642"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20merging%20s3%20buckets/near/473820642" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20merging.20s3.20buckets.html#473820642">(Sep 30 2024 at 18:34)</a>:</h4>
<p>I'm going to try with a couple of buckets on the test system but was hoping to hear about anyone else's experience.</p>



<a name="473824479"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20merging%20s3%20buckets/near/473824479" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20merging.20s3.20buckets.html#473824479">(Sep 30 2024 at 18:46)</a>:</h4>
<p><span class="user-mention" data-user-id="626369">@Don Sizemore</span>  Have you run across this issue?</p>



<a name="473830963"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20merging%20s3%20buckets/near/473830963" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20merging.20s3.20buckets.html#473830963">(Sep 30 2024 at 19:17)</a>:</h4>
<p>maybe <span class="user-mention" data-user-id="598843">@Deirdre Kirmis</span> has <span aria-label="shrug" class="emoji emoji-1f937" role="img" title="shrug">:shrug:</span></p>



<a name="473832251"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20merging%20s3%20buckets/near/473832251" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20merging.20s3.20buckets.html#473832251">(Sep 30 2024 at 19:22)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="598843">@Deirdre Kirmis</span>   Have you ever run across this issue - merging s3 buckets.</p>



<a name="473841429"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20merging%20s3%20buckets/near/473841429" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Deirdre Kirmis <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20merging.20s3.20buckets.html#473841429">(Sep 30 2024 at 19:59)</a>:</h4>
<p>We have always used only 1 bucket, but with separate 'stores' defined for direct upload. However, I think if you copy all of the folders/prefixes to one bucket, as long as you change the defined stores in your JVM options to point to the "new" bucket you should be okay. Or, if you just have the one store defined (ie: the merged store) .. you will just have to change the "storageidentifier" in the "dvobject" table to reflect the correct store that you have defined for each file.  Does that make sense?</p>



<a name="473842798"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20merging%20s3%20buckets/near/473842798" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Deirdre Kirmis <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20merging.20s3.20buckets.html#473842798">(Sep 30 2024 at 20:03)</a>:</h4>
<p>I think what i mean is, whatever is defined in the dvobject table as the storageidentier for the files should match the "store" that is defined in the domain.xml file. As long as that store points to the correct bucket it should work. Does that seem correct?</p>



<a name="473844400"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20merging%20s3%20buckets/near/473844400" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20merging.20s3.20buckets.html#473844400">(Sep 30 2024 at 20:07)</a>:</h4>
<p>Sounds correct to me.</p>



<a name="473847207"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20merging%20s3%20buckets/near/473847207" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20merging.20s3.20buckets.html#473847207">(Sep 30 2024 at 20:19)</a>:</h4>
<p>Yes, makes perfect sense. Thank you!</p>



<a name="474026948"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20merging%20s3%20buckets/near/474026948" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20merging.20s3.20buckets.html#474026948">(Oct 01 2024 at 12:40)</a>:</h4>
<p><span class="user-mention" data-user-id="653479">@jamie jamison</span> Deirdre is correct - you just want the datafiles where the <code>storageidentifier</code> field in the dvobject table points. there is some migration SQL in the bottom of Julian's "Helpful SQL queries" Google document that may help you do what you need.</p>



<a name="474027614"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20merging%20s3%20buckets/near/474027614" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Don Sizemore <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20merging.20s3.20buckets.html#474027614">(Oct 01 2024 at 12:43)</a>:</h4>
<p><span class="user-mention" data-user-id="653479">@jamie jamison</span> see the "storage migration" queries at the bottom of <a href="https://docs.google.com/document/d/1-Y_iUduSxdDNeK1yiGUxe7t-Md7Fy965jp4o4m1XEoE/edit#heading=h.avuoo5kf0mdt">https://docs.google.com/document/d/1-Y_iUduSxdDNeK1yiGUxe7t-Md7Fy965jp4o4m1XEoE/edit#heading=h.avuoo5kf0mdt</a> - once you copy the datafiles into place where you want them, you would use queries like these to update the storageidentifier field?</p>



<a name="474097479"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20merging%20s3%20buckets/near/474097479" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20merging.20s3.20buckets.html#474097479">(Oct 01 2024 at 18:08)</a>:</h4>
<p>Have to deal with production being down and then will get back to this.  Thank you for all the info.</p>



<a name="474635136"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20merging%20s3%20buckets/near/474635136" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamie jamison <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20merging.20s3.20buckets.html#474635136">(Oct 03 2024 at 16:32)</a>:</h4>
<p>On the test system it looks like moving the buckets worked.  Thank you all for the input.</p>



<a name="474635242"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/378866-troubleshooting/topic/%E2%9C%94%20merging%20s3%20buckets/near/474635242" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://gdcc.github.io/zulip-archive/stream/378866-troubleshooting/topic/.E2.9C.94.20merging.20s3.20buckets.html#474635242">(Oct 03 2024 at 16:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="653479">jamie jamison</span> has marked this topic as resolved.</p>



<hr><p>Last updated: Mar 02 2026 at 13:56 UTC</p>
</html>