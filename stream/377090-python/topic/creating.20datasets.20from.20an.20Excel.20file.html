<html>
<head><meta charset="utf-8"><title>creating datasets from an Excel file Â· python Â· Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/index.html">python</a></h2>
<h3>Topic: <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html">creating datasets from an Excel file</a></h3>

<hr>

<base href="https://dataverse.zulipchat.com">

<head><link href="https://gdcc.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="493598393"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/493598393" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#493598393">(Jan 14 2025 at 14:32)</a>:</h4>
<p>Given an Excel file with columns like "dataset title", "description", etc., what's the recommended way to create datasets using Python? pyDataverse? EasyDataverse? Something else?</p>



<a name="493622400"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/493622400" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Julian Gautier <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#493622400">(Jan 14 2025 at 16:24)</a>:</h4>
<p>So great you asked this today! I was just talking with the manager of a collection about this, but for editing the metadata of multiple datasets. I pointed them to pyDataverse documentation and the advanced usage page, which mentions using their csv templates. Seems like you can create and edit dataset metadata that way. I've never got it to work, but always figured I didn't know enough about Python <span aria-label="grimacing" class="emoji emoji-1f62c" role="img" title="grimacing">:grimacing:</span></p>



<a name="493622477"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/493622477" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#493622477">(Jan 14 2025 at 16:25)</a>:</h4>
<p>In practice I'm using EasyDataverse. I'll push my script to GitHub soon.</p>



<a name="493892361"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/493892361" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GwenaÃ«l Doux <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#493892361">(Jan 15 2025 at 10:25)</a>:</h4>
<p>Wouldn't it be interesting to have a (community) repository  with examples of concrete cases using python or easyDataverse? For people who aren't necessarily developers but can modify scripts. There could also be an entry somewhere in the documentation, in <a href="https://guides.dataverse.org/en/latest/admin/reporting-tools-and-queries.html#reporting-tools-and-common-queries">https://guides.dataverse.org/en/latest/admin/reporting-tools-and-queries.html#reporting-tools-and-common-queries</a> for example.</p>



<a name="493917714"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/493917714" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#493917714">(Jan 15 2025 at 12:44)</a>:</h4>
<p>Yes, absolutely. Great idea. I'm not sure where these scripts should go.</p>



<a name="493919050"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/493919050" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#493919050">(Jan 15 2025 at 12:51)</a>:</h4>
<p>We could host a repository that includes Jupyter notebooks with examples. The upside is that these can be used pretty nicely within an mkdocs documentation. Did this for my latest <a href="https://github.com/JR-1991/PythonProgrammingBio24">Python course</a> (<a href="https://jr-1991.github.io/PythonProgrammingBio24/">Doc Page</a>)</p>



<a name="493959009"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/493959009" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#493959009">(Jan 15 2025 at 15:53)</a>:</h4>
<p><span class="user-mention" data-user-id="599841">@Jan Range</span> we forgot to talk about this today! Where to put scripts, I mean. Next time. <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span> (<a class="stream-topic" data-stream-id="377090" href="/#narrow/channel/377090-python/topic/meetings">#python &gt; meetings</a>)</p>



<a name="493972572"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/493972572" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#493972572">(Jan 15 2025 at 16:49)</a>:</h4>
<p>I'm still not quite sure where to put this script but I'll go ahead and attach it here so people can see it: <a href="/user_uploads/53090/_9D6dP9em2gUcaeMkSC5OHKt/create-datasets-from-excel.py">create-datasets-from-excel.py</a></p>



<a name="493972812"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/493972812" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#493972812">(Jan 15 2025 at 16:50)</a>:</h4>
<p>This is a slightly redacted version but quite similar to the one we plan to use.</p>



<a name="493972901"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/493972901" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#493972901">(Jan 15 2025 at 16:50)</a>:</h4>
<p>Note that we plan to fix the license issue mentioned in the script. The discussion is happening here: <a class="stream-topic" data-stream-id="377090" href="/#narrow/channel/377090-python/topic/setting.20a.20license.20with.20EasyDataverse">#python &gt; setting a license with EasyDataverse</a></p>



<a name="493983721"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/493983721" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#493983721">(Jan 15 2025 at 17:47)</a>:</h4>
<p>We could open a general repository. Maybe something along the lines of "Dataverse Recipes" - Could then be used for Python and other languages.</p>



<a name="493992521"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/493992521" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#493992521">(Jan 15 2025 at 18:36)</a>:</h4>
<p>Back in the day, Perl had a cookbook: <a href="https://en.wikipedia.org/wiki/Perl_Cookbook">https://en.wikipedia.org/wiki/Perl_Cookbook</a> <span aria-label="cook" class="emoji emoji-1f9d1-200d-1f373" role="img" title="cook">:cook:</span></p>



<a name="494016655"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/494016655" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#494016655">(Jan 15 2025 at 21:05)</a>:</h4>
<p>It looks like <a href="https://github.com/ubc-library-rc/dataverse_utils">https://github.com/ubc-library-rc/dataverse_utils</a> is still being maintained. We link to it from <a href="https://guides.dataverse.org/en/6.5/api/client-libraries.html#python">https://guides.dataverse.org/en/6.5/api/client-libraries.html#python</a></p>
<p>All commits by Paul Lesack, it looks like. I don't think he's on Zulip but here's his GitHub: <a href="https://github.com/plesubc">https://github.com/plesubc</a></p>



<a name="494017179"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/494017179" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#494017179">(Jan 15 2025 at 21:09)</a>:</h4>
<p>From the perspective of the person trying to get something with Python, it probably doesn't matter if  there's a mix of examples that use pyDataverse, EasyDataverse, requests, the standard library, etc.</p>



<a name="494017427"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/494017427" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#494017427">(Jan 15 2025 at 21:10)</a>:</h4>
<p>We had an intern suggest that we add even more Python snippets to the API Guide in <a href="https://github.com/IQSS/dataverse/issues/4255">https://github.com/IQSS/dataverse/issues/4255</a> but we resisted this. We have been trying to keep the API Guide agnostic when it comes to language. So we document everything with curl.</p>



<a name="494017622"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/494017622" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#494017622">(Jan 15 2025 at 21:11)</a>:</h4>
<p><span class="user-mention" data-user-id="626369">@Don Sizemore</span> you also have <a href="https://github.com/uncch-rdmc/dataverse-toolbox">https://github.com/uncch-rdmc/dataverse-toolbox</a></p>



<a name="494017831"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/494017831" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#494017831">(Jan 15 2025 at 21:13)</a>:</h4>
<p>Whether it's that "dataverse_utils" repo or that "dataverse-toolbox" repo, I think it's the right approach, to have a separate repo, rather than trying to maintain these scripts as part of the API Guide.</p>



<a name="494018984"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/494018984" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#494018984">(Jan 15 2025 at 21:20)</a>:</h4>
<p>I agree, a separate repo is a cleaner solution and easier in terms of maintenance. What do you think of the idea of having a documentation on top of it, like I did for the Python course?</p>
<p>Docs - <a href="https://jr-1991.github.io/PythonProgrammingBio24/">https://jr-1991.github.io/PythonProgrammingBio24/</a><br>
Repo - <a href="https://github.com/JR-1991/PythonProgrammingBio24">https://github.com/JR-1991/PythonProgrammingBio24</a></p>
<p>Jupyter notebooks integrate quite well into MkDocs and could essentially function as doc and recipe at the same time. Plus, we could add a CI that tests these using the DV Action by running the notebooks. So, when something falls out of sync we know  it.</p>



<a name="494019115"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/494019115" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#494019115">(Jan 15 2025 at 21:21)</a>:</h4>
<p>Sure! Docs on top sounds great!</p>



<a name="494019332"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/494019332" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#494019332">(Jan 15 2025 at 21:23)</a>:</h4>
<p>And no objection to CI, of course! Fancy! <span aria-label="unicorn" class="emoji emoji-1f984" role="img" title="unicorn">:unicorn:</span></p>



<a name="494221255"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/494221255" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#494221255">(Jan 16 2025 at 19:43)</a>:</h4>
<p>I created a dedicated topic for this: <a class="stream-topic" data-stream-id="377090" href="/#narrow/channel/377090-python/topic/a.20place.20for.20Python.20scripts">#python &gt; a place for Python scripts</a></p>



<a name="494221284"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/494221284" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#494221284">(Jan 16 2025 at 19:43)</a>:</h4>
<p>Now we can keep talking about Excel if we like. <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="494324896"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/494324896" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GwenaÃ«l Doux <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#494324896">(Jan 17 2025 at 10:08)</a>:</h4>
<p>Sorry for the hijacking</p>



<a name="494357126"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/494357126" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#494357126">(Jan 17 2025 at 13:08)</a>:</h4>
<p>Ha, no problem. <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="494357183"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/494357183" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#494357183">(Jan 17 2025 at 13:08)</a>:</h4>
<p>We have a place now! See <a class="stream-topic" data-stream-id="377090" href="/#narrow/channel/377090-python/topic/a.20place.20for.20Python.20scripts">#python &gt; a place for Python scripts</a></p>



<a name="502052243"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502052243" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502052243">(Feb 26 2025 at 13:53)</a>:</h4>
<p><span class="user-mention" data-user-id="599841">@Jan Range</span> thanks for <a href="https://github.com/gdcc/dataverse-recipes/pull/2">https://github.com/gdcc/dataverse-recipes/pull/2</a> ! Merged! Can you (and others, if you like) please look again at <a href="https://github.com/gdcc/dataverse-recipes/pull/1">https://github.com/gdcc/dataverse-recipes/pull/1</a> ? Thanks!</p>



<a name="502319638"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502319638" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502319638">(Feb 27 2025 at 15:56)</a>:</h4>
<p>Heads up that I closed PR#1 in favor of this one: <a href="https://github.com/gdcc/dataverse-recipes/pull/4">https://github.com/gdcc/dataverse-recipes/pull/4</a></p>



<a name="502320274"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502320274" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502320274">(Feb 27 2025 at 15:58)</a>:</h4>
<p>I'm having a little trouble with Excel actually. When I use the original file Sonia gave me, I'm able to extract the hyperlinks.</p>
<p>However, if I edit the file in Excel to edit the hyperlinks (to make them anonymous), the script can no longer extract them.</p>



<a name="502320375"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502320375" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502320375">(Feb 27 2025 at 15:59)</a>:</h4>
<p><span class="user-mention" data-user-id="599841">@Jan Range</span> or others, I'm happy to send you the original file if you want to play with it.</p>



<a name="502324429"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502324429" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502324429">(Feb 27 2025 at 16:16)</a>:</h4>
<p>Happy to check this <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="502600197"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502600197" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502600197">(Feb 28 2025 at 15:09)</a>:</h4>
<p>Maybe I should add a comment saying that the hyperlink extraction doesn't work with the sample file. What do you think?</p>



<a name="502602898"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502602898" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502602898">(Feb 28 2025 at 15:21)</a>:</h4>
<p>Is the <code>data_example.xlsx</code>causing the issue?</p>



<a name="502602957"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502602957" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502602957">(Feb 28 2025 at 15:21)</a>:</h4>
<p>Tested it outside the script and the extraction is working. Looking through your script now.</p>



<a name="502602980"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502602980" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502602980">(Feb 28 2025 at 15:21)</a>:</h4>
<p>Oh! Interesting.</p>



<a name="502603061"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502603061" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502603061">(Feb 28 2025 at 15:22)</a>:</h4>
<p>Please try it with my script. It doesn't work for me. If you can get it working, great!</p>



<a name="502603096"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502603096" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502603096">(Feb 28 2025 at 15:22)</a>:</h4>
<p><a href="/user_uploads/53090/DbJKgy6XrvHA1wf14K1kUah2/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/53090/DbJKgy6XrvHA1wf14K1kUah2/image.png" title="image.png"><img data-original-content-type="image/png" data-original-dimensions="2316x1378" src="/user_uploads/thumbnail/53090/DbJKgy6XrvHA1wf14K1kUah2/image.png/840x560.webp"></a></div>



<a name="502603124"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502603124" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502603124">(Feb 28 2025 at 15:22)</a>:</h4>
<p>Or we could even switch to your way.</p>



<a name="502603173"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502603173" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502603173">(Feb 28 2025 at 15:22)</a>:</h4>
<p>Yes, will do. Wanted to sort out the openpyxl stuff beforehand</p>



<a name="502603216"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502603216" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502603216">(Feb 28 2025 at 15:23)</a>:</h4>
<p>Got it!</p>



<a name="502603299"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502603299" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502603299">(Feb 28 2025 at 15:23)</a>:</h4>
<p>pandas is probably more standard anyway <span aria-label="shrug" class="emoji emoji-1f937" role="img" title="shrug">:shrug:</span></p>



<a name="502603470"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502603470" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502603470">(Feb 28 2025 at 15:24)</a>:</h4>
<p>The issue lies in the following:</p>
<div class="codehilite" data-code-language="Python"><pre><span></span><code><span class="k">if</span> <span class="n">values</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">hyperlink</span><span class="p">:</span>
        <span class="n">access_link_url</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">hyperlink</span><span class="o">.</span><span class="n">display</span> <span class="c1"># &lt;-- Extracts the shown text</span>
</code></pre></div>
<p>It should work by using</p>
<div class="codehilite" data-code-language="Python"><pre><span></span><code><span class="k">if</span> <span class="n">values</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">hyperlink</span><span class="p">:</span>
        <span class="n">access_link_url</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">hyperlink</span><span class="o">.</span><span class="n">target</span> <span class="c1"># &lt;-- Extracts the URL</span>
</code></pre></div>



<a name="502603615"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502603615" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502603615">(Feb 28 2025 at 15:24)</a>:</h4>
<p>That's a good primer for my fresh <em>local</em> DV 6.5 now <span aria-label="stuck out tongue" class="emoji emoji-1f61b" role="img" title="stuck out tongue">:stuck_out_tongue:</span></p>



<a name="502603688"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502603688" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502603688">(Feb 28 2025 at 15:25)</a>:</h4>
<p>Giving it a test on it</p>



<a name="502605123"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502605123" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502605123">(Feb 28 2025 at 15:31)</a>:</h4>
<p>Go, go, go!</p>



<a name="502605898"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502605898" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502605898">(Feb 28 2025 at 15:35)</a>:</h4>
<p>Okay, it works now, but my guess is that it is just some oddity of openpyxl</p>



<a name="502605912"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502605912" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502605912">(Feb 28 2025 at 15:35)</a>:</h4>
<p><a href="/user_uploads/53090/b13fZG7b9M4ycsjBNjyM0S8H/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/53090/b13fZG7b9M4ycsjBNjyM0S8H/image.png" title="image.png"><img data-original-content-type="image/png" data-original-dimensions="1142x732" src="/user_uploads/thumbnail/53090/b13fZG7b9M4ycsjBNjyM0S8H/image.png/840x560.webp"></a></div>



<a name="502606034"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502606034" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502606034">(Feb 28 2025 at 15:35)</a>:</h4>
<p>you got it working? with that change above?</p>



<a name="502606094"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502606094" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502606094">(Feb 28 2025 at 15:36)</a>:</h4>
<p>display vs target?</p>



<a name="502606295"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502606295" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502606295">(Feb 28 2025 at 15:37)</a>:</h4>
<p>The boolean check <code>if value[3].hyperlink:</code> is what has caused the condition to never be true. Hence, there was always <code>None</code>. Being explicit by using <code>value[3].hyperlink is not None</code> works though.</p>



<a name="502606435"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502606435" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502606435">(Feb 28 2025 at 15:37)</a>:</h4>
<p>But in my Jupyter notebook using the exact same way does not cause these issues <span aria-label="shaking face" class="emoji emoji-1fae8" role="img" title="shaking face">:shaking_face:</span></p>



<a name="502606522"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502606522" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502606522">(Feb 28 2025 at 15:38)</a>:</h4>
<p>But why would it work with the original Excel file and not the one I created from scratch?</p>



<a name="502606781"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502606781" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502606781">(Feb 28 2025 at 15:39)</a>:</h4>
<p>I dont know. Strangely, I just fumbled around and reverted the explicit check and now it works too. I am confused :-D</p>



<a name="502606933"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502606933" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502606933">(Feb 28 2025 at 15:40)</a>:</h4>
<p>Feels like rolling dice <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="502607066"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502607066" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502607066">(Feb 28 2025 at 15:40)</a>:</h4>
<p>But yea, using <code>target</code> extracts the link as expected</p>



<a name="502607287"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502607287" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502607287">(Feb 28 2025 at 15:41)</a>:</h4>
<p>Yeah, seems like a good fix. I tested with the original file and my sample. Pushed! Thanks! <a href="https://github.com/gdcc/dataverse-recipes/pull/4/commits/9363ce7d705e490abb5cae0d7a9f8d1b0e977fdf">https://github.com/gdcc/dataverse-recipes/pull/4/commits/9363ce7d705e490abb5cae0d7a9f8d1b0e977fdf</a></p>



<a name="502607607"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502607607" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502607607">(Feb 28 2025 at 15:43)</a>:</h4>
<p>Anything else to fix before we merge it?</p>



<a name="502607702"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502607702" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan Range <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502607702">(Feb 28 2025 at 15:43)</a>:</h4>
<p>Runs fine on my machine, nothing to fix from my side <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="502607862"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/377090-python/topic/creating%20datasets%20from%20an%20Excel%20file/near/502607862" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin ðŸš€ <a href="https://gdcc.github.io/zulip-archive/stream/377090-python/topic/creating.20datasets.20from.20an.20Excel.20file.html#502607862">(Feb 28 2025 at 15:44)</a>:</h4>
<p>Merged!</p>



<hr><p>Last updated: Mar 02 2026 at 13:56 UTC</p>
</html>