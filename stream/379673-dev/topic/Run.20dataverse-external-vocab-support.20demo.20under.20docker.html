<html>
<head><meta charset="utf-8"><title>Run dataverse-external-vocab-support demo under docker · dev · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://gdcc.github.io/zulip-archive/stream/379673-dev/index.html">dev</a></h2>
<h3>Topic: <a href="https://gdcc.github.io/zulip-archive/stream/379673-dev/topic/Run.20dataverse-external-vocab-support.20demo.20under.20docker.html">Run dataverse-external-vocab-support demo under docker</a></h3>

<hr>

<base href="https://dataverse.zulipchat.com">

<head><link href="https://gdcc.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="432645435"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/379673-dev/topic/Run%20dataverse-external-vocab-support%20demo%20under%20docker/near/432645435" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> luddaniel <a href="https://gdcc.github.io/zulip-archive/stream/379673-dev/topic/Run.20dataverse-external-vocab-support.20demo.20under.20docker.html#432645435">(Apr 11 2024 at 07:43)</a>:</h4>
<p>Hello :) I have been contacted by <span class="user-mention" data-user-id="700599">@Aamir Muhammad</span> on CVOC subject and he would like to get a first experience under docker. Thought it would be great to have a basic starter kit, so here is a procedure to enable demo files of <a href="https://github.com/gdcc/dataverse-external-vocab-support">https://github.com/gdcc/dataverse-external-vocab-support</a> project :</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code><span class="c1"># usual docker start</span>
mvn<span class="w"> </span>-Pct<span class="w"> </span>clean<span class="w"> </span>package<span class="w"> </span>docker:run

<span class="c1"># add cvocdemo.tsv</span>
wget<span class="w"> </span>https://raw.githubusercontent.com/gdcc/dataverse-external-vocab-support/main/examples/metadatablocks/cvocdemo.tsv<span class="w"> </span>-O<span class="w"> </span>/tmp/cvocdemo.tsv
docker<span class="w"> </span>cp<span class="w"> </span>/tmp/cvocdemo.tsv<span class="w"> </span>dataverse-1:/opt/payara/file.tsv
docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>dataverse-1<span class="w"> </span>curl<span class="w"> </span>http://localhost:8080/api/admin/datasetfield/load<span class="w"> </span>-H<span class="w"> </span><span class="s2">"Content-type: text/tab-separated-values"</span><span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>--data-binary<span class="w"> </span>@/opt/payara/file.tsv

<span class="c1"># http://localhost:8080/dataverseuser.xhtml?selectTab=apiTokenTab to get API TOKEN</span>
curl<span class="w"> </span>-H<span class="w"> </span><span class="s2">"X-Dataverse-key:</span><span class="nv">$API_TOKEN</span><span class="s2">"</span><span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>-H<span class="w"> </span><span class="s2">"Content-type:application/json"</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">"[\"citation\",\"extVocabDemoMetadata\"]"</span><span class="w"> </span>http://localhost:8080/api/dataverses/:root/metadatablocks

<span class="c1"># update solr schema via dataverse api</span>
docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>dataverse-1<span class="w"> </span>wget<span class="w"> </span>https://raw.githubusercontent.com/IQSS/dataverse/develop/conf/solr/9.3.0/update-fields.sh<span class="w"> </span>-O<span class="w"> </span>/opt/payara/update-fields.sh
docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>dataverse-1<span class="w"> </span>wget<span class="w"> </span>https://raw.githubusercontent.com/IQSS/dataverse/develop/conf/solr/9.3.0/schema.xml<span class="w"> </span>-O<span class="w"> </span>/opt/payara/schema.xml
docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>dataverse-1<span class="w"> </span>chmod<span class="w"> </span>u+x<span class="w"> </span>/opt/payara/update-fields.sh
docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>dataverse-1<span class="w"> </span>wget<span class="w"> </span>http://localhost:8080/api/admin/index/solr/schema<span class="w"> </span>-O<span class="w"> </span>/opt/payara/partial-schema.xml
docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>--user<span class="w"> </span>root<span class="w"> </span>dataverse-1<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>bc<span class="w"> </span>ed
docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>dataverse-1<span class="w"> </span>/opt/payara/update-fields.sh<span class="w"> </span>/opt/payara/schema.xml<span class="w"> </span>/opt/payara/partial-schema.xml

<span class="c1"># reload solr with schema</span>
docker<span class="w"> </span>cp<span class="w"> </span>dataverse-1:/opt/payara/schema.xml<span class="w"> </span>/tmp/schema.xml
docker<span class="w"> </span>cp<span class="w"> </span>/tmp/schema.xml<span class="w"> </span>solr-1:/var/solr/data/collection1/conf/
docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>solr-1<span class="w"> </span>curl<span class="w"> </span><span class="s2">"http://localhost:8983/solr/admin/cores?action=RELOAD&amp;core=collection1"</span>

<span class="c1"># deploy demo cvoc conf</span>
wget<span class="w"> </span>https://raw.githubusercontent.com/gdcc/dataverse-external-vocab-support/main/examples/config/cvoc-conf.json<span class="w"> </span>-O<span class="w"> </span>/tmp/cvoc-conf.json
curl<span class="w"> </span>-X<span class="w"> </span>PUT<span class="w"> </span>--upload-file<span class="w"> </span>/tmp/cvoc-conf.json<span class="w"> </span>http://localhost:8080/api/admin/settings/:CVocConf
</code></pre></div>
<p>After that, you can edit a dataset and see the new metadata block configured :<br>
<a href="/user_uploads/53090/sgYMwksxJdvi5sr4xELJyVrh/Screenshot-from-2024-04-11-09-34-18.png">Screenshot-from-2024-04-11-09-34-18.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/53090/sgYMwksxJdvi5sr4xELJyVrh/Screenshot-from-2024-04-11-09-34-18.png" title="Screenshot-from-2024-04-11-09-34-18.png"><img src="/user_uploads/53090/sgYMwksxJdvi5sr4xELJyVrh/Screenshot-from-2024-04-11-09-34-18.png"></a></div><p>Thanks to <span class="user-mention" data-user-id="651106">@Jérôme Roucou</span> for the script.</p>



<a name="432649759"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/379673-dev/topic/Run%20dataverse-external-vocab-support%20demo%20under%20docker/near/432649759" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aamir Muhammad <a href="https://gdcc.github.io/zulip-archive/stream/379673-dev/topic/Run.20dataverse-external-vocab-support.20demo.20under.20docker.html#432649759">(Apr 11 2024 at 08:11)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="649905">@luddaniel</span> and <span class="user-mention" data-user-id="651106">@Jérôme Roucou</span> for putting in such effort to help.</p>



<a name="432649928"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/379673-dev/topic/Run%20dataverse-external-vocab-support%20demo%20under%20docker/near/432649928" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/379673-dev/topic/Run.20dataverse-external-vocab-support.20demo.20under.20docker.html#432649928">(Apr 11 2024 at 08:12)</a>:</h4>
<p>Some interesting ideas here!</p>



<a name="432649988"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/379673-dev/topic/Run%20dataverse-external-vocab-support%20demo%20under%20docker/near/432649988" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/379673-dev/topic/Run.20dataverse-external-vocab-support.20demo.20under.20docker.html#432649988">(Apr 11 2024 at 08:13)</a>:</h4>
<p>Please note that the update-fields script is already included in the configbaker image</p>



<a name="432650288"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/379673-dev/topic/Run%20dataverse-external-vocab-support%20demo%20under%20docker/near/432650288" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/379673-dev/topic/Run.20dataverse-external-vocab-support.20demo.20under.20docker.html#432650288">(Apr 11 2024 at 08:15)</a>:</h4>
<p>Instead of copying around the files it might be easier to mount the conf dir when using docker run with configbaker</p>



<a name="432650518"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/379673-dev/topic/Run%20dataverse-external-vocab-support%20demo%20under%20docker/near/432650518" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/379673-dev/topic/Run.20dataverse-external-vocab-support.20demo.20under.20docker.html#432650518">(Apr 11 2024 at 08:16)</a>:</h4>
<p>IIRC when using the dev persona the API is not locked down, so there should be no need to run the curl commands inside the app container</p>



<a name="432650987"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/379673-dev/topic/Run%20dataverse-external-vocab-support%20demo%20under%20docker/near/432650987" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/379673-dev/topic/Run.20dataverse-external-vocab-support.20demo.20under.20docker.html#432650987">(Apr 11 2024 at 08:19)</a>:</h4>
<p>If you would like to do this in production, you should take a look at the demo persona. The admin api will require an unblock key to be reachable from outside of the container</p>



<a name="432651042"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/379673-dev/topic/Run%20dataverse-external-vocab-support%20demo%20under%20docker/near/432651042" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/379673-dev/topic/Run.20dataverse-external-vocab-support.20demo.20under.20docker.html#432651042">(Apr 11 2024 at 08:20)</a>:</h4>
<p>Glad to see our upstream containers work for you! <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="432651883"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/379673-dev/topic/Run%20dataverse-external-vocab-support%20demo%20under%20docker/near/432651883" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> luddaniel <a href="https://gdcc.github.io/zulip-archive/stream/379673-dev/topic/Run.20dataverse-external-vocab-support.20demo.20under.20docker.html#432651883">(Apr 11 2024 at 08:24)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="598183">@Oliver Bertuch</span> I think it would be great to a couple of scripts to fastly configure a docker  (adding language with package, adding/updating tsv, reload schema) as when we switch from PR to PR we kind of want to start from scratch and re-create a context</p>



<a name="432652084"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/379673-dev/topic/Run%20dataverse-external-vocab-support%20demo%20under%20docker/near/432652084" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aamir Muhammad <a href="https://gdcc.github.io/zulip-archive/stream/379673-dev/topic/Run.20dataverse-external-vocab-support.20demo.20under.20docker.html#432652084">(Apr 11 2024 at 08:25)</a>:</h4>
<p>I am doing this on my local computer. I am very new to these technologies. we don't have a production instance. I am trying to work with external vocabulary and understand how it integrates to dataverse.</p>



<a name="432652275"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/379673-dev/topic/Run%20dataverse-external-vocab-support%20demo%20under%20docker/near/432652275" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/379673-dev/topic/Run.20dataverse-external-vocab-support.20demo.20under.20docker.html#432652275">(Apr 11 2024 at 08:26)</a>:</h4>
<p>Absolutely! That's why we have configbaker! <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span> Back in the day when we wrote our roadmap we already had on our radar to make the existing scripts more modular, so they can be easily reused as building blocks. For example we load a few metadata blocks by default, so this should be a small snippet, easy to run on its own as part of a customized bootstrapping or standalone execution</p>



<a name="432652566"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/379673-dev/topic/Run%20dataverse-external-vocab-support%20demo%20under%20docker/near/432652566" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/379673-dev/topic/Run.20dataverse-external-vocab-support.20demo.20under.20docker.html#432652566">(Apr 11 2024 at 08:28)</a>:</h4>
<p>At some point we were also talking about including a flavor that simply is an nginx to serve static files like the vocab scripts and previewers. That way you could simply serve all of the stuff in one go, also ready for further development</p>



<a name="432652637"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/379673-dev/topic/Run%20dataverse-external-vocab-support%20demo%20under%20docker/near/432652637" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/379673-dev/topic/Run.20dataverse-external-vocab-support.20demo.20under.20docker.html#432652637">(Apr 11 2024 at 08:28)</a>:</h4>
<p>Maybe you want to add this to the agenda of the container WG meeting later today? See <a class="stream-topic" data-stream-id="375812" href="/#narrow/stream/375812-containers/topic/weekly.20meeting">#containers &gt; weekly meeting</a></p>



<a name="432652769"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/379673-dev/topic/Run%20dataverse-external-vocab-support%20demo%20under%20docker/near/432652769" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oliver Bertuch <a href="https://gdcc.github.io/zulip-archive/stream/379673-dev/topic/Run.20dataverse-external-vocab-support.20demo.20under.20docker.html#432652769">(Apr 11 2024 at 08:29)</a>:</h4>
<p>You or <span class="user-mention" data-user-id="651106">@Jérôme Roucou</span>  could even give a little demo and maybe we can talk about how this can be improved and generalised for further use?</p>



<a name="432654596"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/379673-dev/topic/Run%20dataverse-external-vocab-support%20demo%20under%20docker/near/432654596" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> luddaniel <a href="https://gdcc.github.io/zulip-archive/stream/379673-dev/topic/Run.20dataverse-external-vocab-support.20demo.20under.20docker.html#432654596">(Apr 11 2024 at 08:40)</a>:</h4>
<p>I'll talk with the team ;)</p>



<a name="432676112"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/379673-dev/topic/Run%20dataverse-external-vocab-support%20demo%20under%20docker/near/432676112" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin 🚀 <a href="https://gdcc.github.io/zulip-archive/stream/379673-dev/topic/Run.20dataverse-external-vocab-support.20demo.20under.20docker.html#432676112">(Apr 11 2024 at 10:42)</a>:</h4>
<p>Sure, you're all very welcome to come to our weekly containerization working group meeting. <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span> <a href="https://ct.gdcc.io">https://ct.gdcc.io</a></p>



<a name="481126471"></a>
<h4><a href="https://dataverse.zulipchat.com#narrow/stream/379673-dev/topic/Run%20dataverse-external-vocab-support%20demo%20under%20docker/near/481126471" class="zl"><img src="https://gdcc.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philip Durbin 🚀 <a href="https://gdcc.github.io/zulip-archive/stream/379673-dev/topic/Run.20dataverse-external-vocab-support.20demo.20under.20docker.html#481126471">(Nov 07 2024 at 13:59)</a>:</h4>
<p>I'm thinking about loading a metadata block and updating Solr over at <a class="stream-topic" data-stream-id="375812" href="/#narrow/channel/375812-containers/topic/update-fields.2Esh">#containers &gt; update-fields.sh</a></p>



<hr><p>Last updated: Nov 01 2025 at 23:12 UTC</p>
</html>